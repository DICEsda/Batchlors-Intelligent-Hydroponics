Test run for /src/Backend/tests/IoT.Backend.IntegrationTests/bin/Release/net8.0/IoT.Backend.IntegrationTests.dll (.NETCoreApp,Version=v8.0)
VSTest version 17.11.1 (x64)

Starting test execution, please wait...
A total of 1 test files matched the specified pattern.
/src/Backend/tests/IoT.Backend.IntegrationTests/bin/Release/net8.0/IoT.Backend.IntegrationTests.dll
[xUnit.net 00:00:00.00] xUnit.net VSTest Adapter v2.8.2+699d445a1a (64-bit .NET 8.0.22)
[xUnit.net 00:00:00.09]   Discovering: IoT.Backend.IntegrationTests
[xUnit.net 00:00:00.14]   Discovered:  IoT.Backend.IntegrationTests
[xUnit.net 00:00:00.15]   Starting:    IoT.Backend.IntegrationTests
[testcontainers.org 00:00:00.08] Connected to Docker:
  Host: unix:///var/run/docker.sock
  Server Version: 29.0.1
  Kernel Version: 6.6.87.2-microsoft-standard-WSL2
  API Version: 1.52
  Operating System: Docker Desktop
  Total Memory: 7.71 GB
  Labels: 
    com.docker.desktop.address=npipe://\\.\pipe\docker_cli
[testcontainers.org 00:00:00.85] Docker container a0f8c256be9a created
[testcontainers.org 00:00:00.92] Start Docker container a0f8c256be9a
[testcontainers.org 00:00:01.90] Wait for Docker container a0f8c256be9a to complete readiness checks
[testcontainers.org 00:00:07.03] Docker container a0f8c256be9a ready
[18:45:05 INF] Starting IoT Backend on port 8000
[18:45:05 INF] Starting IoT Backend on port 8000
[18:45:05 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:45:05 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:45:05 INF] PairingBackgroundService starting
[18:45:05 INF] PairingBackgroundService starting
[18:45:05 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:45:05 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:45:05 INF] Connected to MQTT broker
[18:45:05 INF] Connected to MQTT broker
[18:45:05 INF] MQTT service started
[18:45:05 INF] MQTT service started
[18:45:05 INF] HTTP GET /health/live responded 200 in 30.5316 ms
[18:45:05 INF] HTTP GET /health/live responded 200 in 30.5316 ms
[18:45:06 INF] HTTP GET /api/telemetry/tower/test-farm-tel/coord-tel/tower-tel responded 200 in 51.6499 ms
[18:45:06 INF] HTTP GET /api/telemetry/tower/test-farm-tel/coord-tel/tower-tel responded 200 in 51.6499 ms
[18:45:06 INF] MQTT service stopped
[18:45:06 INF] MQTT service stopped
[18:45:06 INF] PairingBackgroundService stopped
[18:45:06 INF] PairingBackgroundService stopped
[18:45:06 INF] TwinSyncBackgroundService stopped
[18:45:06 INF] TwinSyncBackgroundService stopped
[18:45:06 INF] Starting IoT Backend on port 8000
[18:45:06 INF] Starting IoT Backend on port 8000
[18:45:06 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:45:06 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:45:06 INF] PairingBackgroundService starting
[18:45:06 INF] PairingBackgroundService starting
[18:45:06 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:45:06 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:45:06 INF] Connected to MQTT broker
[18:45:06 INF] Connected to MQTT broker
[18:45:06 INF] PairingBackgroundService stopped
[18:45:06 INF] PairingBackgroundService stopped
[18:45:06 INF] TwinSyncBackgroundService stopped
[18:45:06 INF] TwinSyncBackgroundService stopped
[18:45:06 INF] Starting IoT Backend on port 8000
[18:45:06 INF] Starting IoT Backend on port 8000
[18:45:06 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:45:06 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:45:06 INF] PairingBackgroundService starting
[18:45:06 INF] PairingBackgroundService starting
[18:45:06 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:45:06 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:45:06 INF] Connected to MQTT broker
[18:45:06 INF] Connected to MQTT broker
  Passed IoT.Backend.IntegrationTests.Tests.ApiCrudTests.GetTowerTelemetry_ShouldReturnHistoricalData [316 ms]
  Standard Output Messages:
 Creating WebApplicationFactory...
 Backend is ready
 Test fixture initialized
 Disposing test fixture...


  Passed IoT.Backend.IntegrationTests.Tests.ApiCrudTests.GetZonesBySite_ShouldReturnZones [338 ms]
  Standard Output Messages:
 Creating WebApplicationFactory...
 Backend is ready
 Test fixture initialized
 Disposing test fixture...


[18:45:07 INF] PairingBackgroundService stopped
[18:45:07 INF] PairingBackgroundService stopped
[18:45:07 INF] TwinSyncBackgroundService stopped
[18:45:07 INF] TwinSyncBackgroundService stopped
[18:45:07 INF] Starting IoT Backend on port 8000
[18:45:07 INF] Starting IoT Backend on port 8000
[18:45:07 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:45:07 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:45:07 INF] PairingBackgroundService starting
[18:45:07 INF] PairingBackgroundService starting
[18:45:07 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:45:07 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:45:07 INF] Connected to MQTT broker
[18:45:07 INF] Connected to MQTT broker
[18:45:08 INF] PairingBackgroundService stopped
[18:45:08 INF] PairingBackgroundService stopped
[18:45:08 INF] TwinSyncBackgroundService stopped
[18:45:08 INF] TwinSyncBackgroundService stopped
[18:45:08 INF] Starting IoT Backend on port 8000
[18:45:08 INF] Starting IoT Backend on port 8000
[18:45:08 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:45:08 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:45:08 INF] PairingBackgroundService starting
[18:45:08 INF] PairingBackgroundService starting
[18:45:08 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:45:08 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:45:08 INF] Connected to MQTT broker
[18:45:08 INF] Connected to MQTT broker
  Passed IoT.Backend.IntegrationTests.Tests.ApiCrudTests.GetTower_WhenExists_ShouldReturnTower [470 ms]
  Standard Output Messages:
 Creating WebApplicationFactory...
 Backend is ready
 Test fixture initialized
 Disposing test fixture...


  Passed IoT.Backend.IntegrationTests.Tests.ApiCrudTests.GetTowersByFarm_ShouldReturnAllTowersInFarm [464 ms]
  Standard Output Messages:
 Creating WebApplicationFactory...
 Backend is ready
 Test fixture initialized
 Disposing test fixture...


[18:45:09 INF] PairingBackgroundService stopped
[18:45:09 INF] PairingBackgroundService stopped
[18:45:09 INF] TwinSyncBackgroundService stopped
[18:45:09 INF] TwinSyncBackgroundService stopped
[18:45:09 INF] Starting IoT Backend on port 8000
[18:45:09 INF] Starting IoT Backend on port 8000
[18:45:09 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:45:09 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:45:09 INF] PairingBackgroundService starting
[18:45:09 INF] PairingBackgroundService starting
[18:45:09 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:45:09 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:45:09 INF] HTTP GET /health/live responded 200 in 2.0978 ms
[18:45:09 INF] HTTP GET /health/live responded 200 in 2.0978 ms
[18:45:09 INF] Connected to MQTT broker
[18:45:09 INF] Connected to MQTT broker
[18:45:09 INF] MQTT service started
[18:45:09 INF] MQTT service started
  Passed IoT.Backend.IntegrationTests.Tests.ApiCrudTests.GetLatestTowerTelemetry_ShouldReturnMostRecent [278 ms]
  Standard Output Messages:
 Creating WebApplicationFactory...
 Backend is ready
 Test fixture initialized
 Disposing test fixture...


[18:45:10 INF] Created zone b98d886fe16a4ec6916b02c666abf3ee in site test-site-create for coordinator coord-for-zone
[18:45:10 INF] Created zone b98d886fe16a4ec6916b02c666abf3ee in site test-site-create for coordinator coord-for-zone
[18:45:10 INF] HTTP POST /api/zones responded 201 in 467.1417 ms
[18:45:10 INF] HTTP POST /api/zones responded 201 in 467.1417 ms
[18:45:10 INF] TelemetryHandler subscribing to MQTT topics
[18:45:10 INF] TelemetryHandler subscribing to MQTT topics
[18:45:10 INF] MQTT service stopped
[18:45:10 INF] MQTT service stopped
[18:45:10 INF] Subscribed to site/+/coord/+/telemetry
[18:45:10 INF] Subscribed to site/+/coord/+/telemetry
[18:45:10 INF] TelemetryHandler subscribed to all telemetry topics
[18:45:10 INF] TelemetryHandler subscribed to all telemetry topics
[18:45:10 INF] PairingBackgroundService stopped
[18:45:10 INF] PairingBackgroundService stopped
[18:45:10 INF] TwinSyncBackgroundService stopped
[18:45:10 INF] TwinSyncBackgroundService stopped
[18:45:10 INF] Starting IoT Backend on port 8000
[18:45:10 INF] Starting IoT Backend on port 8000
[18:45:10 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:45:10 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:45:10 INF] PairingBackgroundService starting
[18:45:10 INF] PairingBackgroundService starting
[18:45:10 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:45:10 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:45:10 INF] HTTP GET /health/live responded 200 in 2.4159 ms
[18:45:10 INF] HTTP GET /health/live responded 200 in 2.4159 ms
[18:45:10 INF] Connected to MQTT broker
[18:45:10 INF] Connected to MQTT broker
[18:45:10 INF] MQTT service started
[18:45:10 INF] MQTT service started
[18:45:11 INF] TelemetryHandler subscribing to MQTT topics
[18:45:11 INF] TelemetryHandler subscribing to MQTT topics
[18:45:11 INF] Subscribed to site/+/coord/+/telemetry
[18:45:11 INF] Subscribed to site/+/coord/+/telemetry
[18:45:11 INF] Subscribed to site/+/coord/+/status
[18:45:11 INF] Subscribed to site/+/coord/+/status
[18:45:11 INF] Subscribed to site/+/ota/progress
[18:45:11 INF] Subscribed to site/+/ota/progress
[18:45:11 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:45:11 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:45:11 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:45:11 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:45:11 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:45:11 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:45:11 INF] Subscribed to farm/+/coord/+/pairing/request
[18:45:11 INF] Subscribed to farm/+/coord/+/pairing/request
[18:45:11 INF] Subscribed to farm/+/coord/+/pairing/status
[18:45:11 INF] Subscribed to farm/+/coord/+/pairing/status
[18:45:11 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:45:11 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:45:11 INF] TelemetryHandler subscribed to all telemetry topics
[18:45:11 INF] TelemetryHandler subscribed to all telemetry topics
[18:45:11 INF] Updated name for tower tower-rename to New Name
[18:45:11 INF] Updated name for tower tower-rename to New Name
[18:45:11 INF] HTTP PATCH /api/towers/test-farm-rename/coord-rename/tower-rename/name responded 200 in 19.7470 ms
[18:45:11 INF] HTTP PATCH /api/towers/test-farm-rename/coord-rename/tower-rename/name responded 200 in 19.7470 ms
[18:45:11 INF] MQTT service stopped
[18:45:11 INF] PairingBackgroundService stopped
[18:45:11 INF] PairingBackgroundService stopped
[18:45:11 INF] MQTT service stopped
[18:45:11 INF] TwinSyncBackgroundService stopped
[18:45:11 INF] TwinSyncBackgroundService stopped
[18:45:11 INF] Starting IoT Backend on port 8000
[18:45:11 INF] Starting IoT Backend on port 8000
[18:45:11 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:45:11 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:45:11 INF] PairingBackgroundService starting
[18:45:11 INF] PairingBackgroundService starting
[18:45:11 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:45:11 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:45:11 INF] Connected to MQTT broker
[18:45:11 INF] Connected to MQTT broker
  Passed IoT.Backend.IntegrationTests.Tests.ApiCrudTests.CreateZone_ShouldPersist [960 ms]
  Standard Output Messages:
 Creating WebApplicationFactory...
 Backend is ready
 Test fixture initialized
 Disposing test fixture...


  Passed IoT.Backend.IntegrationTests.Tests.ApiCrudTests.UpdateTowerName_ShouldPersist [292 ms]
  Standard Output Messages:
 Creating WebApplicationFactory...
 Backend is ready
 Test fixture initialized
 Disposing test fixture...


[18:45:11 INF] PairingBackgroundService stopped
[18:45:11 INF] PairingBackgroundService stopped
[18:45:11 INF] TwinSyncBackgroundService stopped
[18:45:11 INF] TwinSyncBackgroundService stopped
[18:45:11 INF] Starting IoT Backend on port 8000
[18:45:11 INF] Starting IoT Backend on port 8000
[18:45:11 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:45:11 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:45:11 INF] PairingBackgroundService starting
[18:45:11 INF] PairingBackgroundService starting
[18:45:11 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:45:11 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:45:11 INF] Connected to MQTT broker
[18:45:11 INF] Connected to MQTT broker
[18:45:11 INF] PairingBackgroundService stopped
[18:45:11 INF] PairingBackgroundService stopped
[18:45:11 INF] TwinSyncBackgroundService stopped
[18:45:11 INF] TwinSyncBackgroundService stopped
[18:45:11 INF] Starting IoT Backend on port 8000
[18:45:11 INF] Starting IoT Backend on port 8000
[18:45:11 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:45:11 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:45:11 INF] PairingBackgroundService starting
[18:45:11 INF] PairingBackgroundService starting
[18:45:11 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:45:11 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:45:11 INF] Connected to MQTT broker
[18:45:11 INF] Connected to MQTT broker
[18:45:11 INF] PairingBackgroundService stopped
[18:45:11 INF] PairingBackgroundService stopped
[18:45:11 INF] TwinSyncBackgroundService stopped
[18:45:11 INF] TwinSyncBackgroundService stopped
[18:45:11 INF] Starting IoT Backend on port 8000
[18:45:11 INF] Starting IoT Backend on port 8000
[18:45:11 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:45:11 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:45:11 INF] PairingBackgroundService starting
[18:45:11 INF] PairingBackgroundService starting
[18:45:11 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:45:11 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:45:11 INF] Connected to MQTT broker
[18:45:11 INF] Connected to MQTT broker
[18:45:12 INF] TelemetryHandler subscribing to MQTT topics
[18:45:12 INF] TelemetryHandler subscribing to MQTT topics
[18:45:12 INF] Subscribed to site/+/coord/+/telemetry
[18:45:12 INF] Subscribed to site/+/coord/+/telemetry
[18:45:12 INF] Subscribed to site/+/coord/+/status
[18:45:12 INF] Subscribed to site/+/coord/+/status
[18:45:12 INF] Subscribed to site/+/ota/progress
[18:45:12 INF] Subscribed to site/+/ota/progress
[18:45:12 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:45:12 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:45:12 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:45:12 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:45:12 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:45:12 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:45:12 INF] Subscribed to farm/+/coord/+/pairing/request
[18:45:12 INF] Subscribed to farm/+/coord/+/pairing/request
[18:45:12 INF] Subscribed to farm/+/coord/+/pairing/status
[18:45:12 INF] Subscribed to farm/+/coord/+/pairing/status
[18:45:12 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:45:12 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:45:12 INF] TelemetryHandler subscribed to all telemetry topics
[18:45:12 INF] TelemetryHandler subscribed to all telemetry topics
  Passed IoT.Backend.IntegrationTests.Tests.ApiCrudTests.CreateTower_ShouldPersistToDatabase [375 ms]
  Standard Output Messages:
 Creating WebApplicationFactory...
 Backend is ready
 Test fixture initialized
 Disposing test fixture...


  Passed IoT.Backend.IntegrationTests.Tests.ApiCrudTests.HealthLive_ShouldReturnHealthy [4 ms]
  Standard Output Messages:
 Creating WebApplicationFactory...
 Backend is ready
 Test fixture initialized
 Disposing test fixture...


  Passed IoT.Backend.IntegrationTests.Tests.ApiCrudTests.GetTower_WhenNotExists_ShouldReturnNotFound [18 ms]
  Standard Output Messages:
 Creating WebApplicationFactory...
 Backend is ready
 Test fixture initialized
 Disposing test fixture...


[18:45:14 INF] PairingBackgroundService stopped
[18:45:14 INF] PairingBackgroundService stopped
[18:45:14 INF] TwinSyncBackgroundService stopped
[18:45:14 INF] TwinSyncBackgroundService stopped
[18:45:14 INF] Starting IoT Backend on port 8000
[18:45:14 INF] Starting IoT Backend on port 8000
[18:45:14 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:45:14 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:45:14 INF] PairingBackgroundService starting
[18:45:14 INF] PairingBackgroundService starting
[18:45:14 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:45:14 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:45:14 INF] Connected to MQTT broker
[18:45:14 INF] Connected to MQTT broker
  Passed IoT.Backend.IntegrationTests.Tests.ApiCrudTests.GetReservoirTelemetry_ShouldReturnHistoricalData [496 ms]
  Standard Output Messages:
 Creating WebApplicationFactory...
 Backend is ready
 Test fixture initialized
 Disposing test fixture...


[18:45:14 INF] PairingBackgroundService stopped
[18:45:14 INF] PairingBackgroundService stopped
[18:45:14 INF] TwinSyncBackgroundService stopped
[18:45:14 INF] TwinSyncBackgroundService stopped
[18:45:14 INF] Starting IoT Backend on port 8000
[18:45:14 INF] Starting IoT Backend on port 8000
[18:45:14 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:45:14 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:45:14 INF] PairingBackgroundService starting
[18:45:14 INF] PairingBackgroundService starting
[18:45:14 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:45:14 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:45:14 INF] Connected to MQTT broker
[18:45:14 INF] Connected to MQTT broker
[18:45:14 INF] PairingBackgroundService stopped
[18:45:14 INF] PairingBackgroundService stopped
[18:45:14 INF] TwinSyncBackgroundService stopped
[18:45:14 INF] TwinSyncBackgroundService stopped
[18:45:14 INF] Starting IoT Backend on port 8000
[18:45:14 INF] Starting IoT Backend on port 8000
[18:45:14 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:45:14 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:45:14 INF] PairingBackgroundService starting
[18:45:14 INF] PairingBackgroundService starting
[18:45:14 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:45:14 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:45:14 INF] Connected to MQTT broker
[18:45:14 INF] Connected to MQTT broker
[18:45:15 INF] PairingBackgroundService stopped
[18:45:15 INF] PairingBackgroundService stopped
[18:45:15 INF] TwinSyncBackgroundService stopped
[18:45:15 INF] TwinSyncBackgroundService stopped
[18:45:15 INF] Starting IoT Backend on port 8000
[18:45:15 INF] Starting IoT Backend on port 8000
[18:45:15 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:45:15 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:45:15 INF] PairingBackgroundService starting
[18:45:15 INF] PairingBackgroundService starting
[18:45:15 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:45:15 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:45:15 INF] Connected to MQTT broker
[18:45:15 INF] Connected to MQTT broker
  Passed IoT.Backend.IntegrationTests.Tests.ApiCrudTests.UpdateZone_ShouldPersist [582 ms]
  Standard Output Messages:
 Creating WebApplicationFactory...
 Backend is ready
 Test fixture initialized
 Disposing test fixture...


  Passed IoT.Backend.IntegrationTests.Tests.ApiCrudTests.HealthReady_ShouldReturnHealthy [5 ms]
  Standard Output Messages:
 Creating WebApplicationFactory...
 Backend is ready
 Test fixture initialized
 Disposing test fixture...


  Passed IoT.Backend.IntegrationTests.Tests.ApiCrudTests.DeleteTower_ShouldRemoveFromDatabase [695 ms]
  Standard Output Messages:
 Creating WebApplicationFactory...
 Backend is ready
 Test fixture initialized
 Disposing test fixture...


[18:45:14 INF] TelemetryHandler subscribing to MQTT topics
[18:45:14 INF] TelemetryHandler subscribing to MQTT topics
[18:45:14 INF] Subscribed to site/+/coord/+/telemetry
[18:45:14 INF] Subscribed to site/+/coord/+/telemetry
[18:45:14 INF] Subscribed to site/+/coord/+/status
[18:45:14 INF] Subscribed to site/+/coord/+/status
[18:45:14 INF] Subscribed to site/+/ota/progress
[18:45:14 INF] Subscribed to site/+/ota/progress
[18:45:14 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:45:14 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:45:14 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:45:14 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:45:14 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:45:14 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:45:14 INF] Subscribed to farm/+/coord/+/pairing/request
[18:45:14 INF] Subscribed to farm/+/coord/+/pairing/request
[18:45:14 INF] Subscribed to farm/+/coord/+/pairing/status
[18:45:14 INF] Subscribed to farm/+/coord/+/pairing/status
[18:45:14 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:45:14 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:45:14 INF] TelemetryHandler subscribed to all telemetry topics
[18:45:14 INF] TelemetryHandler subscribed to all telemetry topics
[18:45:15 INF] PairingBackgroundService stopped
[18:45:15 INF] PairingBackgroundService stopped
[18:45:15 INF] TwinSyncBackgroundService stopped
[18:45:15 INF] TwinSyncBackgroundService stopped
[18:45:15 INF] Starting IoT Backend on port 8000
[18:45:15 INF] Starting IoT Backend on port 8000
[18:45:15 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:45:15 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:45:15 INF] PairingBackgroundService starting
[18:45:15 INF] PairingBackgroundService starting
[18:45:15 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:45:15 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:45:15 INF] HTTP GET /health/live responded 200 in 1.5790 ms
[18:45:15 INF] HTTP GET /health/live responded 200 in 1.5790 ms
[18:45:15 INF] Connected to MQTT broker
[18:45:15 INF] Connected to MQTT broker
[18:45:15 INF] MQTT service started
[18:45:15 INF] MQTT service started
[18:45:15 INF] HTTP GET /api/coordinators/nonexistent-site/nonexistent-coord responded 404 in 7.8743 ms
[18:45:15 INF] HTTP GET /api/coordinators/nonexistent-site/nonexistent-coord responded 404 in 7.8743 ms
[18:45:15 INF] MQTT service stopped
[18:45:15 INF] MQTT service stopped
[18:45:15 INF] PairingBackgroundService stopped
[18:45:15 INF] PairingBackgroundService stopped
[18:45:15 INF] TwinSyncBackgroundService stopped
[18:45:15 INF] TwinSyncBackgroundService stopped
[18:45:15 INF] Starting IoT Backend on port 8000
[18:45:15 INF] Starting IoT Backend on port 8000
[18:45:15 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:45:15 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:45:15 INF] PairingBackgroundService starting
[18:45:15 INF] PairingBackgroundService starting
[18:45:15 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:45:15 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:45:15 INF] HTTP GET /health/live responded 200 in 1.7866 ms
[18:45:15 INF] HTTP GET /health/live responded 200 in 1.7866 ms
[18:45:15 INF] Connected to MQTT broker
[18:45:15 INF] Connected to MQTT broker
[18:45:15 INF] MQTT service started
[18:45:15 INF] MQTT service started
[18:45:16 INF] Triggered discovery on coordinator coord-discover
[18:45:16 INF] Triggered discovery on coordinator coord-discover
[18:45:16 INF] HTTP POST /api/coordinators/test-site-discover/coord-discover/discover responded 202 in 7.1910 ms
[18:45:16 INF] HTTP POST /api/coordinators/test-site-discover/coord-discover/discover responded 202 in 7.1910 ms
[18:45:16 INF] MQTT service stopped
[18:45:16 INF] MQTT service stopped
[18:45:16 INF] PairingBackgroundService stopped
[18:45:16 INF] PairingBackgroundService stopped
[18:45:16 INF] TwinSyncBackgroundService stopped
[18:45:16 INF] TwinSyncBackgroundService stopped
[18:45:16 INF] Starting IoT Backend on port 8000
[18:45:16 INF] Starting IoT Backend on port 8000
[18:45:16 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:45:16 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:45:16 INF] PairingBackgroundService starting
[18:45:16 INF] PairingBackgroundService starting
[18:45:16 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:45:16 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:45:16 INF] Connected to MQTT broker
[18:45:16 INF] Connected to MQTT broker
  Passed IoT.Backend.IntegrationTests.Tests.ApiCrudTests.DeleteZone_ShouldRemove [648 ms]
  Standard Output Messages:
 Creating WebApplicationFactory...
 Backend is ready
 Test fixture initialized
 Disposing test fixture...


  Passed IoT.Backend.IntegrationTests.Tests.CoordinatorIntegrationTests.GetCoordinator_WhenNotExists_ShouldReturnNotFound [11 ms]
  Standard Output Messages:
 Creating WebApplicationFactory...
 Backend is ready
 Test fixture initialized
 Disposing test fixture...


  Passed IoT.Backend.IntegrationTests.Tests.CoordinatorIntegrationTests.TriggerDiscovery_ShouldPublishDiscoveryCommand [989 ms]
  Standard Output Messages:
 Creating WebApplicationFactory...
 Backend is ready
 Test fixture initialized
 MQTT Test Client connecting to host.docker.internal:54807 as test-device-b213b184efa748e492766049ba8135c1...
 MQTT Test Client connected
 Subscribed to: site/test-site-discover/coord/coord-discover/cmd
 Received message on: site/test-site-discover/coord/coord-discover/cmd
 MQTT Test Client disconnected
 Disposing test fixture...


[18:45:17 INF] TelemetryHandler subscribing to MQTT topics
[18:45:17 INF] TelemetryHandler subscribing to MQTT topics
[18:45:17 INF] Subscribed to site/+/coord/+/telemetry
[18:45:17 INF] Subscribed to site/+/coord/+/telemetry
[18:45:17 INF] Subscribed to site/+/coord/+/status
[18:45:17 INF] Subscribed to site/+/coord/+/status
[18:45:17 INF] Subscribed to site/+/ota/progress
[18:45:17 INF] Subscribed to site/+/ota/progress
[18:45:17 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:45:17 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:45:17 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:45:17 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:45:17 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:45:17 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:45:17 INF] Subscribed to farm/+/coord/+/pairing/request
[18:45:17 INF] Subscribed to farm/+/coord/+/pairing/request
[18:45:17 INF] Subscribed to farm/+/coord/+/pairing/status
[18:45:17 INF] Subscribed to farm/+/coord/+/pairing/status
[18:45:17 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:45:17 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:45:17 INF] TelemetryHandler subscribed to all telemetry topics
[18:45:17 INF] TelemetryHandler subscribed to all telemetry topics
[18:45:17 INF] PairingBackgroundService stopped
[18:45:17 INF] PairingBackgroundService stopped
[18:45:17 INF] TwinSyncBackgroundService stopped
[18:45:17 INF] TwinSyncBackgroundService stopped
[18:45:18 INF] Starting IoT Backend on port 8000
[18:45:18 INF] Starting IoT Backend on port 8000
[18:45:18 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:45:18 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:45:18 INF] PairingBackgroundService starting
[18:45:18 INF] PairingBackgroundService starting
[18:45:18 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:45:18 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:45:18 INF] Connected to MQTT broker
[18:45:18 INF] Connected to MQTT broker
  Passed IoT.Backend.IntegrationTests.Tests.CoordinatorIntegrationTests.EnterPairingMode_ShouldPublishPairingCommand [1 s]
  Standard Output Messages:
 Creating WebApplicationFactory...
 Backend is ready
 Test fixture initialized
 MQTT Test Client connecting to host.docker.internal:54807 as test-device-faf1a15f76b0430687173c7b88e2c03e...
 MQTT Test Client connected
 Subscribed to: site/test-site-pair/coord/coord-pair/cmd
 Received message on: site/test-site-pair/coord/coord-pair/cmd
 MQTT Test Client disconnected
 Disposing test fixture...


[18:45:19 INF] TelemetryHandler subscribing to MQTT topics
[18:45:19 INF] TelemetryHandler subscribing to MQTT topics
[18:45:19 INF] Subscribed to site/+/coord/+/telemetry
[18:45:19 INF] Subscribed to site/+/coord/+/telemetry
[18:45:19 INF] Subscribed to site/+/coord/+/status
[18:45:19 INF] Subscribed to site/+/coord/+/status
[18:45:19 INF] Subscribed to site/+/ota/progress
[18:45:19 INF] Subscribed to site/+/ota/progress
[18:45:19 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:45:19 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:45:19 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:45:19 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:45:19 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:45:19 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:45:19 INF] Subscribed to farm/+/coord/+/pairing/request
[18:45:19 INF] Subscribed to farm/+/coord/+/pairing/request
[18:45:19 INF] Subscribed to farm/+/coord/+/pairing/status
[18:45:19 INF] Subscribed to farm/+/coord/+/pairing/status
[18:45:19 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:45:19 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:45:19 INF] TelemetryHandler subscribed to all telemetry topics
[18:45:19 INF] TelemetryHandler subscribed to all telemetry topics
[18:45:19 INF] PairingBackgroundService stopped
[18:45:19 INF] PairingBackgroundService stopped
[18:45:19 INF] TwinSyncBackgroundService stopped
[18:45:19 INF] TwinSyncBackgroundService stopped
[18:45:19 INF] Starting IoT Backend on port 8000
[18:45:19 INF] Starting IoT Backend on port 8000
[18:45:19 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:45:19 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:45:19 INF] PairingBackgroundService starting
[18:45:19 INF] PairingBackgroundService starting
[18:45:19 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:45:19 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:45:19 INF] Connected to MQTT broker
[18:45:19 INF] Connected to MQTT broker
  Passed IoT.Backend.IntegrationTests.Tests.CoordinatorIntegrationTests.BroadcastToTowers_ShouldPublishBroadcastCommand [735 ms]
  Standard Output Messages:
 Creating WebApplicationFactory...
 Backend is ready
 Test fixture initialized
 MQTT Test Client connecting to host.docker.internal:54807 as test-device-67f5b0cd8d3947efbb70bac5c8a40348...
 MQTT Test Client connected
 Subscribed to: site/test-site-broadcast/coord/coord-broadcast/broadcast
 Received message on: site/test-site-broadcast/coord/coord-broadcast/broadcast
 MQTT Test Client disconnected
 Disposing test fixture...


[18:45:20 INF] PairingBackgroundService stopped
[18:45:20 INF] PairingBackgroundService stopped
[18:45:20 INF] TwinSyncBackgroundService stopped
[18:45:20 INF] TwinSyncBackgroundService stopped
[18:45:20 INF] Starting IoT Backend on port 8000
[18:45:20 INF] Starting IoT Backend on port 8000
[18:45:20 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:45:20 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:45:20 INF] PairingBackgroundService starting
[18:45:20 INF] PairingBackgroundService starting
[18:45:20 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:45:20 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:45:20 INF] Connected to MQTT broker
[18:45:20 INF] Connected to MQTT broker
  Passed IoT.Backend.IntegrationTests.Tests.CoordinatorIntegrationTests.SendCommand_ShouldPublishToMqtt [949 ms]
  Standard Output Messages:
 Creating WebApplicationFactory...
 Backend is ready
 Test fixture initialized
 MQTT Test Client connecting to host.docker.internal:54807 as test-device-7dd8aa57fdd34e37868dcbeed19aa4f9...
 MQTT Test Client connected
 Subscribed to: site/test-site-cmd/coord/coord-cmd/cmd
 Received message on: site/test-site-cmd/coord/coord-cmd/cmd
 MQTT Test Client disconnected
 Disposing test fixture...


[18:45:21 INF] PairingBackgroundService stopped
[18:45:21 INF] PairingBackgroundService stopped
[18:45:21 INF] TwinSyncBackgroundService stopped
[18:45:21 INF] TwinSyncBackgroundService stopped
[18:45:21 INF] Starting IoT Backend on port 8000
[18:45:21 INF] Starting IoT Backend on port 8000
[18:45:21 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:45:21 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:45:21 INF] PairingBackgroundService starting
[18:45:21 INF] PairingBackgroundService starting
[18:45:21 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:45:21 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:45:21 INF] HTTP GET /health/live responded 200 in 1.3091 ms
[18:45:21 INF] HTTP GET /health/live responded 200 in 1.3091 ms
[18:45:21 INF] Connected to MQTT broker
[18:45:21 INF] Connected to MQTT broker
[18:45:21 INF] MQTT service started
[18:45:21 INF] MQTT service started
[18:45:22 INF] TelemetryHandler subscribing to MQTT topics
[18:45:22 INF] TelemetryHandler subscribing to MQTT topics
[18:45:22 INF] Subscribed to site/+/coord/+/telemetry
[18:45:22 INF] Subscribed to site/+/coord/+/telemetry
[18:45:22 INF] Subscribed to site/+/coord/+/status
[18:45:22 INF] Subscribed to site/+/coord/+/status
[18:45:22 INF] Subscribed to site/+/ota/progress
[18:45:22 INF] Subscribed to site/+/ota/progress
[18:45:22 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:45:22 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:45:22 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:45:22 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:45:22 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:45:22 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:45:22 INF] Subscribed to farm/+/coord/+/pairing/request
[18:45:22 INF] Subscribed to farm/+/coord/+/pairing/request
[18:45:22 INF] Subscribed to farm/+/coord/+/pairing/status
[18:45:22 INF] Subscribed to farm/+/coord/+/pairing/status
[18:45:22 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:45:22 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:45:22 INF] TelemetryHandler subscribed to all telemetry topics
[18:45:22 INF] TelemetryHandler subscribed to all telemetry topics
  Passed IoT.Backend.IntegrationTests.Tests.CoordinatorIntegrationTests.GetCoordinator_WhenExists_ShouldReturnCoordinator [785 ms]
  Standard Output Messages:
 Creating WebApplicationFactory...
 Backend is ready
 Test fixture initialized
 Disposing test fixture...


[18:45:24 INF] Reservoir targets updated for test-farm-targets/coord-targets
[18:45:24 INF] Reservoir targets updated for test-farm-targets/coord-targets
[18:45:24 INF] HTTP PUT /api/coordinators/test-farm-targets/coord-targets/reservoir/targets responded 200 in 24.6524 ms
[18:45:24 INF] HTTP PUT /api/coordinators/test-farm-targets/coord-targets/reservoir/targets responded 200 in 24.6524 ms
[18:45:24 INF] PairingBackgroundService stopped
[18:45:24 INF] PairingBackgroundService stopped
[18:45:24 INF] MQTT service stopped
[18:45:24 INF] MQTT service stopped
[18:45:24 INF] TwinSyncBackgroundService stopped
[18:45:24 INF] TwinSyncBackgroundService stopped
  Passed IoT.Backend.IntegrationTests.Tests.CoordinatorIntegrationTests.SetReservoirTargets_ShouldPersistToDatabase [1 s]
  Standard Output Messages:
 Creating WebApplicationFactory...
 Backend is ready
 Test fixture initialized
 Disposing test fixture...


[18:45:24 INF] Starting IoT Backend on port 8000
[18:45:24 INF] Starting IoT Backend on port 8000
[18:45:24 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:45:24 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:45:24 INF] PairingBackgroundService starting
[18:45:24 INF] PairingBackgroundService starting
[18:45:24 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:45:24 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:45:24 INF] HTTP GET /health/live responded 200 in 3.0514 ms
[18:45:24 INF] HTTP GET /health/live responded 200 in 3.0514 ms
[18:45:24 INF] Connected to MQTT broker
[18:45:24 INF] Connected to MQTT broker
[18:45:24 INF] MQTT service started
[18:45:24 INF] MQTT service started
[18:45:25 INF] TelemetryHandler subscribing to MQTT topics
[18:45:25 INF] TelemetryHandler subscribing to MQTT topics
[18:45:25 INF] Subscribed to site/+/coord/+/telemetry
[18:45:25 INF] Subscribed to site/+/coord/+/telemetry
[18:45:25 INF] Subscribed to site/+/coord/+/status
[18:45:25 INF] Subscribed to site/+/coord/+/status
[18:45:25 INF] Subscribed to site/+/ota/progress
[18:45:25 INF] Subscribed to site/+/ota/progress
[18:45:25 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:45:25 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:45:25 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:45:25 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:45:25 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:45:25 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:45:25 INF] Subscribed to farm/+/coord/+/pairing/request
[18:45:25 INF] Subscribed to farm/+/coord/+/pairing/request
[18:45:25 INF] Subscribed to farm/+/coord/+/pairing/status
[18:45:25 INF] Subscribed to farm/+/coord/+/pairing/status
[18:45:25 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:45:25 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:45:25 INF] TelemetryHandler subscribed to all telemetry topics
[18:45:25 INF] TelemetryHandler subscribed to all telemetry topics
[18:45:26 INF] HTTP GET /api/coordinators/farm/test-farm-coords responded 200 in 9.8494 ms
[18:45:26 INF] HTTP GET /api/coordinators/farm/test-farm-coords responded 200 in 9.8494 ms
[18:45:26 INF] MQTT service stopped
[18:45:26 INF] MQTT service stopped
[18:45:26 INF] PairingBackgroundService stopped
[18:45:26 INF] PairingBackgroundService stopped
[18:45:26 INF] TwinSyncBackgroundService stopped
[18:45:26 INF] TwinSyncBackgroundService stopped
  Passed IoT.Backend.IntegrationTests.Tests.CoordinatorIntegrationTests.GetCoordinatorsByFarm_ShouldReturnAllInFarm [1 s]
  Standard Output Messages:
 Creating WebApplicationFactory...
 Backend is ready
 Test fixture initialized
 Disposing test fixture...


[18:45:26 INF] Starting IoT Backend on port 8000
[18:45:26 INF] Starting IoT Backend on port 8000
[18:45:26 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:45:26 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:45:26 INF] PairingBackgroundService starting
[18:45:26 INF] PairingBackgroundService starting
[18:45:26 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:45:26 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:45:26 INF] Connected to MQTT broker
[18:45:26 INF] Connected to MQTT broker
[18:45:27 INF] TelemetryHandler subscribing to MQTT topics
[18:45:27 INF] TelemetryHandler subscribing to MQTT topics
[18:45:27 INF] Subscribed to site/+/coord/+/telemetry
[18:45:27 INF] Subscribed to site/+/coord/+/telemetry
[18:45:27 INF] Subscribed to site/+/coord/+/status
[18:45:27 INF] Subscribed to site/+/coord/+/status
[18:45:27 INF] Subscribed to site/+/ota/progress
[18:45:27 INF] Subscribed to site/+/ota/progress
[18:45:27 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:45:27 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:45:27 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:45:27 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:45:27 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:45:27 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:45:27 INF] Subscribed to farm/+/coord/+/pairing/request
[18:45:27 INF] Subscribed to farm/+/coord/+/pairing/request
[18:45:27 INF] Subscribed to farm/+/coord/+/pairing/status
[18:45:27 INF] Subscribed to farm/+/coord/+/pairing/status
[18:45:27 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:45:27 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:45:27 INF] TelemetryHandler subscribed to all telemetry topics
[18:45:27 INF] TelemetryHandler subscribed to all telemetry topics
[18:45:27 INF] PairingBackgroundService stopped
[18:45:27 INF] PairingBackgroundService stopped
[18:45:27 INF] TwinSyncBackgroundService stopped
[18:45:27 INF] TwinSyncBackgroundService stopped
[18:45:27 INF] Starting IoT Backend on port 8000
[18:45:27 INF] Starting IoT Backend on port 8000
[18:45:27 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:45:27 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:45:27 INF] PairingBackgroundService starting
[18:45:27 INF] PairingBackgroundService starting
[18:45:27 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:45:27 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:45:27 INF] HTTP GET /health/live responded 200 in 2.1477 ms
[18:45:27 INF] HTTP GET /health/live responded 200 in 2.1477 ms
[18:45:27 INF] Connected to MQTT broker
[18:45:27 INF] Connected to MQTT broker
[18:45:27 INF] MQTT service started
[18:45:27 INF] MQTT service started
  Passed IoT.Backend.IntegrationTests.Tests.CoordinatorIntegrationTests.GetReservoirState_ShouldReturnCurrentState [1 s]
  Standard Output Messages:
 Creating WebApplicationFactory...
 Backend is ready
 Test fixture initialized
 Disposing test fixture...


[18:45:28 INF] TelemetryHandler subscribing to MQTT topics
[18:45:28 INF] TelemetryHandler subscribing to MQTT topics
[18:45:28 INF] Subscribed to site/+/coord/+/telemetry
[18:45:28 INF] Subscribed to site/+/coord/+/telemetry
[18:45:28 INF] Subscribed to site/+/coord/+/status
[18:45:28 INF] Subscribed to site/+/coord/+/status
[18:45:28 INF] Subscribed to site/+/ota/progress
[18:45:28 INF] Subscribed to site/+/ota/progress
[18:45:28 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:45:28 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:45:28 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:45:28 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:45:28 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:45:28 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:45:28 INF] Subscribed to farm/+/coord/+/pairing/request
[18:45:28 INF] Subscribed to farm/+/coord/+/pairing/request
[18:45:28 INF] Subscribed to farm/+/coord/+/pairing/status
[18:45:28 INF] Subscribed to farm/+/coord/+/pairing/status
[18:45:28 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:45:28 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:45:28 INF] TelemetryHandler subscribed to all telemetry topics
[18:45:28 INF] TelemetryHandler subscribed to all telemetry topics
[18:45:30 INF] Restart command sent to coordinator coord-restart
[18:45:30 INF] Restart command sent to coordinator coord-restart
[18:45:30 INF] HTTP POST /api/coordinators/test-site-restart/coord-restart/restart responded 200 in 7.1758 ms
[18:45:30 INF] HTTP POST /api/coordinators/test-site-restart/coord-restart/restart responded 200 in 7.1758 ms
[18:45:30 INF] MQTT service stopped
[18:45:30 INF] MQTT service stopped
[18:45:30 INF] PairingBackgroundService stopped
[18:45:30 INF] PairingBackgroundService stopped
[18:45:30 INF] TwinSyncBackgroundService stopped
[18:45:30 INF] TwinSyncBackgroundService stopped
  Passed IoT.Backend.IntegrationTests.Tests.CoordinatorIntegrationTests.RestartCoordinator_ShouldPublishRestartCommand [1 s]
  Standard Output Messages:
 Creating WebApplicationFactory...
 Backend is ready
 Test fixture initialized
 MQTT Test Client connecting to host.docker.internal:54807 as test-device-b54909ce49864c7ebd744eb8351f7cc9...
 MQTT Test Client connected
 Subscribed to: site/test-site-restart/coord/coord-restart/cmd
 Received message on: site/test-site-restart/coord/coord-restart/cmd
 MQTT Test Client disconnected
 Disposing test fixture...


[18:45:30 INF] Starting IoT Backend on port 8000
[18:45:30 INF] Starting IoT Backend on port 8000
[18:45:30 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:45:30 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:45:30 INF] PairingBackgroundService starting
[18:45:30 INF] PairingBackgroundService starting
[18:45:30 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:45:30 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:45:30 INF] Connected to MQTT broker
[18:45:30 INF] Connected to MQTT broker
[18:45:31 INF] TelemetryHandler subscribing to MQTT topics
[18:45:31 INF] TelemetryHandler subscribing to MQTT topics
[18:45:31 INF] Subscribed to site/+/coord/+/telemetry
[18:45:31 INF] Subscribed to site/+/coord/+/telemetry
[18:45:31 INF] Subscribed to site/+/coord/+/status
[18:45:31 INF] Subscribed to site/+/coord/+/status
[18:45:31 INF] Subscribed to site/+/ota/progress
[18:45:31 INF] Subscribed to site/+/ota/progress
[18:45:31 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:45:31 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:45:31 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:45:31 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:45:31 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:45:31 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:45:31 INF] Subscribed to farm/+/coord/+/pairing/request
[18:45:31 INF] Subscribed to farm/+/coord/+/pairing/request
[18:45:31 INF] Subscribed to farm/+/coord/+/pairing/status
[18:45:31 INF] Subscribed to farm/+/coord/+/pairing/status
[18:45:31 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:45:31 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:45:31 INF] TelemetryHandler subscribed to all telemetry topics
[18:45:31 INF] TelemetryHandler subscribed to all telemetry topics
[18:45:32 INF] PairingBackgroundService stopped
[18:45:32 INF] PairingBackgroundService stopped
[18:45:32 INF] TwinSyncBackgroundService stopped
[18:45:32 INF] TwinSyncBackgroundService stopped
  Passed IoT.Backend.IntegrationTests.Tests.CoordinatorIntegrationTests.ControlReservoirPump_ShouldPublishMqttCommand [1 s]
  Standard Output Messages:
 Creating WebApplicationFactory...
 Backend is ready
 Test fixture initialized
 MQTT Test Client connecting to host.docker.internal:54807 as test-device-8ffda82e43d14014949d81cadd3f22f2...
 MQTT Test Client connected
 Subscribed to: farm/test-farm-pump/coord/coord-pump/reservoir/cmd
 Received message on: farm/test-farm-pump/coord/coord-pump/reservoir/cmd
 MQTT Test Client disconnected
 Disposing test fixture...


[18:45:32 INF] Starting IoT Backend on port 8000
[18:45:32 INF] Starting IoT Backend on port 8000
[18:45:32 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:45:32 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:45:32 INF] PairingBackgroundService starting
[18:45:32 INF] PairingBackgroundService starting
[18:45:32 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:45:32 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:45:32 INF] Connected to MQTT broker
[18:45:32 INF] Connected to MQTT broker
[18:45:32 INF] PairingBackgroundService stopped
[18:45:32 INF] PairingBackgroundService stopped
[18:45:32 INF] TwinSyncBackgroundService stopped
[18:45:32 INF] TwinSyncBackgroundService stopped
[18:45:32 INF] Starting IoT Backend on port 8000
[18:45:32 INF] Starting IoT Backend on port 8000
[18:45:32 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:45:32 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:45:32 INF] PairingBackgroundService starting
[18:45:32 INF] PairingBackgroundService starting
[18:45:32 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:45:32 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:45:32 INF] Connected to MQTT broker
[18:45:32 INF] Connected to MQTT broker
[18:45:33 INF] TelemetryHandler subscribing to MQTT topics
[18:45:33 INF] TelemetryHandler subscribing to MQTT topics
[18:45:33 INF] Subscribed to site/+/coord/+/telemetry
[18:45:33 INF] Subscribed to site/+/coord/+/telemetry
[18:45:33 INF] Subscribed to site/+/coord/+/status
[18:45:33 INF] Subscribed to site/+/coord/+/status
[18:45:33 INF] Subscribed to site/+/ota/progress
[18:45:33 INF] Subscribed to site/+/ota/progress
[18:45:33 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:45:33 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:45:33 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:45:33 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:45:33 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:45:33 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:45:33 INF] Subscribed to farm/+/coord/+/pairing/request
[18:45:33 INF] Subscribed to farm/+/coord/+/pairing/request
[18:45:33 INF] Subscribed to farm/+/coord/+/pairing/status
[18:45:33 INF] Subscribed to farm/+/coord/+/pairing/status
[18:45:33 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:45:33 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:45:33 INF] TelemetryHandler subscribed to all telemetry topics
[18:45:33 INF] TelemetryHandler subscribed to all telemetry topics
  Passed IoT.Backend.IntegrationTests.Tests.HealthIntegrationTests.AllHealthEndpoints_ShouldReturnConsistentTimestamps [30 ms]
  Standard Output Messages:
 Creating WebApplicationFactory...
 Backend is ready
 Test fixture initialized
 Disposing test fixture...


[18:45:33 INF] PairingBackgroundService stopped
[18:45:33 INF] PairingBackgroundService stopped
[18:45:33 INF] TwinSyncBackgroundService stopped
[18:45:33 INF] TwinSyncBackgroundService stopped
[18:45:33 INF] Starting IoT Backend on port 8000
[18:45:33 INF] Starting IoT Backend on port 8000
[18:45:33 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:45:33 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:45:33 INF] PairingBackgroundService starting
[18:45:33 INF] PairingBackgroundService starting
[18:45:33 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:45:33 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:45:33 INF] Connected to MQTT broker
[18:45:33 INF] Connected to MQTT broker
[18:45:34 INF] TelemetryHandler subscribing to MQTT topics
[18:45:34 INF] TelemetryHandler subscribing to MQTT topics
[18:45:34 INF] Subscribed to site/+/coord/+/telemetry
[18:45:34 INF] Subscribed to site/+/coord/+/telemetry
[18:45:34 INF] Subscribed to site/+/coord/+/status
[18:45:34 INF] Subscribed to site/+/coord/+/status
[18:45:34 INF] Subscribed to site/+/ota/progress
[18:45:34 INF] Subscribed to site/+/ota/progress
[18:45:34 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:45:34 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:45:34 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:45:34 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:45:34 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:45:34 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:45:34 INF] Subscribed to farm/+/coord/+/pairing/request
[18:45:34 INF] Subscribed to farm/+/coord/+/pairing/request
[18:45:34 INF] Subscribed to farm/+/coord/+/pairing/status
[18:45:34 INF] Subscribed to farm/+/coord/+/pairing/status
[18:45:34 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:45:34 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:45:34 INF] TelemetryHandler subscribed to all telemetry topics
[18:45:34 INF] TelemetryHandler subscribed to all telemetry topics
  Passed IoT.Backend.IntegrationTests.Tests.HealthIntegrationTests.GetHealth_WithOnlineCoordinator_ShouldShowCoordinatorTrue [1 s]
  Standard Output Messages:
 Creating WebApplicationFactory...
 Backend is ready
 Test fixture initialized
 Disposing test fixture...


[18:45:35 INF] PairingBackgroundService stopped
[18:45:35 INF] PairingBackgroundService stopped
[18:45:35 INF] TwinSyncBackgroundService stopped
[18:45:35 INF] TwinSyncBackgroundService stopped
[18:45:35 INF] Starting IoT Backend on port 8000
[18:45:35 INF] Starting IoT Backend on port 8000
[18:45:35 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:45:35 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:45:35 INF] PairingBackgroundService starting
[18:45:35 INF] PairingBackgroundService starting
[18:45:35 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:45:35 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:45:35 INF] Connected to MQTT broker
[18:45:35 INF] Connected to MQTT broker
[18:45:35 INF] PairingBackgroundService stopped
[18:45:35 INF] PairingBackgroundService stopped
[18:45:35 INF] TwinSyncBackgroundService stopped
[18:45:35 INF] TwinSyncBackgroundService stopped
[18:45:35 INF] Starting IoT Backend on port 8000
[18:45:35 INF] Starting IoT Backend on port 8000
[18:45:35 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:45:35 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:45:35 INF] PairingBackgroundService starting
[18:45:35 INF] PairingBackgroundService starting
[18:45:35 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:45:35 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:45:35 INF] HTTP GET /health/live responded 200 in 1.7853 ms
[18:45:35 INF] HTTP GET /health/live responded 200 in 1.7853 ms
[18:45:35 INF] Connected to MQTT broker
[18:45:35 INF] Connected to MQTT broker
[18:45:35 INF] MQTT service started
[18:45:35 INF] MQTT service started
[18:45:35 INF] HTTP GET /health responded 200 in 6.2425 ms
[18:45:35 INF] HTTP GET /health responded 200 in 6.2425 ms
[18:45:35 INF] MQTT service stopped
[18:45:35 INF] MQTT service stopped
[18:45:35 INF] PairingBackgroundService stopped
[18:45:35 INF] PairingBackgroundService stopped
[18:45:35 INF] TwinSyncBackgroundService stopped
[18:45:35 INF] TwinSyncBackgroundService stopped
[18:45:35 INF] Starting IoT Backend on port 8000
[18:45:35 INF] Starting IoT Backend on port 8000
[18:45:35 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:45:35 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:45:35 INF] PairingBackgroundService starting
[18:45:35 INF] PairingBackgroundService starting
[18:45:35 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:45:35 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:45:35 INF] Connected to MQTT broker
[18:45:35 INF] Connected to MQTT broker
[18:45:35 INF] PairingBackgroundService stopped
[18:45:35 INF] PairingBackgroundService stopped
[18:45:35 INF] TwinSyncBackgroundService stopped
[18:45:35 INF] TwinSyncBackgroundService stopped
[18:45:35 INF] Starting IoT Backend on port 8000
[18:45:35 INF] Starting IoT Backend on port 8000
[18:45:35 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:45:35 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:45:35 INF] PairingBackgroundService starting
[18:45:35 INF] PairingBackgroundService starting
[18:45:35 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:45:35 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:45:35 INF] Connected to MQTT broker
[18:45:35 INF] Connected to MQTT broker
[18:45:35 INF] PairingBackgroundService stopped
[18:45:35 INF] PairingBackgroundService stopped
[18:45:35 INF] TwinSyncBackgroundService stopped
[18:45:35 INF] TwinSyncBackgroundService stopped
[18:45:35 INF] Starting IoT Backend on port 8000
[18:45:35 INF] Starting IoT Backend on port 8000
[18:45:35 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:45:35 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:45:35 INF] PairingBackgroundService starting
[18:45:35 INF] PairingBackgroundService starting
[18:45:35 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:45:35 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:45:35 INF] Connected to MQTT broker
[18:45:35 INF] Connected to MQTT broker
[18:45:35 INF] PairingBackgroundService stopped
[18:45:35 INF] PairingBackgroundService stopped
[18:45:35 INF] TwinSyncBackgroundService stopped
[18:45:35 INF] TwinSyncBackgroundService stopped
[18:45:35 INF] Starting IoT Backend on port 8000
[18:45:35 INF] Starting IoT Backend on port 8000
[18:45:35 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:45:35 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:45:35 INF] PairingBackgroundService starting
[18:45:35 INF] PairingBackgroundService starting
[18:45:35 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:45:35 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:45:35 INF] Connected to MQTT broker
[18:45:35 INF] Connected to MQTT broker
[18:45:35 INF] PairingBackgroundService stopped
[18:45:35 INF] PairingBackgroundService stopped
[18:45:35 INF] TwinSyncBackgroundService stopped
[18:45:35 INF] TwinSyncBackgroundService stopped
[18:45:36 INF] Starting IoT Backend on port 8000
[18:45:36 INF] Starting IoT Backend on port 8000
[18:45:36 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:45:36 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:45:36 INF] PairingBackgroundService starting
[18:45:36 INF] PairingBackgroundService starting
[18:45:36 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:45:36 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:45:36 INF] Connected to MQTT broker
[18:45:36 INF] Connected to MQTT broker
[18:45:36 INF] PairingBackgroundService stopped
[18:45:36 INF] PairingBackgroundService stopped
[18:45:36 INF] TwinSyncBackgroundService stopped
[18:45:36 INF] TwinSyncBackgroundService stopped
[18:45:36 INF] Starting IoT Backend on port 8000
[18:45:36 INF] Starting IoT Backend on port 8000
[18:45:36 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:45:36 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:45:36 INF] PairingBackgroundService starting
[18:45:36 INF] PairingBackgroundService starting
[18:45:36 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:45:36 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:45:36 INF] Connected to MQTT broker
[18:45:36 INF] Connected to MQTT broker
  Passed IoT.Backend.IntegrationTests.Tests.HealthIntegrationTests.GetLiveness_ShouldAlwaysReturnOk [4 ms]
  Standard Output Messages:
 Creating WebApplicationFactory...
 Backend is ready
 Test fixture initialized
 Disposing test fixture...


  Passed IoT.Backend.IntegrationTests.Tests.HealthIntegrationTests.GetHealth_WhenAllHealthy_ShouldReturnHealthyStatus [10 ms]
  Standard Output Messages:
 Creating WebApplicationFactory...
 Backend is ready
 Test fixture initialized
 Disposing test fixture...


  Passed IoT.Backend.IntegrationTests.Tests.HealthIntegrationTests.GetHealth_ShouldShowDatabaseConnected [9 ms]
  Standard Output Messages:
 Creating WebApplicationFactory...
 Backend is ready
 Test fixture initialized
 Disposing test fixture...


  Passed IoT.Backend.IntegrationTests.Tests.HealthIntegrationTests.GetReadiness_WhenMqttConnected_ShouldReturnOk [4 ms]
  Standard Output Messages:
 Creating WebApplicationFactory...
 Backend is ready
 Test fixture initialized
 Disposing test fixture...


  Passed IoT.Backend.IntegrationTests.Tests.HealthIntegrationTests.GetHealth_WithNoOnlineCoordinator_ShouldStillReturnOk [9 ms]
  Standard Output Messages:
 Creating WebApplicationFactory...
 Backend is ready
 Test fixture initialized
 Disposing test fixture...


  Passed IoT.Backend.IntegrationTests.Tests.HealthIntegrationTests.GetHealth_ShouldReturnHealthStatus [9 ms]
  Standard Output Messages:
 Creating WebApplicationFactory...
 Backend is ready
 Test fixture initialized
 Disposing test fixture...


  Passed IoT.Backend.IntegrationTests.Tests.HealthIntegrationTests.GetHealth_ShouldHandleConcurrentRequests [56 ms]
  Standard Output Messages:
 Creating WebApplicationFactory...
 Backend is ready
 Test fixture initialized
 Disposing test fixture...


  Passed IoT.Backend.IntegrationTests.Tests.HealthIntegrationTests.GetLiveness_ShouldBeReliable_MultipleRequests [5 ms]
  Standard Output Messages:
 Creating WebApplicationFactory...
 Backend is ready
 Test fixture initialized
 Disposing test fixture...


[18:45:37 INF] TelemetryHandler subscribing to MQTT topics
[18:45:37 INF] TelemetryHandler subscribing to MQTT topics
[18:45:37 INF] Subscribed to site/+/coord/+/telemetry
[18:45:37 INF] Subscribed to site/+/coord/+/telemetry
[18:45:37 INF] Subscribed to site/+/coord/+/status
[18:45:37 INF] Subscribed to site/+/coord/+/status
[18:45:37 INF] Subscribed to site/+/ota/progress
[18:45:37 INF] Subscribed to site/+/ota/progress
[18:45:37 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:45:37 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:45:37 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:45:37 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:45:37 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:45:37 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:45:37 INF] Subscribed to farm/+/coord/+/pairing/request
[18:45:37 INF] Subscribed to farm/+/coord/+/pairing/request
[18:45:37 INF] Subscribed to farm/+/coord/+/pairing/status
[18:45:37 INF] Subscribed to farm/+/coord/+/pairing/status
[18:45:37 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:45:37 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:45:37 INF] TelemetryHandler subscribed to all telemetry topics
[18:45:37 INF] TelemetryHandler subscribed to all telemetry topics
[18:45:40 INF] PairingBackgroundService stopped
[18:45:40 INF] PairingBackgroundService stopped
[18:45:40 INF] TwinSyncBackgroundService stopped
[18:45:40 INF] TwinSyncBackgroundService stopped
  Passed IoT.Backend.IntegrationTests.Tests.HealthIntegrationTests.GetHealth_WithStaleCoordinator_ShouldShowCoordinatorFalse [4 s]
  Standard Output Messages:
 Creating WebApplicationFactory...
 Backend is ready
 Test fixture initialized
 Disposing test fixture...


[18:45:40 INF] Starting IoT Backend on port 8000
[18:45:40 INF] Starting IoT Backend on port 8000
[18:45:40 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:45:40 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:45:40 INF] PairingBackgroundService starting
[18:45:40 INF] PairingBackgroundService starting
[18:45:40 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:45:40 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:45:40 INF] Connected to MQTT broker
[18:45:40 INF] Connected to MQTT broker
[18:45:41 INF] TelemetryHandler subscribing to MQTT topics
[18:45:41 INF] TelemetryHandler subscribing to MQTT topics
[18:45:41 INF] Subscribed to site/+/coord/+/telemetry
[18:45:41 INF] Subscribed to site/+/coord/+/telemetry
[18:45:41 INF] Subscribed to site/+/coord/+/status
[18:45:41 INF] Subscribed to site/+/coord/+/status
[18:45:41 INF] Subscribed to site/+/ota/progress
[18:45:41 INF] Subscribed to site/+/ota/progress
[18:45:41 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:45:41 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:45:41 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:45:41 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:45:41 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:45:41 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:45:41 INF] Subscribed to farm/+/coord/+/pairing/request
[18:45:41 INF] Subscribed to farm/+/coord/+/pairing/request
[18:45:41 INF] Subscribed to farm/+/coord/+/pairing/status
[18:45:41 INF] Subscribed to farm/+/coord/+/pairing/status
[18:45:41 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:45:41 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:45:41 INF] TelemetryHandler subscribed to all telemetry topics
[18:45:41 INF] TelemetryHandler subscribed to all telemetry topics
[18:45:42 INF] PairingBackgroundService stopped
[18:45:42 INF] PairingBackgroundService stopped
[18:45:42 INF] TwinSyncBackgroundService stopped
[18:45:42 INF] TwinSyncBackgroundService stopped
[18:45:42 INF] Starting IoT Backend on port 8000
[18:45:42 INF] Starting IoT Backend on port 8000
[18:45:42 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:45:42 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:45:42 INF] PairingBackgroundService starting
[18:45:42 INF] PairingBackgroundService starting
[18:45:42 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:45:42 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:45:42 INF] HTTP GET /health/live responded 200 in 1.8901 ms
[18:45:42 INF] HTTP GET /health/live responded 200 in 1.8901 ms
[18:45:42 INF] Connected to MQTT broker
[18:45:42 INF] Connected to MQTT broker
[18:45:42 INF] MQTT service started
[18:45:42 INF] MQTT service started
  Passed IoT.Backend.IntegrationTests.Tests.HealthIntegrationTests.GetHealth_ShouldShowMqttConnected [9 ms]
  Standard Output Messages:
 Creating WebApplicationFactory...
 Backend is ready
 Test fixture initialized
 Disposing test fixture...


[18:45:43 INF] TelemetryHandler subscribing to MQTT topics
[18:45:43 INF] TelemetryHandler subscribing to MQTT topics
[18:45:43 INF] Subscribed to site/+/coord/+/telemetry
[18:45:43 INF] Subscribed to site/+/coord/+/telemetry
[18:45:43 INF] Subscribed to site/+/coord/+/status
[18:45:43 INF] Subscribed to site/+/coord/+/status
[18:45:43 INF] Subscribed to site/+/ota/progress
[18:45:43 INF] Subscribed to site/+/ota/progress
[18:45:43 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:45:43 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:45:43 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:45:43 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:45:43 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:45:43 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:45:43 INF] Subscribed to farm/+/coord/+/pairing/request
[18:45:43 INF] Subscribed to farm/+/coord/+/pairing/request
[18:45:43 INF] Subscribed to farm/+/coord/+/pairing/status
[18:45:43 INF] Subscribed to farm/+/coord/+/pairing/status
[18:45:43 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:45:43 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:45:43 INF] TelemetryHandler subscribed to all telemetry topics
[18:45:43 INF] TelemetryHandler subscribed to all telemetry topics
[18:45:45 INF] HTTP GET /health/live responded 200 in 0.5465 ms
[18:45:45 INF] HTTP GET /health/live responded 200 in 0.5465 ms
[18:45:45 INF] MQTT service stopped
[18:45:45 INF] MQTT service stopped
[18:45:45 INF] PairingBackgroundService stopped
[18:45:45 INF] PairingBackgroundService stopped
[18:45:45 INF] TwinSyncBackgroundService stopped
[18:45:45 INF] TwinSyncBackgroundService stopped
  Passed IoT.Backend.IntegrationTests.Tests.HealthIntegrationTests.GetLiveness_ShouldReturnValidTimestamp [4 ms]
  Standard Output Messages:
 Creating WebApplicationFactory...
 Backend is ready
 Test fixture initialized
 Disposing test fixture...


[18:45:45 INF] Starting IoT Backend on port 8000
[18:45:45 INF] Starting IoT Backend on port 8000
[18:45:45 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:45:45 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:45:45 INF] PairingBackgroundService starting
[18:45:45 INF] PairingBackgroundService starting
[18:45:45 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:45:45 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:45:45 INF] Connected to MQTT broker
[18:45:45 INF] Connected to MQTT broker
[18:45:46 INF] TelemetryHandler subscribing to MQTT topics
[18:45:46 INF] TelemetryHandler subscribing to MQTT topics
[18:45:46 INF] Subscribed to site/+/coord/+/telemetry
[18:45:46 INF] Subscribed to site/+/coord/+/telemetry
[18:45:46 INF] Subscribed to site/+/coord/+/status
[18:45:46 INF] Subscribed to site/+/coord/+/status
[18:45:46 INF] Subscribed to site/+/ota/progress
[18:45:46 INF] Subscribed to site/+/ota/progress
[18:45:46 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:45:46 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:45:46 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:45:46 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:45:46 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:45:46 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:45:46 INF] Subscribed to farm/+/coord/+/pairing/request
[18:45:46 INF] Subscribed to farm/+/coord/+/pairing/request
[18:45:46 INF] Subscribed to farm/+/coord/+/pairing/status
[18:45:46 INF] Subscribed to farm/+/coord/+/pairing/status
[18:45:46 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:45:46 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:45:46 INF] TelemetryHandler subscribed to all telemetry topics
[18:45:46 INF] TelemetryHandler subscribed to all telemetry topics
[18:45:48 INF] PairingBackgroundService stopped
[18:45:48 INF] PairingBackgroundService stopped
[18:45:48 INF] TwinSyncBackgroundService stopped
[18:45:48 INF] TwinSyncBackgroundService stopped
  Passed IoT.Backend.IntegrationTests.Tests.OtaIntegrationTests.UpdateOtaJobProgress_ShouldPersistProgress [2 s]
  Standard Output Messages:
 Creating WebApplicationFactory...
 Backend is ready
 Test fixture initialized
 Disposing test fixture...


[18:45:48 INF] Starting IoT Backend on port 8000
[18:45:48 INF] Starting IoT Backend on port 8000
[18:45:48 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:45:48 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:45:48 INF] PairingBackgroundService starting
[18:45:48 INF] PairingBackgroundService starting
[18:45:49 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:45:49 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:45:49 INF] Connected to MQTT broker
[18:45:49 INF] Connected to MQTT broker
[18:45:49 INF] TelemetryHandler subscribing to MQTT topics
[18:45:49 INF] TelemetryHandler subscribing to MQTT topics
[18:45:49 INF] Subscribed to site/+/coord/+/telemetry
[18:45:49 INF] Subscribed to site/+/coord/+/telemetry
[18:45:49 INF] Subscribed to site/+/coord/+/status
[18:45:49 INF] Subscribed to site/+/coord/+/status
[18:45:50 INF] Subscribed to site/+/ota/progress
[18:45:50 INF] Subscribed to site/+/ota/progress
[18:45:50 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:45:50 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:45:50 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:45:50 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:45:50 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:45:50 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:45:50 INF] Subscribed to farm/+/coord/+/pairing/request
[18:45:50 INF] Subscribed to farm/+/coord/+/pairing/request
[18:45:50 INF] Subscribed to farm/+/coord/+/pairing/status
[18:45:50 INF] Subscribed to farm/+/coord/+/pairing/status
[18:45:50 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:45:50 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:45:50 INF] TelemetryHandler subscribed to all telemetry topics
[18:45:50 INF] TelemetryHandler subscribed to all telemetry topics
[18:45:52 INF] PairingBackgroundService stopped
[18:45:52 INF] PairingBackgroundService stopped
[18:45:52 INF] TwinSyncBackgroundService stopped
[18:45:52 INF] TwinSyncBackgroundService stopped
  Passed IoT.Backend.IntegrationTests.Tests.OtaIntegrationTests.CancelOtaJob_ShouldUpdateStatus [1 s]
  Standard Output Messages:
 Creating WebApplicationFactory...
 Backend is ready
 Test fixture initialized
 Disposing test fixture...


[18:45:52 INF] Starting IoT Backend on port 8000
[18:45:52 INF] Starting IoT Backend on port 8000
[18:45:52 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:45:52 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:45:52 INF] PairingBackgroundService starting
[18:45:52 INF] PairingBackgroundService starting
[18:45:52 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:45:52 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:45:52 INF] Connected to MQTT broker
[18:45:52 INF] Connected to MQTT broker
[18:45:53 INF] TelemetryHandler subscribing to MQTT topics
[18:45:53 INF] TelemetryHandler subscribing to MQTT topics
[18:45:53 INF] Subscribed to site/+/coord/+/telemetry
[18:45:53 INF] Subscribed to site/+/coord/+/telemetry
[18:45:53 INF] Subscribed to site/+/coord/+/status
[18:45:53 INF] Subscribed to site/+/coord/+/status
[18:45:53 INF] Subscribed to site/+/ota/progress
[18:45:53 INF] Subscribed to site/+/ota/progress
[18:45:53 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:45:53 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:45:53 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:45:53 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:45:53 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:45:53 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:45:53 INF] Subscribed to farm/+/coord/+/pairing/request
[18:45:53 INF] Subscribed to farm/+/coord/+/pairing/request
[18:45:53 INF] Subscribed to farm/+/coord/+/pairing/status
[18:45:53 INF] Subscribed to farm/+/coord/+/pairing/status
[18:45:53 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:45:53 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:45:53 INF] TelemetryHandler subscribed to all telemetry topics
[18:45:53 INF] TelemetryHandler subscribed to all telemetry topics
[18:45:54 INF] PairingBackgroundService stopped
[18:45:54 INF] PairingBackgroundService stopped
[18:45:54 INF] TwinSyncBackgroundService stopped
[18:45:54 INF] TwinSyncBackgroundService stopped
  Passed IoT.Backend.IntegrationTests.Tests.OtaIntegrationTests.GetFirmware_WhenNotExists_ShouldReturnNotFound [12 ms]
  Standard Output Messages:
 Creating WebApplicationFactory...
 Backend is ready
 Test fixture initialized
 Disposing test fixture...


[18:45:54 INF] Starting IoT Backend on port 8000
[18:45:54 INF] Starting IoT Backend on port 8000
[18:45:54 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:45:54 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:45:54 INF] PairingBackgroundService starting
[18:45:54 INF] PairingBackgroundService starting
[18:45:54 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:45:54 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:45:54 INF] Connected to MQTT broker
[18:45:54 INF] Connected to MQTT broker
[18:45:55 INF] TelemetryHandler subscribing to MQTT topics
[18:45:55 INF] TelemetryHandler subscribing to MQTT topics
[18:45:55 INF] Subscribed to site/+/coord/+/telemetry
[18:45:55 INF] Subscribed to site/+/coord/+/telemetry
[18:45:55 INF] Subscribed to site/+/coord/+/status
[18:45:55 INF] Subscribed to site/+/coord/+/status
[18:45:55 INF] Subscribed to site/+/ota/progress
[18:45:55 INF] Subscribed to site/+/ota/progress
[18:45:55 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:45:55 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:45:55 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:45:55 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:45:55 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:45:55 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:45:55 INF] Subscribed to farm/+/coord/+/pairing/request
[18:45:55 INF] Subscribed to farm/+/coord/+/pairing/request
[18:45:55 INF] Subscribed to farm/+/coord/+/pairing/status
[18:45:55 INF] Subscribed to farm/+/coord/+/pairing/status
[18:45:55 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:45:55 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:45:55 INF] TelemetryHandler subscribed to all telemetry topics
[18:45:55 INF] TelemetryHandler subscribed to all telemetry topics
[18:45:59 INF] PairingBackgroundService stopped
[18:45:59 INF] PairingBackgroundService stopped
[18:45:59 INF] TwinSyncBackgroundService stopped
[18:45:59 INF] TwinSyncBackgroundService stopped
  Passed IoT.Backend.IntegrationTests.Tests.OtaIntegrationTests.ListOtaJobs_ShouldReturnAllJobs [1 s]
  Standard Output Messages:
 Creating WebApplicationFactory...
 Backend is ready
 Test fixture initialized
 Disposing test fixture...


[18:45:59 INF] Starting IoT Backend on port 8000
[18:45:59 INF] Starting IoT Backend on port 8000
[18:45:59 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:45:59 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:45:59 INF] PairingBackgroundService starting
[18:45:59 INF] PairingBackgroundService starting
[18:45:59 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:45:59 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:45:59 INF] Connected to MQTT broker
[18:45:59 INF] Connected to MQTT broker
[18:46:00 INF] TelemetryHandler subscribing to MQTT topics
[18:46:00 INF] TelemetryHandler subscribing to MQTT topics
[18:46:00 INF] Subscribed to site/+/coord/+/telemetry
[18:46:00 INF] Subscribed to site/+/coord/+/telemetry
[18:46:00 INF] Subscribed to site/+/coord/+/status
[18:46:00 INF] Subscribed to site/+/coord/+/status
[18:46:00 INF] Subscribed to site/+/ota/progress
[18:46:00 INF] Subscribed to site/+/ota/progress
[18:46:00 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:46:00 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:46:00 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:46:00 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:46:00 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:46:00 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:46:00 INF] Subscribed to farm/+/coord/+/pairing/request
[18:46:00 INF] Subscribed to farm/+/coord/+/pairing/request
[18:46:00 INF] Subscribed to farm/+/coord/+/pairing/status
[18:46:00 INF] Subscribed to farm/+/coord/+/pairing/status
[18:46:00 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:46:00 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:46:00 INF] TelemetryHandler subscribed to all telemetry topics
[18:46:00 INF] TelemetryHandler subscribed to all telemetry topics
[18:46:04 INF] PairingBackgroundService stopped
[18:46:04 INF] PairingBackgroundService stopped
[18:46:04 INF] TwinSyncBackgroundService stopped
[18:46:04 INF] TwinSyncBackgroundService stopped
  Passed IoT.Backend.IntegrationTests.Tests.OtaIntegrationTests.ListFirmware_ShouldReturnAllVersions [2 s]
  Standard Output Messages:
 Creating WebApplicationFactory...
 Backend is ready
 Test fixture initialized
 Disposing test fixture...


[18:46:04 INF] Starting IoT Backend on port 8000
[18:46:04 INF] Starting IoT Backend on port 8000
[18:46:04 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:46:04 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:46:04 INF] PairingBackgroundService starting
[18:46:04 INF] PairingBackgroundService starting
[18:46:04 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:46:04 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:46:04 INF] Connected to MQTT broker
[18:46:04 INF] Connected to MQTT broker
[18:46:05 INF] TelemetryHandler subscribing to MQTT topics
[18:46:05 INF] TelemetryHandler subscribing to MQTT topics
[18:46:05 INF] Subscribed to site/+/coord/+/telemetry
[18:46:05 INF] Subscribed to site/+/coord/+/telemetry
[18:46:05 INF] Subscribed to site/+/coord/+/status
[18:46:05 INF] Subscribed to site/+/coord/+/status
[18:46:05 INF] Subscribed to site/+/ota/progress
[18:46:05 INF] Subscribed to site/+/ota/progress
[18:46:05 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:46:05 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:46:05 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:46:05 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:46:05 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:46:05 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:46:05 INF] Subscribed to farm/+/coord/+/pairing/request
[18:46:05 INF] Subscribed to farm/+/coord/+/pairing/request
[18:46:05 INF] Subscribed to farm/+/coord/+/pairing/status
[18:46:05 INF] Subscribed to farm/+/coord/+/pairing/status
[18:46:05 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:46:05 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:46:05 INF] TelemetryHandler subscribed to all telemetry topics
[18:46:05 INF] TelemetryHandler subscribed to all telemetry topics
[18:46:07 INF] PairingBackgroundService stopped
[18:46:07 INF] PairingBackgroundService stopped
[18:46:07 INF] TwinSyncBackgroundService stopped
[18:46:07 INF] TwinSyncBackgroundService stopped
  Passed IoT.Backend.IntegrationTests.Tests.OtaIntegrationTests.CreateFirmware_ShouldPersistToDatabase [1 s]
  Standard Output Messages:
 Creating WebApplicationFactory...
 Backend is ready
 Test fixture initialized
 Disposing test fixture...


[18:46:07 INF] Starting IoT Backend on port 8000
[18:46:07 INF] Starting IoT Backend on port 8000
[18:46:07 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:46:07 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:46:07 INF] PairingBackgroundService starting
[18:46:07 INF] PairingBackgroundService starting
[18:46:07 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:46:07 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:46:07 INF] HTTP GET /health/live responded 200 in 2.4256 ms
[18:46:07 INF] HTTP GET /health/live responded 200 in 2.4256 ms
[18:46:07 INF] Connected to MQTT broker
[18:46:07 INF] Connected to MQTT broker
[18:46:07 INF] MQTT service started
[18:46:07 INF] MQTT service started
[18:46:08 INF] TelemetryHandler subscribing to MQTT topics
[18:46:08 INF] TelemetryHandler subscribing to MQTT topics
[18:46:08 INF] Subscribed to site/+/coord/+/telemetry
[18:46:08 INF] Subscribed to site/+/coord/+/telemetry
[18:46:08 INF] Subscribed to site/+/coord/+/status
[18:46:08 INF] Subscribed to site/+/coord/+/status
[18:46:08 INF] Subscribed to site/+/ota/progress
[18:46:08 INF] Subscribed to site/+/ota/progress
[18:46:08 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:46:08 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:46:08 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:46:08 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:46:08 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:46:08 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:46:08 INF] Subscribed to farm/+/coord/+/pairing/request
[18:46:08 INF] Subscribed to farm/+/coord/+/pairing/request
[18:46:08 INF] Subscribed to farm/+/coord/+/pairing/status
[18:46:08 INF] Subscribed to farm/+/coord/+/pairing/status
[18:46:08 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:46:08 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:46:08 INF] TelemetryHandler subscribed to all telemetry topics
[18:46:08 INF] TelemetryHandler subscribed to all telemetry topics
[18:46:10 INF] Deleted firmware version fw-delete-test, count: 1
[18:46:10 INF] Deleted firmware version fw-delete-test, count: 1
[18:46:10 INF] Deleted firmware version fw-delete-test (1.0.0-delete for coordinator)
[18:46:10 INF] Deleted firmware version fw-delete-test (1.0.0-delete for coordinator)
[18:46:10 INF] HTTP DELETE /api/ota/firmware/fw-delete-test responded 200 in 10.0493 ms
[18:46:10 INF] HTTP DELETE /api/ota/firmware/fw-delete-test responded 200 in 10.0493 ms
[18:46:10 INF] PairingBackgroundService stopped
[18:46:10 INF] MQTT service stopped
[18:46:10 INF] MQTT service stopped
[18:46:10 INF] PairingBackgroundService stopped
[18:46:10 INF] TwinSyncBackgroundService stopped
[18:46:10 INF] TwinSyncBackgroundService stopped
  Passed IoT.Backend.IntegrationTests.Tests.OtaIntegrationTests.DeleteFirmware_ShouldRemoveFromDatabase [1 s]
  Standard Output Messages:
 Creating WebApplicationFactory...
 Backend is ready
 Test fixture initialized
 Disposing test fixture...


[18:46:10 INF] Starting IoT Backend on port 8000
[18:46:10 INF] Starting IoT Backend on port 8000
[18:46:10 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:46:10 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:46:10 INF] PairingBackgroundService starting
[18:46:10 INF] PairingBackgroundService starting
[18:46:10 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:46:10 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:46:10 INF] HTTP GET /health/live responded 200 in 3.6177 ms
[18:46:10 INF] HTTP GET /health/live responded 200 in 3.6177 ms
[18:46:10 INF] Connected to MQTT broker
[18:46:10 INF] Connected to MQTT broker
[18:46:10 INF] MQTT service started
[18:46:10 INF] MQTT service started
[18:46:11 INF] TelemetryHandler subscribing to MQTT topics
[18:46:11 INF] TelemetryHandler subscribing to MQTT topics
[18:46:11 INF] Subscribed to site/+/coord/+/telemetry
[18:46:11 INF] Subscribed to site/+/coord/+/telemetry
[18:46:11 INF] Subscribed to site/+/coord/+/status
[18:46:11 INF] Subscribed to site/+/coord/+/status
[18:46:11 INF] Subscribed to site/+/ota/progress
[18:46:11 INF] Subscribed to site/+/ota/progress
[18:46:11 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:46:11 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:46:11 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:46:11 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:46:11 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:46:11 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:46:11 INF] Subscribed to farm/+/coord/+/pairing/request
[18:46:11 INF] Subscribed to farm/+/coord/+/pairing/request
[18:46:11 INF] Subscribed to farm/+/coord/+/pairing/status
[18:46:11 INF] Subscribed to farm/+/coord/+/pairing/status
[18:46:11 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:46:11 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:46:11 INF] TelemetryHandler subscribed to all telemetry topics
[18:46:11 INF] TelemetryHandler subscribed to all telemetry topics
[18:46:11 INF] HTTP GET /api/ota/jobs/job-get-test responded 200 in 8.7131 ms
[18:46:11 INF] HTTP GET /api/ota/jobs/job-get-test responded 200 in 8.7131 ms
[18:46:11 INF] MQTT service stopped
[18:46:11 INF] MQTT service stopped
[18:46:11 INF] PairingBackgroundService stopped
[18:46:11 INF] PairingBackgroundService stopped
[18:46:11 INF] TwinSyncBackgroundService stopped
[18:46:11 INF] TwinSyncBackgroundService stopped
[18:46:11 INF] Starting IoT Backend on port 8000
[18:46:11 INF] Starting IoT Backend on port 8000
[18:46:11 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:46:11 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:46:11 INF] PairingBackgroundService starting
[18:46:11 INF] PairingBackgroundService starting
[18:46:11 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:46:11 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:46:11 INF] Connected to MQTT broker
[18:46:11 INF] Connected to MQTT broker
  Passed IoT.Backend.IntegrationTests.Tests.OtaIntegrationTests.GetOtaJob_WhenExists_ShouldReturnJob [1 s]
  Standard Output Messages:
 Creating WebApplicationFactory...
 Backend is ready
 Test fixture initialized
 Disposing test fixture...


[18:46:10 INF] TelemetryHandler subscribing to MQTT topics
[18:46:10 INF] TelemetryHandler subscribing to MQTT topics
[18:46:10 INF] Subscribed to site/+/coord/+/telemetry
[18:46:10 INF] Subscribed to site/+/coord/+/telemetry
[18:46:10 INF] Subscribed to site/+/coord/+/status
[18:46:10 INF] Subscribed to site/+/coord/+/status
[18:46:10 INF] Subscribed to site/+/ota/progress
[18:46:10 INF] Subscribed to site/+/ota/progress
[18:46:10 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:46:10 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:46:10 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:46:10 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:46:10 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:46:10 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:46:10 INF] Subscribed to farm/+/coord/+/pairing/request
[18:46:10 INF] Subscribed to farm/+/coord/+/pairing/request
[18:46:10 INF] Subscribed to farm/+/coord/+/pairing/status
[18:46:10 INF] Subscribed to farm/+/coord/+/pairing/status
[18:46:10 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:46:10 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:46:10 INF] TelemetryHandler subscribed to all telemetry topics
[18:46:10 INF] TelemetryHandler subscribed to all telemetry topics
[18:46:11 INF] PairingBackgroundService stopped
[18:46:11 INF] PairingBackgroundService stopped
[18:46:11 INF] TwinSyncBackgroundService stopped
[18:46:11 INF] TwinSyncBackgroundService stopped
[18:46:11 INF] Starting IoT Backend on port 8000
[18:46:11 INF] Starting IoT Backend on port 8000
[18:46:11 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:46:11 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:46:11 INF] PairingBackgroundService starting
[18:46:11 INF] PairingBackgroundService starting
[18:46:11 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:46:11 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:46:11 INF] Connected to MQTT broker
[18:46:11 INF] Connected to MQTT broker
  Passed IoT.Backend.IntegrationTests.Tests.OtaIntegrationTests.GetLatestFirmware_ShouldReturnMostRecent [1 s]
  Standard Output Messages:
 Creating WebApplicationFactory...
 Backend is ready
 Test fixture initialized
 Disposing test fixture...


[18:46:12 INF] TelemetryHandler subscribing to MQTT topics
[18:46:12 INF] TelemetryHandler subscribing to MQTT topics
[18:46:12 INF] Subscribed to site/+/coord/+/telemetry
[18:46:12 INF] Subscribed to site/+/coord/+/telemetry
[18:46:12 INF] Subscribed to site/+/coord/+/status
[18:46:12 INF] Subscribed to site/+/coord/+/status
[18:46:12 INF] Subscribed to site/+/ota/progress
[18:46:12 INF] Subscribed to site/+/ota/progress
[18:46:12 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:46:12 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:46:12 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:46:12 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:46:12 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:46:12 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:46:12 INF] Subscribed to farm/+/coord/+/pairing/request
[18:46:12 INF] Subscribed to farm/+/coord/+/pairing/request
[18:46:12 INF] Subscribed to farm/+/coord/+/pairing/status
[18:46:12 INF] Subscribed to farm/+/coord/+/pairing/status
[18:46:12 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:46:12 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:46:12 INF] TelemetryHandler subscribed to all telemetry topics
[18:46:12 INF] TelemetryHandler subscribed to all telemetry topics
[18:46:15 INF] PairingBackgroundService stopped
[18:46:15 INF] PairingBackgroundService stopped
[18:46:15 INF] TwinSyncBackgroundService stopped
[18:46:15 INF] TwinSyncBackgroundService stopped
  Passed IoT.Backend.IntegrationTests.Tests.OtaIntegrationTests.StartOtaJob_ShouldCreateJobInDatabase [2 s]
  Standard Output Messages:
 Creating WebApplicationFactory...
 Backend is ready
 Test fixture initialized
 Disposing test fixture...


[18:46:15 INF] Starting IoT Backend on port 8000
[18:46:15 INF] Starting IoT Backend on port 8000
[18:46:15 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:46:15 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:46:15 INF] PairingBackgroundService starting
[18:46:15 INF] PairingBackgroundService starting
[18:46:15 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:46:15 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:46:15 INF] Connected to MQTT broker
[18:46:15 INF] Connected to MQTT broker
[18:46:16 INF] TelemetryHandler subscribing to MQTT topics
[18:46:16 INF] TelemetryHandler subscribing to MQTT topics
[18:46:16 INF] Subscribed to site/+/coord/+/telemetry
[18:46:16 INF] Subscribed to site/+/coord/+/telemetry
[18:46:16 INF] Subscribed to site/+/coord/+/status
[18:46:16 INF] Subscribed to site/+/coord/+/status
[18:46:16 INF] Subscribed to site/+/ota/progress
[18:46:16 INF] Subscribed to site/+/ota/progress
[18:46:16 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:46:16 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:46:16 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:46:16 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:46:16 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:46:16 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:46:16 INF] Subscribed to farm/+/coord/+/pairing/request
[18:46:16 INF] Subscribed to farm/+/coord/+/pairing/request
[18:46:16 INF] Subscribed to farm/+/coord/+/pairing/status
[18:46:16 INF] Subscribed to farm/+/coord/+/pairing/status
[18:46:16 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:46:16 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:46:16 INF] TelemetryHandler subscribed to all telemetry topics
[18:46:16 INF] TelemetryHandler subscribed to all telemetry topics
[18:46:16 INF] PairingBackgroundService stopped
[18:46:16 INF] PairingBackgroundService stopped
[18:46:16 INF] TwinSyncBackgroundService stopped
[18:46:16 INF] TwinSyncBackgroundService stopped
[18:46:16 INF] Starting IoT Backend on port 8000
[18:46:16 INF] Starting IoT Backend on port 8000
[18:46:16 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:46:16 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:46:16 INF] PairingBackgroundService starting
[18:46:16 INF] PairingBackgroundService starting
[18:46:16 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:46:16 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:46:16 INF] Connected to MQTT broker
[18:46:16 INF] Connected to MQTT broker
  Passed IoT.Backend.IntegrationTests.Tests.OtaIntegrationTests.ListFirmware_WithDeviceTypeFilter_ShouldFilterCorrectly [1 s]
  Standard Output Messages:
 Creating WebApplicationFactory...
 Backend is ready
 Test fixture initialized
 Disposing test fixture...


[18:46:17 INF] TelemetryHandler subscribing to MQTT topics
[18:46:17 INF] TelemetryHandler subscribing to MQTT topics
[18:46:17 INF] Subscribed to site/+/coord/+/telemetry
[18:46:17 INF] Subscribed to site/+/coord/+/telemetry
[18:46:17 INF] Subscribed to site/+/coord/+/status
[18:46:17 INF] Subscribed to site/+/coord/+/status
[18:46:17 INF] Subscribed to site/+/ota/progress
[18:46:17 INF] Subscribed to site/+/ota/progress
[18:46:17 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:46:17 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:46:17 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:46:17 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:46:17 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:46:17 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:46:17 INF] Subscribed to farm/+/coord/+/pairing/request
[18:46:17 INF] Subscribed to farm/+/coord/+/pairing/request
[18:46:17 INF] Subscribed to farm/+/coord/+/pairing/status
[18:46:17 INF] Subscribed to farm/+/coord/+/pairing/status
[18:46:17 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:46:17 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:46:17 INF] TelemetryHandler subscribed to all telemetry topics
[18:46:17 INF] TelemetryHandler subscribed to all telemetry topics
[18:46:19 INF] PairingBackgroundService stopped
[18:46:19 INF] PairingBackgroundService stopped
[18:46:19 INF] TwinSyncBackgroundService stopped
[18:46:19 INF] TwinSyncBackgroundService stopped
  Passed IoT.Backend.IntegrationTests.Tests.OtaIntegrationTests.GetFirmware_WhenExists_ShouldReturnFirmware [800 ms]
  Standard Output Messages:
 Creating WebApplicationFactory...
 Backend is ready
 Test fixture initialized
 Disposing test fixture...


[18:46:19 INF] Starting IoT Backend on port 8000
[18:46:19 INF] Starting IoT Backend on port 8000
[18:46:19 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:46:19 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:46:19 INF] PairingBackgroundService starting
[18:46:19 INF] PairingBackgroundService starting
[18:46:19 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:46:19 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:46:19 INF] Connected to MQTT broker
[18:46:19 INF] Connected to MQTT broker
[18:46:20 INF] PairingBackgroundService stopped
[18:46:20 INF] PairingBackgroundService stopped
[18:46:20 INF] TwinSyncBackgroundService stopped
[18:46:20 INF] TwinSyncBackgroundService stopped
[18:46:20 INF] Starting IoT Backend on port 8000
[18:46:20 INF] Starting IoT Backend on port 8000
[18:46:20 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:46:20 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:46:20 INF] PairingBackgroundService starting
[18:46:20 INF] PairingBackgroundService starting
[18:46:20 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:46:20 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:46:20 INF] HTTP GET /health/live responded 200 in 1.6398 ms
[18:46:20 INF] HTTP GET /health/live responded 200 in 1.6398 ms
[18:46:20 INF] Connected to MQTT broker
[18:46:20 INF] Connected to MQTT broker
[18:46:20 INF] MQTT service started
[18:46:20 INF] MQTT service started
  Passed IoT.Backend.IntegrationTests.Tests.OtaIntegrationTests.ListOtaJobs_WithFarmFilter_ShouldFilterCorrectly [922 ms]
  Standard Output Messages:
 Creating WebApplicationFactory...
 Backend is ready
 Test fixture initialized
 Disposing test fixture...


[18:46:21 INF] TelemetryHandler subscribing to MQTT topics
[18:46:21 INF] TelemetryHandler subscribing to MQTT topics
[18:46:21 INF] Subscribed to site/+/coord/+/telemetry
[18:46:21 INF] Subscribed to site/+/coord/+/telemetry
[18:46:21 INF] Subscribed to site/+/coord/+/status
[18:46:21 INF] Subscribed to site/+/coord/+/status
[18:46:21 INF] Subscribed to site/+/ota/progress
[18:46:21 INF] Subscribed to site/+/ota/progress
[18:46:21 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:46:21 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:46:21 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:46:21 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:46:21 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:46:21 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:46:21 INF] Subscribed to farm/+/coord/+/pairing/request
[18:46:21 INF] Subscribed to farm/+/coord/+/pairing/request
[18:46:21 INF] Subscribed to farm/+/coord/+/pairing/status
[18:46:21 INF] Subscribed to farm/+/coord/+/pairing/status
[18:46:21 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:46:21 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:46:21 INF] TelemetryHandler subscribed to all telemetry topics
[18:46:21 INF] TelemetryHandler subscribed to all telemetry topics
[18:46:22 INF] Started pairing session for test-farm-get/coord-get with duration 60s
[18:46:22 INF] Started pairing session for test-farm-get/coord-get with duration 60s
[18:46:22 INF] Pairing session started for test-farm-get/coord-get via REST API
[18:46:22 INF] Pairing session started for test-farm-get/coord-get via REST API
[18:46:22 INF] HTTP POST /api/pairing/start responded 200 in 12.2902 ms
[18:46:22 INF] HTTP POST /api/pairing/start responded 200 in 12.2902 ms
[18:46:22 INF] HTTP GET /api/pairing/session/test-farm-get/coord-get responded 200 in 3.3563 ms
[18:46:22 INF] HTTP GET /api/pairing/session/test-farm-get/coord-get responded 200 in 3.3563 ms
[18:46:22 INF] MQTT service stopped
[18:46:22 INF] MQTT service stopped
[18:46:22 INF] PairingBackgroundService stopped
[18:46:22 INF] PairingBackgroundService stopped
[18:46:22 INF] TwinSyncBackgroundService stopped
[18:46:22 INF] TwinSyncBackgroundService stopped
  Passed IoT.Backend.IntegrationTests.Tests.PairingIntegrationTests.GetActiveSession_WhenSessionExists_ShouldReturnSession [2 s]
  Standard Output Messages:
 Creating WebApplicationFactory...
 Backend is ready
 Test fixture initialized
 MQTT Test Client connecting to host.docker.internal:54807 as test-device-89d3a1ce5b934e62970a19e3f7e7f097...
 MQTT Test Client connected
 Subscribed to: farm/+/coord/+/cmd
 Received message on: farm/test-farm-get/coord/coord-get/cmd
 MQTT Test Client disconnected
 Disposing test fixture...


[18:46:22 INF] Starting IoT Backend on port 8000
[18:46:22 INF] Starting IoT Backend on port 8000
[18:46:22 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:46:22 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:46:22 INF] PairingBackgroundService starting
[18:46:22 INF] PairingBackgroundService starting
[18:46:22 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:46:22 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:46:22 INF] HTTP GET /health/live responded 200 in 2.3015 ms
[18:46:22 INF] HTTP GET /health/live responded 200 in 2.3015 ms
[18:46:22 INF] Connected to MQTT broker
[18:46:22 INF] Connected to MQTT broker
[18:46:22 INF] MQTT service started
[18:46:22 INF] MQTT service started
[18:46:22 INF] HTTP GET /api/pairing/session/nonexistent-farm/nonexistent-coord responded 404 in 3.3250 ms
[18:46:22 INF] HTTP GET /api/pairing/session/nonexistent-farm/nonexistent-coord responded 404 in 3.3250 ms
[18:46:22 INF] MQTT service stopped
[18:46:22 INF] MQTT service stopped
[18:46:22 INF] PairingBackgroundService stopped
[18:46:22 INF] PairingBackgroundService stopped
[18:46:22 INF] TwinSyncBackgroundService stopped
[18:46:22 INF] TwinSyncBackgroundService stopped
[18:46:22 INF] Starting IoT Backend on port 8000
[18:46:22 INF] Starting IoT Backend on port 8000
[18:46:22 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:46:22 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:46:22 INF] PairingBackgroundService starting
[18:46:22 INF] PairingBackgroundService starting
[18:46:22 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:46:22 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:46:22 INF] HTTP GET /health/live responded 200 in 1.4521 ms
[18:46:22 INF] HTTP GET /health/live responded 200 in 1.4521 ms
[18:46:22 INF] Connected to MQTT broker
[18:46:22 INF] Connected to MQTT broker
[18:46:22 INF] MQTT service started
[18:46:22 INF] MQTT service started
[18:46:23 INF] TelemetryHandler subscribing to MQTT topics
[18:46:23 INF] TelemetryHandler subscribing to MQTT topics
[18:46:23 INF] Subscribed to site/+/coord/+/telemetry
[18:46:23 INF] Subscribed to site/+/coord/+/telemetry
[18:46:23 INF] Subscribed to site/+/coord/+/status
[18:46:23 INF] Subscribed to site/+/coord/+/status
[18:46:23 INF] Subscribed to site/+/ota/progress
[18:46:23 INF] Subscribed to site/+/ota/progress
[18:46:23 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:46:23 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:46:23 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:46:23 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:46:23 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:46:23 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:46:23 INF] Subscribed to farm/+/coord/+/pairing/request
[18:46:23 INF] Subscribed to farm/+/coord/+/pairing/request
[18:46:23 INF] Subscribed to farm/+/coord/+/pairing/status
[18:46:23 INF] Subscribed to farm/+/coord/+/pairing/status
[18:46:23 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:46:23 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:46:23 INF] TelemetryHandler subscribed to all telemetry topics
[18:46:23 INF] TelemetryHandler subscribed to all telemetry topics
  Passed IoT.Backend.IntegrationTests.Tests.PairingIntegrationTests.GetActiveSession_WhenNoSession_ShouldReturnNotFound [7 ms]
  Standard Output Messages:
 Creating WebApplicationFactory...
 Backend is ready
 Test fixture initialized
 MQTT Test Client connecting to host.docker.internal:54807 as test-device-48fb4d3d4eac422c84a9c402259b2ff4...
 MQTT Test Client connected
 Subscribed to: farm/+/coord/+/cmd
 MQTT Test Client disconnected
 Disposing test fixture...


[18:46:24 INF] Started pairing session for test-farm/coord-001 with duration 60s
[18:46:24 INF] Started pairing session for test-farm/coord-001 with duration 60s
[18:46:24 INF] Pairing session started for test-farm/coord-001 via REST API
[18:46:24 INF] Pairing session started for test-farm/coord-001 via REST API
[18:46:24 INF] HTTP POST /api/pairing/start responded 200 in 7.2749 ms
[18:46:24 INF] HTTP POST /api/pairing/start responded 200 in 7.2749 ms
[18:46:24 INF] MQTT service stopped
[18:46:24 INF] MQTT service stopped
[18:46:24 INF] PairingBackgroundService stopped
[18:46:24 INF] PairingBackgroundService stopped
[18:46:24 INF] TwinSyncBackgroundService stopped
[18:46:24 INF] TwinSyncBackgroundService stopped
[18:46:24 INF] Starting IoT Backend on port 8000
[18:46:24 INF] Starting IoT Backend on port 8000
[18:46:24 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:46:24 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:46:24 INF] PairingBackgroundService starting
[18:46:24 INF] PairingBackgroundService starting
[18:46:24 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:46:24 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:46:24 INF] Connected to MQTT broker
[18:46:24 INF] Connected to MQTT broker
  Passed IoT.Backend.IntegrationTests.Tests.PairingIntegrationTests.StartPairingSession_ShouldSendMqttCommand [2 s]
  Standard Output Messages:
 Creating WebApplicationFactory...
 Backend is ready
 Test fixture initialized
 MQTT Test Client connecting to host.docker.internal:54807 as test-device-b0a0b56d0b9c4313b1a5376527d678c2...
 MQTT Test Client connected
 Subscribed to: farm/+/coord/+/cmd
 Received message on: farm/test-farm/coord/coord-001/cmd
 MQTT Test Client disconnected
 Disposing test fixture...


[18:46:25 INF] TelemetryHandler subscribing to MQTT topics
[18:46:25 INF] TelemetryHandler subscribing to MQTT topics
[18:46:25 INF] Subscribed to site/+/coord/+/telemetry
[18:46:25 INF] Subscribed to site/+/coord/+/telemetry
[18:46:25 INF] Subscribed to site/+/coord/+/status
[18:46:25 INF] Subscribed to site/+/coord/+/status
[18:46:25 INF] Subscribed to site/+/ota/progress
[18:46:25 INF] Subscribed to site/+/ota/progress
[18:46:25 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:46:25 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:46:25 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:46:25 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:46:25 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:46:25 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:46:25 INF] Subscribed to farm/+/coord/+/pairing/request
[18:46:25 INF] Subscribed to farm/+/coord/+/pairing/request
[18:46:25 INF] Subscribed to farm/+/coord/+/pairing/status
[18:46:25 INF] Subscribed to farm/+/coord/+/pairing/status
[18:46:25 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:46:25 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:46:25 INF] TelemetryHandler subscribed to all telemetry topics
[18:46:25 INF] TelemetryHandler subscribed to all telemetry topics
[18:46:26 INF] Started pairing session for test-farm-approve/coord-approve with duration 60s
[18:46:26 INF] Started pairing session for test-farm-approve/coord-approve with duration 60s
[18:46:27 INF] Received pairing request from tower tower-approved (MAC: AA:BB:CC:DD:EE:02) on test-farm-approve/coord-approve
[18:46:27 INF] Received pairing request from tower tower-approved (MAC: AA:BB:CC:DD:EE:02) on test-farm-approve/coord-approve
[18:46:27 INF] Received pairing request from tower tower-approved (MAC: AA:BB:CC:DD:EE:02) for test-farm-approve/coord-approve
[18:46:27 INF] Received pairing request from tower tower-approved (MAC: AA:BB:CC:DD:EE:02) for test-farm-approve/coord-approve
[18:46:28 INF] Approved pairing for tower tower-approved on test-farm-approve/coord-approve
[18:46:28 INF] Approved pairing for tower tower-approved on test-farm-approve/coord-approve
[18:46:28 INF] PairingBackgroundService stopped
[18:46:28 INF] PairingBackgroundService stopped
[18:46:28 INF] TwinSyncBackgroundService stopped
[18:46:28 INF] TwinSyncBackgroundService stopped
  Passed IoT.Backend.IntegrationTests.Tests.PairingIntegrationTests.ApprovePairingRequest_ShouldCreateTowerAndSendCommand [3 s]
  Standard Output Messages:
 Creating WebApplicationFactory...
 Backend is ready
 Test fixture initialized
 MQTT Test Client connecting to host.docker.internal:54807 as test-device-ef6c9b0815374d198dcd28171ab6e0ec...
 MQTT Test Client connected
 Subscribed to: farm/+/coord/+/cmd
 Received message on: farm/test-farm-approve/coord/coord-approve/cmd
 Published 206 bytes to: farm/test-farm-approve/coord/coord-approve/pairing/request
 Published JSON: {"tower_id":"tower-approved","mac_address":"AA:BB:CC:DD:EE:02","fw_version":"1.0.0-test","rssi":-55,"capabilities":{"dht_sensor":true,"light_sensor":true,"pump_relay":true,"grow_light":true,"slot_count":6}}
 Received message on: farm/test-farm-approve/coord/coord-approve/cmd
 MQTT Test Client disconnected
 Disposing test fixture...


[18:46:28 INF] Starting IoT Backend on port 8000
[18:46:28 INF] Starting IoT Backend on port 8000
[18:46:28 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:46:28 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:46:28 INF] PairingBackgroundService starting
[18:46:28 INF] PairingBackgroundService starting
[18:46:28 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:46:28 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:46:28 INF] Connected to MQTT broker
[18:46:28 INF] Connected to MQTT broker
[18:46:29 INF] TelemetryHandler subscribing to MQTT topics
[18:46:29 INF] TelemetryHandler subscribing to MQTT topics
[18:46:29 INF] Subscribed to site/+/coord/+/telemetry
[18:46:29 INF] Subscribed to site/+/coord/+/telemetry
[18:46:29 INF] Subscribed to site/+/coord/+/status
[18:46:29 INF] Subscribed to site/+/coord/+/status
[18:46:29 INF] Subscribed to site/+/ota/progress
[18:46:29 INF] Subscribed to site/+/ota/progress
[18:46:29 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:46:29 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:46:29 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:46:29 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:46:29 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:46:29 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:46:29 INF] Subscribed to farm/+/coord/+/pairing/request
[18:46:29 INF] Subscribed to farm/+/coord/+/pairing/request
[18:46:29 INF] Subscribed to farm/+/coord/+/pairing/status
[18:46:29 INF] Subscribed to farm/+/coord/+/pairing/status
[18:46:29 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:46:29 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:46:29 INF] TelemetryHandler subscribed to all telemetry topics
[18:46:29 INF] TelemetryHandler subscribed to all telemetry topics
[18:46:30 INF] Started pairing session for test-farm-stop/coord-stop with duration 60s
[18:46:30 INF] Started pairing session for test-farm-stop/coord-stop with duration 60s
[18:46:30 INF] Stopped pairing session for test-farm-stop/coord-stop
[18:46:30 INF] Stopped pairing session for test-farm-stop/coord-stop
[18:46:30 INF] PairingBackgroundService stopped
[18:46:30 INF] PairingBackgroundService stopped
[18:46:30 INF] TwinSyncBackgroundService stopped
[18:46:30 INF] TwinSyncBackgroundService stopped
  Passed IoT.Backend.IntegrationTests.Tests.PairingIntegrationTests.StopPairingSession_ShouldSendStopCommand [2 s]
  Standard Output Messages:
 Creating WebApplicationFactory...
 Backend is ready
 Test fixture initialized
 MQTT Test Client connecting to host.docker.internal:54807 as test-device-c27a760cbcf2498389ebc4a96fa27f32...
 MQTT Test Client connected
 Subscribed to: farm/+/coord/+/cmd
 Received message on: farm/test-farm-stop/coord/coord-stop/cmd
 Received message on: farm/test-farm-stop/coord/coord-stop/cmd
 MQTT Test Client disconnected
 Disposing test fixture...


[18:46:30 INF] Starting IoT Backend on port 8000
[18:46:30 INF] Starting IoT Backend on port 8000
[18:46:30 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:46:30 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:46:30 INF] PairingBackgroundService starting
[18:46:30 INF] PairingBackgroundService starting
[18:46:30 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:46:30 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:46:30 INF] Connected to MQTT broker
[18:46:30 INF] Connected to MQTT broker
[18:46:31 INF] TelemetryHandler subscribing to MQTT topics
[18:46:31 INF] TelemetryHandler subscribing to MQTT topics
[18:46:31 INF] Subscribed to site/+/coord/+/telemetry
[18:46:31 INF] Subscribed to site/+/coord/+/telemetry
[18:46:31 INF] Subscribed to site/+/coord/+/status
[18:46:31 INF] Subscribed to site/+/coord/+/status
[18:46:31 INF] Subscribed to site/+/ota/progress
[18:46:31 INF] Subscribed to site/+/ota/progress
[18:46:31 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:46:31 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:46:31 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:46:31 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:46:31 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:46:31 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:46:31 INF] Subscribed to farm/+/coord/+/pairing/request
[18:46:31 INF] Subscribed to farm/+/coord/+/pairing/request
[18:46:31 INF] Subscribed to farm/+/coord/+/pairing/status
[18:46:31 INF] Subscribed to farm/+/coord/+/pairing/status
[18:46:31 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:46:31 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:46:31 INF] TelemetryHandler subscribed to all telemetry topics
[18:46:31 INF] TelemetryHandler subscribed to all telemetry topics
[18:46:32 INF] Started pairing session for test-farm-req/coord-req with duration 60s
[18:46:32 INF] Started pairing session for test-farm-req/coord-req with duration 60s
[18:46:33 INF] Received pairing request from tower tower-new-001 (MAC: AA:BB:CC:DD:EE:01) on test-farm-req/coord-req
[18:46:33 INF] Received pairing request from tower tower-new-001 (MAC: AA:BB:CC:DD:EE:01) on test-farm-req/coord-req
[18:46:33 INF] Received pairing request from tower tower-new-001 (MAC: AA:BB:CC:DD:EE:01) for test-farm-req/coord-req
[18:46:33 INF] Received pairing request from tower tower-new-001 (MAC: AA:BB:CC:DD:EE:01) for test-farm-req/coord-req
[18:46:34 INF] PairingBackgroundService stopped
[18:46:34 INF] PairingBackgroundService stopped
[18:46:34 INF] TwinSyncBackgroundService stopped
[18:46:34 INF] TwinSyncBackgroundService stopped
  Passed IoT.Backend.IntegrationTests.Tests.PairingIntegrationTests.PairingRequest_WhenSessionActive_ShouldBeRecorded [3 s]
  Standard Output Messages:
 Creating WebApplicationFactory...
 Backend is ready
 Test fixture initialized
 MQTT Test Client connecting to host.docker.internal:54807 as test-device-a92cdd26f25d49eb980afea5ec2bd64c...
 MQTT Test Client connected
 Subscribed to: farm/+/coord/+/cmd
 Received message on: farm/test-farm-req/coord/coord-req/cmd
 Published 205 bytes to: farm/test-farm-req/coord/coord-req/pairing/request
 Published JSON: {"tower_id":"tower-new-001","mac_address":"AA:BB:CC:DD:EE:01","fw_version":"1.0.0-test","rssi":-55,"capabilities":{"dht_sensor":true,"light_sensor":true,"pump_relay":true,"grow_light":true,"slot_count":6}}
 MQTT Test Client disconnected
 Disposing test fixture...


[18:46:34 INF] Starting IoT Backend on port 8000
[18:46:34 INF] Starting IoT Backend on port 8000
[18:46:34 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:46:34 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:46:34 INF] PairingBackgroundService starting
[18:46:34 INF] PairingBackgroundService starting
[18:46:34 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:46:34 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:46:34 INF] HTTP GET /health/live responded 200 in 1.9596 ms
[18:46:34 INF] HTTP GET /health/live responded 200 in 1.9596 ms
[18:46:34 INF] Connected to MQTT broker
[18:46:34 INF] Connected to MQTT broker
[18:46:34 INF] MQTT service started
[18:46:34 INF] MQTT service started
[18:46:35 INF] TelemetryHandler subscribing to MQTT topics
[18:46:35 INF] TelemetryHandler subscribing to MQTT topics
[18:46:35 INF] Subscribed to site/+/coord/+/telemetry
[18:46:35 INF] Subscribed to site/+/coord/+/telemetry
[18:46:35 INF] Subscribed to site/+/coord/+/status
[18:46:35 INF] Subscribed to site/+/coord/+/status
[18:46:35 INF] Subscribed to site/+/ota/progress
[18:46:35 INF] Subscribed to site/+/ota/progress
[18:46:35 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:46:35 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:46:35 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:46:35 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:46:35 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:46:35 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:46:35 INF] Subscribed to farm/+/coord/+/pairing/request
[18:46:35 INF] Subscribed to farm/+/coord/+/pairing/request
[18:46:35 INF] Subscribed to farm/+/coord/+/pairing/status
[18:46:35 INF] Subscribed to farm/+/coord/+/pairing/status
[18:46:35 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:46:35 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:46:35 INF] TelemetryHandler subscribed to all telemetry topics
[18:46:35 INF] TelemetryHandler subscribed to all telemetry topics
[18:46:36 INF] Started pairing session for test-farm-forget/coord-forget with duration 60s
[18:46:36 INF] Started pairing session for test-farm-forget/coord-forget with duration 60s
[18:46:36 INF] Pairing session started for test-farm-forget/coord-forget via REST API
[18:46:36 INF] Pairing session started for test-farm-forget/coord-forget via REST API
[18:46:36 INF] HTTP POST /api/pairing/start responded 200 in 7.5705 ms
[18:46:36 INF] HTTP POST /api/pairing/start responded 200 in 7.5705 ms
[18:46:36 INF] Received pairing request from tower tower-forget (MAC: AA:BB:CC:DD:EE:05) on test-farm-forget/coord-forget
[18:46:36 INF] Received pairing request from tower tower-forget (MAC: AA:BB:CC:DD:EE:05) on test-farm-forget/coord-forget
[18:46:36 INF] Received pairing request from tower tower-forget (MAC: AA:BB:CC:DD:EE:05) for test-farm-forget/coord-forget
[18:46:36 INF] Received pairing request from tower tower-forget (MAC: AA:BB:CC:DD:EE:05) for test-farm-forget/coord-forget
[18:46:37 INF] Approved pairing for tower tower-forget on test-farm-forget/coord-forget
[18:46:37 INF] Approved pairing for tower tower-forget on test-farm-forget/coord-forget
[18:46:37 INF] Approved pairing for tower tower-forget on test-farm-forget/coord-forget via REST API
[18:46:37 INF] Approved pairing for tower tower-forget on test-farm-forget/coord-forget via REST API
[18:46:37 INF] HTTP POST /api/pairing/approve responded 200 in 130.9030 ms
[18:46:37 INF] HTTP POST /api/pairing/approve responded 200 in 130.9030 ms
[18:46:38 INF] Sent forget command for tower tower-forget to coordinator test-farm-forget/coord-forget
[18:46:38 INF] Sent forget command for tower tower-forget to coordinator test-farm-forget/coord-forget
[18:46:38 INF] Deleted tower tower-forget from test-farm-forget/coord-forget
[18:46:38 INF] Deleted tower tower-forget from test-farm-forget/coord-forget
[18:46:38 INF] Device forgotten: tower tower-forget on test-farm-forget/coord-forget via REST API
[18:46:38 INF] Device forgotten: tower tower-forget on test-farm-forget/coord-forget via REST API
[18:46:38 INF] HTTP POST /api/pairing/forget responded 200 in 13.1647 ms
[18:46:38 INF] HTTP POST /api/pairing/forget responded 200 in 13.1647 ms
[18:46:38 INF] MQTT service stopped
[18:46:38 INF] MQTT service stopped
[18:46:38 INF] PairingBackgroundService stopped
[18:46:38 INF] PairingBackgroundService stopped
[18:46:38 INF] TwinSyncBackgroundService stopped
[18:46:38 INF] TwinSyncBackgroundService stopped
  Passed IoT.Backend.IntegrationTests.Tests.PairingIntegrationTests.ForgetDevice_ShouldDeleteTowerAndSendCommand [4 s]
  Standard Output Messages:
 Creating WebApplicationFactory...
 Backend is ready
 Test fixture initialized
 MQTT Test Client connecting to host.docker.internal:54807 as test-device-88c55186ab1044548bfe6e7f790010ba...
 MQTT Test Client connected
 Subscribed to: farm/+/coord/+/cmd
 Received message on: farm/test-farm-forget/coord/coord-forget/cmd
 Published 204 bytes to: farm/test-farm-forget/coord/coord-forget/pairing/request
 Published JSON: {"tower_id":"tower-forget","mac_address":"AA:BB:CC:DD:EE:05","fw_version":"1.0.0-test","rssi":-55,"capabilities":{"dht_sensor":true,"light_sensor":true,"pump_relay":true,"grow_light":true,"slot_count":6}}
 Received message on: farm/test-farm-forget/coord/coord-forget/cmd
 Received message on: farm/test-farm-forget/coord/coord-forget/cmd
 MQTT Test Client disconnected
 Disposing test fixture...


[18:46:38 INF] Starting IoT Backend on port 8000
[18:46:38 INF] Starting IoT Backend on port 8000
[18:46:38 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:46:38 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:46:38 INF] PairingBackgroundService starting
[18:46:38 INF] PairingBackgroundService starting
[18:46:38 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:46:38 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:46:38 INF] Connected to MQTT broker
[18:46:38 INF] Connected to MQTT broker
[18:46:39 INF] TelemetryHandler subscribing to MQTT topics
[18:46:39 INF] TelemetryHandler subscribing to MQTT topics
[18:46:39 INF] Subscribed to site/+/coord/+/telemetry
[18:46:39 INF] Subscribed to site/+/coord/+/telemetry
[18:46:39 INF] Subscribed to site/+/coord/+/status
[18:46:39 INF] Subscribed to site/+/coord/+/status
[18:46:39 INF] Subscribed to site/+/ota/progress
[18:46:39 INF] Subscribed to site/+/ota/progress
[18:46:39 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:46:39 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:46:39 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:46:39 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:46:39 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:46:39 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:46:39 INF] Subscribed to farm/+/coord/+/pairing/request
[18:46:39 INF] Subscribed to farm/+/coord/+/pairing/request
[18:46:39 INF] Subscribed to farm/+/coord/+/pairing/status
[18:46:39 INF] Subscribed to farm/+/coord/+/pairing/status
[18:46:39 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:46:39 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:46:39 INF] TelemetryHandler subscribed to all telemetry topics
[18:46:39 INF] TelemetryHandler subscribed to all telemetry topics
[18:46:38 INF] Started pairing session for test-farm-reject/coord-reject with duration 60s
[18:46:38 INF] Started pairing session for test-farm-reject/coord-reject with duration 60s
[18:46:38 INF] Received pairing request from tower tower-rejected (MAC: AA:BB:CC:DD:EE:03) on test-farm-reject/coord-reject
[18:46:38 INF] Received pairing request from tower tower-rejected (MAC: AA:BB:CC:DD:EE:03) on test-farm-reject/coord-reject
[18:46:38 INF] Received pairing request from tower tower-rejected (MAC: AA:BB:CC:DD:EE:03) for test-farm-reject/coord-reject
[18:46:38 INF] Received pairing request from tower tower-rejected (MAC: AA:BB:CC:DD:EE:03) for test-farm-reject/coord-reject
[18:46:39 INF] Rejected pairing for tower tower-rejected on test-farm-reject/coord-reject
[18:46:39 INF] Rejected pairing for tower tower-rejected on test-farm-reject/coord-reject
[18:46:39 INF] PairingBackgroundService stopped
[18:46:39 INF] PairingBackgroundService stopped
[18:46:39 INF] TwinSyncBackgroundService stopped
[18:46:39 INF] TwinSyncBackgroundService stopped
[18:46:39 INF] Starting IoT Backend on port 8000
[18:46:39 INF] Starting IoT Backend on port 8000
[18:46:39 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:46:39 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:46:39 INF] PairingBackgroundService starting
[18:46:39 INF] PairingBackgroundService starting
[18:46:39 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:46:39 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:46:39 INF] HTTP GET /health/live responded 200 in 2.0176 ms
[18:46:39 INF] HTTP GET /health/live responded 200 in 2.0176 ms
[18:46:39 INF] Connected to MQTT broker
[18:46:39 INF] Connected to MQTT broker
[18:46:39 INF] MQTT service started
[18:46:39 INF] MQTT service started
  Passed IoT.Backend.IntegrationTests.Tests.PairingIntegrationTests.RejectPairingRequest_ShouldSendRejectCommand [3 s]
  Standard Output Messages:
 Creating WebApplicationFactory...
 Backend is ready
 Test fixture initialized
 MQTT Test Client connecting to host.docker.internal:54807 as test-device-f7138da63fc0435d9913e28b573b106c...
 MQTT Test Client connected
 Subscribed to: farm/+/coord/+/cmd
 Received message on: farm/test-farm-reject/coord/coord-reject/cmd
 Published 206 bytes to: farm/test-farm-reject/coord/coord-reject/pairing/request
 Published JSON: {"tower_id":"tower-rejected","mac_address":"AA:BB:CC:DD:EE:03","fw_version":"1.0.0-test","rssi":-55,"capabilities":{"dht_sensor":true,"light_sensor":true,"pump_relay":true,"grow_light":true,"slot_count":6}}
 Received message on: farm/test-farm-reject/coord/coord-reject/cmd
 MQTT Test Client disconnected
 Disposing test fixture...


[18:46:40 INF] TelemetryHandler subscribing to MQTT topics
[18:46:40 INF] TelemetryHandler subscribing to MQTT topics
[18:46:40 INF] Subscribed to site/+/coord/+/telemetry
[18:46:40 INF] Subscribed to site/+/coord/+/telemetry
[18:46:40 INF] Subscribed to site/+/coord/+/status
[18:46:40 INF] Subscribed to site/+/coord/+/status
[18:46:40 INF] Subscribed to site/+/ota/progress
[18:46:40 INF] Subscribed to site/+/ota/progress
[18:46:40 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:46:40 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:46:40 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:46:40 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:46:40 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:46:40 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:46:40 INF] Subscribed to farm/+/coord/+/pairing/request
[18:46:40 INF] Subscribed to farm/+/coord/+/pairing/request
[18:46:40 INF] Subscribed to farm/+/coord/+/pairing/status
[18:46:40 INF] Subscribed to farm/+/coord/+/pairing/status
[18:46:40 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:46:40 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:46:40 INF] TelemetryHandler subscribed to all telemetry topics
[18:46:40 INF] TelemetryHandler subscribed to all telemetry topics
[18:46:41 INF] Started pairing session for test-farm-dup/coord-dup with duration 60s
[18:46:41 INF] Started pairing session for test-farm-dup/coord-dup with duration 60s
[18:46:41 INF] Pairing session started for test-farm-dup/coord-dup via REST API
[18:46:41 INF] Pairing session started for test-farm-dup/coord-dup via REST API
[18:46:41 INF] HTTP POST /api/pairing/start responded 200 in 6.6021 ms
[18:46:41 INF] HTTP POST /api/pairing/start responded 200 in 6.6021 ms
[18:46:42 INF] Received pairing request from tower tower-dup (MAC: AA:BB:CC:DD:EE:06) on test-farm-dup/coord-dup
[18:46:42 INF] Received pairing request from tower tower-dup (MAC: AA:BB:CC:DD:EE:06) on test-farm-dup/coord-dup
[18:46:42 INF] Received pairing request from tower tower-dup (MAC: AA:BB:CC:DD:EE:06) for test-farm-dup/coord-dup
[18:46:42 INF] Received pairing request from tower tower-dup (MAC: AA:BB:CC:DD:EE:06) for test-farm-dup/coord-dup
[18:46:42 INF] Received pairing request from tower tower-dup (MAC: AA:BB:CC:DD:EE:06) on test-farm-dup/coord-dup
[18:46:42 INF] Received pairing request from tower tower-dup (MAC: AA:BB:CC:DD:EE:06) on test-farm-dup/coord-dup
[18:46:43 INF] HTTP GET /api/pairing/requests/test-farm-dup/coord-dup responded 200 in 3.7459 ms
[18:46:43 INF] HTTP GET /api/pairing/requests/test-farm-dup/coord-dup responded 200 in 3.7459 ms
[18:46:43 INF] MQTT service stopped
[18:46:43 INF] MQTT service stopped
[18:46:43 INF] PairingBackgroundService stopped
[18:46:43 INF] PairingBackgroundService stopped
[18:46:43 INF] TwinSyncBackgroundService stopped
[18:46:43 INF] TwinSyncBackgroundService stopped
  Passed IoT.Backend.IntegrationTests.Tests.PairingIntegrationTests.DuplicatePairingRequest_ShouldUpdateExisting [4 s]
  Standard Output Messages:
 Creating WebApplicationFactory...
 Backend is ready
 Test fixture initialized
 MQTT Test Client connecting to host.docker.internal:54807 as test-device-2f7c0996f9734db2b3da7b01b697f5cd...
 MQTT Test Client connected
 Subscribed to: farm/+/coord/+/cmd
 Received message on: farm/test-farm-dup/coord/coord-dup/cmd
 Published 201 bytes to: farm/test-farm-dup/coord/coord-dup/pairing/request
 Published JSON: {"tower_id":"tower-dup","mac_address":"AA:BB:CC:DD:EE:06","fw_version":"1.0.0-test","rssi":-60,"capabilities":{"dht_sensor":true,"light_sensor":true,"pump_relay":true,"grow_light":true,"slot_count":6}}
 Published 201 bytes to: farm/test-farm-dup/coord/coord-dup/pairing/request
 Published JSON: {"tower_id":"tower-dup","mac_address":"AA:BB:CC:DD:EE:06","fw_version":"1.0.0-test","rssi":-55,"capabilities":{"dht_sensor":true,"light_sensor":true,"pump_relay":true,"grow_light":true,"slot_count":6}}
 MQTT Test Client disconnected
 Disposing test fixture...


[18:46:43 INF] Starting IoT Backend on port 8000
[18:46:43 INF] Starting IoT Backend on port 8000
[18:46:43 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:46:43 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:46:43 INF] PairingBackgroundService starting
[18:46:43 INF] PairingBackgroundService starting
[18:46:43 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:46:43 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:46:43 INF] Connected to MQTT broker
[18:46:43 INF] Connected to MQTT broker
[18:46:44 INF] TelemetryHandler subscribing to MQTT topics
[18:46:44 INF] TelemetryHandler subscribing to MQTT topics
[18:46:44 INF] Subscribed to site/+/coord/+/telemetry
[18:46:44 INF] Subscribed to site/+/coord/+/telemetry
[18:46:44 INF] Subscribed to site/+/coord/+/status
[18:46:44 INF] Subscribed to site/+/coord/+/status
[18:46:44 INF] Subscribed to site/+/ota/progress
[18:46:44 INF] Subscribed to site/+/ota/progress
[18:46:44 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:46:44 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:46:44 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:46:44 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:46:44 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:46:44 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:46:44 INF] Subscribed to farm/+/coord/+/pairing/request
[18:46:44 INF] Subscribed to farm/+/coord/+/pairing/request
[18:46:44 INF] Subscribed to farm/+/coord/+/pairing/status
[18:46:44 INF] Subscribed to farm/+/coord/+/pairing/status
[18:46:44 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:46:44 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:46:44 INF] TelemetryHandler subscribed to all telemetry topics
[18:46:44 INF] TelemetryHandler subscribed to all telemetry topics
[18:46:45 INF] Started pairing session for test-farm-complete/coord-complete with duration 60s
[18:46:45 INF] Started pairing session for test-farm-complete/coord-complete with duration 60s
[18:46:46 INF] Received pairing request from tower tower-completed (MAC: AA:BB:CC:DD:EE:04) on test-farm-complete/coord-complete
[18:46:46 INF] Received pairing request from tower tower-completed (MAC: AA:BB:CC:DD:EE:04) on test-farm-complete/coord-complete
[18:46:46 INF] Received pairing request from tower tower-completed (MAC: AA:BB:CC:DD:EE:04) for test-farm-complete/coord-complete
[18:46:46 INF] Received pairing request from tower tower-completed (MAC: AA:BB:CC:DD:EE:04) for test-farm-complete/coord-complete
[18:46:47 INF] Approved pairing for tower tower-completed on test-farm-complete/coord-complete
[18:46:47 INF] Approved pairing for tower tower-completed on test-farm-complete/coord-complete
[18:46:47 INF] Received pairing complete for tower tower-completed on test-farm-complete/coord-complete: success=True
[18:46:47 INF] Received pairing complete for tower tower-completed on test-farm-complete/coord-complete: success=True
[18:46:47 INF] Pairing complete for tower tower-completed on test-farm-complete/coord-complete: success=True
[18:46:47 INF] Pairing complete for tower tower-completed on test-farm-complete/coord-complete: success=True
[18:46:48 INF] PairingBackgroundService stopped
[18:46:48 INF] PairingBackgroundService stopped
[18:46:48 INF] TwinSyncBackgroundService stopped
[18:46:48 INF] TwinSyncBackgroundService stopped
  Passed IoT.Backend.IntegrationTests.Tests.PairingIntegrationTests.PairingComplete_WhenSuccessful_ShouldUpdateTowerStatus [5 s]
  Standard Output Messages:
 Creating WebApplicationFactory...
 Backend is ready
 Test fixture initialized
 MQTT Test Client connecting to host.docker.internal:54807 as test-device-7653bef185bb4db0a894cc6a7fbd2555...
 MQTT Test Client connected
 Subscribed to: farm/+/coord/+/cmd
 Received message on: farm/test-farm-complete/coord/coord-complete/cmd
 Published 207 bytes to: farm/test-farm-complete/coord/coord-complete/pairing/request
 Published JSON: {"tower_id":"tower-completed","mac_address":"AA:BB:CC:DD:EE:04","fw_version":"1.0.0-test","rssi":-55,"capabilities":{"dht_sensor":true,"light_sensor":true,"pump_relay":true,"grow_light":true,"slot_count":6}}
 Received message on: farm/test-farm-complete/coord/coord-complete/cmd
 Published 190 bytes to: farm/test-farm-complete/coord/coord-complete/pairing/complete
 Published JSON: {"tower_id":"tower-completed","success":true,"error":null,"capabilities":{"dht_sensor":true,"light_sensor":true,"pump_relay":true,"grow_light":true,"slot_count":6},"fw_version":"1.0.0-test"}
 MQTT Test Client disconnected
 Disposing test fixture...


[18:46:48 INF] Starting IoT Backend on port 8000
[18:46:48 INF] Starting IoT Backend on port 8000
[18:46:48 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:46:48 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:46:48 INF] PairingBackgroundService starting
[18:46:48 INF] PairingBackgroundService starting
[18:46:48 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:46:48 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:46:48 INF] Connected to MQTT broker
[18:46:48 INF] Connected to MQTT broker
[18:46:49 INF] PairingBackgroundService stopped
[18:46:49 INF] PairingBackgroundService stopped
[18:46:49 INF] TwinSyncBackgroundService stopped
[18:46:49 INF] TwinSyncBackgroundService stopped
[18:46:49 INF] Starting IoT Backend on port 8000
[18:46:49 INF] Starting IoT Backend on port 8000
[18:46:49 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:46:49 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:46:49 INF] PairingBackgroundService starting
[18:46:49 INF] PairingBackgroundService starting
[18:46:49 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:46:49 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:46:49 INF] HTTP GET /health/live responded 200 in 1.8347 ms
[18:46:49 INF] HTTP GET /health/live responded 200 in 1.8347 ms
[18:46:49 INF] Connected to MQTT broker
[18:46:49 INF] Connected to MQTT broker
[18:46:49 INF] MQTT service started
[18:46:49 INF] MQTT service started
[18:46:49 INF] Saved settings for site test-site-save
[18:46:49 INF] Saved settings for site test-site-save
[18:46:49 INF] HTTP PUT /api/settings responded 200 in 238.8872 ms
[18:46:49 INF] HTTP PUT /api/settings responded 200 in 238.8872 ms
[18:46:49 INF] MQTT service stopped
[18:46:49 INF] MQTT service stopped
[18:46:49 INF] PairingBackgroundService stopped
[18:46:49 INF] PairingBackgroundService stopped
[18:46:49 INF] TwinSyncBackgroundService stopped
[18:46:49 INF] TwinSyncBackgroundService stopped
[18:46:49 INF] Starting IoT Backend on port 8000
[18:46:49 INF] Starting IoT Backend on port 8000
[18:46:49 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:46:49 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:46:49 INF] PairingBackgroundService starting
[18:46:49 INF] PairingBackgroundService starting
[18:46:49 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:46:49 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:46:49 INF] Connected to MQTT broker
[18:46:49 INF] Connected to MQTT broker
[18:46:49 INF] PairingBackgroundService stopped
[18:46:49 INF] PairingBackgroundService stopped
[18:46:49 INF] TwinSyncBackgroundService stopped
[18:46:49 INF] TwinSyncBackgroundService stopped
[18:46:49 INF] Starting IoT Backend on port 8000
[18:46:49 INF] Starting IoT Backend on port 8000
[18:46:49 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:46:49 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:46:49 INF] PairingBackgroundService starting
[18:46:49 INF] PairingBackgroundService starting
[18:46:49 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:46:49 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:46:49 INF] Connected to MQTT broker
[18:46:49 INF] Connected to MQTT broker
[18:46:49 INF] PairingBackgroundService stopped
[18:46:49 INF] PairingBackgroundService stopped
[18:46:49 INF] TwinSyncBackgroundService stopped
[18:46:49 INF] TwinSyncBackgroundService stopped
[18:46:49 INF] Starting IoT Backend on port 8000
[18:46:49 INF] Starting IoT Backend on port 8000
[18:46:49 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:46:49 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:46:49 INF] PairingBackgroundService starting
[18:46:49 INF] PairingBackgroundService starting
[18:46:49 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:46:49 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:46:50 INF] Connected to MQTT broker
[18:46:50 INF] Connected to MQTT broker
  Passed IoT.Backend.IntegrationTests.Tests.SettingsIntegrationTests.PatchSettings_ShouldUpdateOnlySpecifiedFields [152 ms]
  Standard Output Messages:
 Creating WebApplicationFactory...
 Backend is ready
 Test fixture initialized
 Disposing test fixture...


  Passed IoT.Backend.IntegrationTests.Tests.SettingsIntegrationTests.SaveSettings_ShouldPersistToDatabase [247 ms]
  Standard Output Messages:
 Creating WebApplicationFactory...
 Backend is ready
 Test fixture initialized
 Disposing test fixture...


  Passed IoT.Backend.IntegrationTests.Tests.SettingsIntegrationTests.GetSettings_ShouldIncludeMqttBrokerConfig [10 ms]
  Standard Output Messages:
 Creating WebApplicationFactory...
 Backend is ready
 Test fixture initialized
 Disposing test fixture...


  Passed IoT.Backend.IntegrationTests.Tests.SettingsIntegrationTests.SaveSettings_WithoutSiteId_ShouldUseDefault [487 ms]
  Standard Output Messages:
 Creating WebApplicationFactory...
 Backend is ready
 Test fixture initialized
 Disposing test fixture...


[18:46:50 INF] TelemetryHandler subscribing to MQTT topics
[18:46:50 INF] TelemetryHandler subscribing to MQTT topics
[18:46:50 INF] Subscribed to site/+/coord/+/telemetry
[18:46:50 INF] Subscribed to site/+/coord/+/telemetry
[18:46:50 INF] Subscribed to site/+/coord/+/status
[18:46:50 INF] Subscribed to site/+/coord/+/status
[18:46:50 INF] Subscribed to site/+/ota/progress
[18:46:50 INF] Subscribed to site/+/ota/progress
[18:46:50 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:46:50 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:46:50 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:46:50 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:46:50 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:46:50 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:46:50 INF] Subscribed to farm/+/coord/+/pairing/request
[18:46:50 INF] Subscribed to farm/+/coord/+/pairing/request
[18:46:50 INF] Subscribed to farm/+/coord/+/pairing/status
[18:46:50 INF] Subscribed to farm/+/coord/+/pairing/status
[18:46:50 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:46:50 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:46:50 INF] TelemetryHandler subscribed to all telemetry topics
[18:46:50 INF] TelemetryHandler subscribed to all telemetry topics
[18:46:51 INF] PairingBackgroundService stopped
[18:46:51 INF] PairingBackgroundService stopped
[18:46:51 INF] TwinSyncBackgroundService stopped
[18:46:51 INF] TwinSyncBackgroundService stopped
[18:46:51 INF] Starting IoT Backend on port 8000
[18:46:51 INF] Starting IoT Backend on port 8000
[18:46:51 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:46:51 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:46:51 INF] PairingBackgroundService starting
[18:46:51 INF] PairingBackgroundService starting
[18:46:51 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:46:51 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:46:51 INF] HTTP GET /health/live responded 200 in 2.2713 ms
[18:46:51 INF] HTTP GET /health/live responded 200 in 2.2713 ms
[18:46:51 INF] Connected to MQTT broker
[18:46:51 INF] Connected to MQTT broker
[18:46:51 INF] MQTT service started
[18:46:51 INF] MQTT service started
  Passed IoT.Backend.IntegrationTests.Tests.SettingsIntegrationTests.PatchSettings_WhenNotExists_ShouldCreateWithPatchedValues [1 s]
  Standard Output Messages:
 Creating WebApplicationFactory...
 Backend is ready
 Test fixture initialized
 Disposing test fixture...


[18:46:52 INF] TelemetryHandler subscribing to MQTT topics
[18:46:52 INF] TelemetryHandler subscribing to MQTT topics
[18:46:52 INF] Subscribed to site/+/coord/+/telemetry
[18:46:52 INF] Subscribed to site/+/coord/+/telemetry
[18:46:52 INF] Subscribed to site/+/coord/+/status
[18:46:52 INF] Subscribed to site/+/coord/+/status
[18:46:52 INF] Subscribed to site/+/ota/progress
[18:46:52 INF] Subscribed to site/+/ota/progress
[18:46:52 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:46:52 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:46:52 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:46:52 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:46:52 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:46:52 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:46:52 INF] Subscribed to farm/+/coord/+/pairing/request
[18:46:52 INF] Subscribed to farm/+/coord/+/pairing/request
[18:46:52 INF] Subscribed to farm/+/coord/+/pairing/status
[18:46:52 INF] Subscribed to farm/+/coord/+/pairing/status
[18:46:52 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:46:52 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:46:52 INF] TelemetryHandler subscribed to all telemetry topics
[18:46:52 INF] TelemetryHandler subscribed to all telemetry topics
[18:46:53 INF] Patched settings for site test-site-patch-multi
[18:46:53 INF] Patched settings for site test-site-patch-multi
[18:46:53 INF] HTTP PATCH /api/settings responded 200 in 11.2974 ms
[18:46:53 INF] HTTP PATCH /api/settings responded 200 in 11.2974 ms
[18:46:53 INF] MQTT service stopped
[18:46:53 INF] MQTT service stopped
[18:46:53 INF] PairingBackgroundService stopped
[18:46:53 INF] PairingBackgroundService stopped
[18:46:53 INF] TwinSyncBackgroundService stopped
[18:46:53 INF] TwinSyncBackgroundService stopped
  Passed IoT.Backend.IntegrationTests.Tests.SettingsIntegrationTests.PatchSettings_WithMultipleFields_ShouldUpdateAll [524 ms]
  Standard Output Messages:
 Creating WebApplicationFactory...
 Backend is ready
 Test fixture initialized
 Disposing test fixture...


[18:46:53 INF] Starting IoT Backend on port 8000
[18:46:53 INF] Starting IoT Backend on port 8000
[18:46:53 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:46:53 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:46:53 INF] PairingBackgroundService starting
[18:46:53 INF] PairingBackgroundService starting
[18:46:53 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:46:53 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:46:53 INF] Connected to MQTT broker
[18:46:53 INF] Connected to MQTT broker
[18:46:54 INF] PairingBackgroundService stopped
[18:46:54 INF] PairingBackgroundService stopped
[18:46:54 INF] TwinSyncBackgroundService stopped
[18:46:54 INF] TwinSyncBackgroundService stopped
[18:46:54 INF] Starting IoT Backend on port 8000
[18:46:54 INF] Starting IoT Backend on port 8000
[18:46:54 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:46:54 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:46:54 INF] PairingBackgroundService starting
[18:46:54 INF] PairingBackgroundService starting
[18:46:54 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:46:54 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:46:54 INF] Connected to MQTT broker
[18:46:54 INF] Connected to MQTT broker
[18:46:54 INF] PairingBackgroundService stopped
[18:46:54 INF] PairingBackgroundService stopped
[18:46:54 INF] TwinSyncBackgroundService stopped
[18:46:54 INF] TwinSyncBackgroundService stopped
[18:46:54 INF] Starting IoT Backend on port 8000
[18:46:54 INF] Starting IoT Backend on port 8000
[18:46:54 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:46:54 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:46:54 INF] PairingBackgroundService starting
[18:46:54 INF] PairingBackgroundService starting
[18:46:54 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:46:54 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:46:54 INF] Connected to MQTT broker
[18:46:54 INF] Connected to MQTT broker
  Passed IoT.Backend.IntegrationTests.Tests.SettingsIntegrationTests.PatchSettings_WithoutSiteId_ShouldUseDefault [669 ms]
  Standard Output Messages:
 Creating WebApplicationFactory...
 Backend is ready
 Test fixture initialized
 Disposing test fixture...


  Passed IoT.Backend.IntegrationTests.Tests.SettingsIntegrationTests.SaveSettings_ShouldNotStoreSensitiveCredentials [697 ms]
  Standard Output Messages:
 Creating WebApplicationFactory...
 Backend is ready
 Test fixture initialized
 Disposing test fixture...


[18:46:55 INF] TelemetryHandler subscribing to MQTT topics
[18:46:55 INF] TelemetryHandler subscribing to MQTT topics
[18:46:55 INF] Subscribed to site/+/coord/+/telemetry
[18:46:55 INF] Subscribed to site/+/coord/+/telemetry
[18:46:55 INF] Subscribed to site/+/coord/+/status
[18:46:55 INF] Subscribed to site/+/coord/+/status
[18:46:55 INF] Subscribed to site/+/ota/progress
[18:46:55 INF] Subscribed to site/+/ota/progress
[18:46:55 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:46:55 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:46:55 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:46:55 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:46:55 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:46:55 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:46:55 INF] Subscribed to farm/+/coord/+/pairing/request
[18:46:55 INF] Subscribed to farm/+/coord/+/pairing/request
[18:46:55 INF] Subscribed to farm/+/coord/+/pairing/status
[18:46:55 INF] Subscribed to farm/+/coord/+/pairing/status
[18:46:55 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:46:55 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:46:55 INF] TelemetryHandler subscribed to all telemetry topics
[18:46:55 INF] TelemetryHandler subscribed to all telemetry topics
[18:46:56 INF] PairingBackgroundService stopped
[18:46:56 INF] PairingBackgroundService stopped
[18:46:56 INF] TwinSyncBackgroundService stopped
[18:46:56 INF] TwinSyncBackgroundService stopped
[18:46:56 INF] Starting IoT Backend on port 8000
[18:46:56 INF] Starting IoT Backend on port 8000
[18:46:56 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:46:56 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:46:56 INF] PairingBackgroundService starting
[18:46:56 INF] PairingBackgroundService starting
[18:46:56 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:46:56 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:46:56 INF] Connected to MQTT broker
[18:46:56 INF] Connected to MQTT broker
  Passed IoT.Backend.IntegrationTests.Tests.SettingsIntegrationTests.GetSettings_WithoutSiteId_ShouldUseDefaultSiteId [10 ms]
  Standard Output Messages:
 Creating WebApplicationFactory...
 Backend is ready
 Test fixture initialized
 Disposing test fixture...


[18:46:56 INF] PairingBackgroundService stopped
[18:46:56 INF] PairingBackgroundService stopped
[18:46:56 INF] TwinSyncBackgroundService stopped
[18:46:56 INF] TwinSyncBackgroundService stopped
[18:46:57 INF] Starting IoT Backend on port 8000
[18:46:57 INF] Starting IoT Backend on port 8000
[18:46:57 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:46:57 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:46:57 INF] PairingBackgroundService starting
[18:46:57 INF] PairingBackgroundService starting
[18:46:57 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:46:57 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:46:57 INF] Connected to MQTT broker
[18:46:57 INF] Connected to MQTT broker
  Passed IoT.Backend.IntegrationTests.Tests.SettingsIntegrationTests.SaveSettings_WithEmptyZones_ShouldPersistEmptyList [726 ms]
  Standard Output Messages:
 Creating WebApplicationFactory...
 Backend is ready
 Test fixture initialized
 Disposing test fixture...


[18:46:58 INF] PairingBackgroundService stopped
[18:46:58 INF] PairingBackgroundService stopped
[18:46:58 INF] TwinSyncBackgroundService stopped
[18:46:58 INF] TwinSyncBackgroundService stopped
[18:46:58 INF] Starting IoT Backend on port 8000
[18:46:58 INF] Starting IoT Backend on port 8000
[18:46:58 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:46:58 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:46:58 INF] PairingBackgroundService starting
[18:46:58 INF] PairingBackgroundService starting
[18:46:58 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:46:58 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:46:58 INF] Connected to MQTT broker
[18:46:58 INF] Connected to MQTT broker
[18:46:59 INF] PairingBackgroundService stopped
[18:46:59 INF] PairingBackgroundService stopped
[18:46:59 INF] TwinSyncBackgroundService stopped
[18:46:59 INF] TwinSyncBackgroundService stopped
[18:46:59 INF] Starting IoT Backend on port 8000
[18:46:59 INF] Starting IoT Backend on port 8000
[18:46:59 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:46:59 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:46:59 INF] PairingBackgroundService starting
[18:46:59 INF] PairingBackgroundService starting
[18:46:59 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:46:59 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:46:59 INF] Connected to MQTT broker
[18:46:59 INF] Connected to MQTT broker
  Passed IoT.Backend.IntegrationTests.Tests.SettingsIntegrationTests.SaveSettings_ShouldUpdateExisting [954 ms]
  Standard Output Messages:
 Creating WebApplicationFactory...
 Backend is ready
 Test fixture initialized
 Disposing test fixture...


  Passed IoT.Backend.IntegrationTests.Tests.SettingsIntegrationTests.PatchSettings_ShouldUpdateZones [970 ms]
  Standard Output Messages:
 Creating WebApplicationFactory...
 Backend is ready
 Test fixture initialized
 Disposing test fixture...


[18:47:00 INF] TelemetryHandler subscribing to MQTT topics
[18:47:00 INF] TelemetryHandler subscribing to MQTT topics
[18:47:00 INF] Subscribed to site/+/coord/+/telemetry
[18:47:00 INF] Subscribed to site/+/coord/+/telemetry
[18:47:00 INF] Subscribed to site/+/coord/+/status
[18:47:00 INF] Subscribed to site/+/coord/+/status
[18:47:00 INF] Subscribed to site/+/ota/progress
[18:47:00 INF] Subscribed to site/+/ota/progress
[18:47:00 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:47:00 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:47:00 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:47:00 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:47:00 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:47:00 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:47:00 INF] Subscribed to farm/+/coord/+/pairing/request
[18:47:00 INF] Subscribed to farm/+/coord/+/pairing/request
[18:47:00 INF] Subscribed to farm/+/coord/+/pairing/status
[18:47:00 INF] Subscribed to farm/+/coord/+/pairing/status
[18:47:00 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:47:00 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:47:00 INF] TelemetryHandler subscribed to all telemetry topics
[18:47:00 INF] TelemetryHandler subscribed to all telemetry topics
[18:47:00 INF] PairingBackgroundService stopped
[18:47:00 INF] PairingBackgroundService stopped
[18:47:00 INF] TwinSyncBackgroundService stopped
[18:47:00 INF] TwinSyncBackgroundService stopped
[18:47:00 INF] Starting IoT Backend on port 8000
[18:47:00 INF] Starting IoT Backend on port 8000
[18:47:00 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:47:00 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:47:00 INF] PairingBackgroundService starting
[18:47:00 INF] PairingBackgroundService starting
[18:47:00 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:47:00 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:47:00 INF] Connected to MQTT broker
[18:47:00 INF] Connected to MQTT broker
  Passed IoT.Backend.IntegrationTests.Tests.SettingsIntegrationTests.GetSettings_WhenNotExists_ShouldReturnDefaults [9 ms]
  Standard Output Messages:
 Creating WebApplicationFactory...
 Backend is ready
 Test fixture initialized
 Disposing test fixture...


[18:47:01 INF] TelemetryHandler subscribing to MQTT topics
[18:47:01 INF] TelemetryHandler subscribing to MQTT topics
[18:47:01 INF] Subscribed to site/+/coord/+/telemetry
[18:47:01 INF] Subscribed to site/+/coord/+/telemetry
[18:47:01 INF] Subscribed to site/+/coord/+/status
[18:47:01 INF] Subscribed to site/+/coord/+/status
[18:47:01 INF] Subscribed to site/+/ota/progress
[18:47:01 INF] Subscribed to site/+/ota/progress
[18:47:01 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:47:01 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:47:01 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:47:01 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:47:01 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:47:01 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:47:01 INF] Subscribed to farm/+/coord/+/pairing/request
[18:47:01 INF] Subscribed to farm/+/coord/+/pairing/request
[18:47:01 INF] Subscribed to farm/+/coord/+/pairing/status
[18:47:01 INF] Subscribed to farm/+/coord/+/pairing/status
[18:47:01 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:47:01 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:47:01 INF] TelemetryHandler subscribed to all telemetry topics
[18:47:01 INF] TelemetryHandler subscribed to all telemetry topics
[18:47:01 INF] PairingBackgroundService stopped
[18:47:01 INF] PairingBackgroundService stopped
[18:47:01 INF] TwinSyncBackgroundService stopped
[18:47:01 INF] TwinSyncBackgroundService stopped
[18:47:01 INF] Starting IoT Backend on port 8000
[18:47:01 INF] Starting IoT Backend on port 8000
[18:47:01 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:47:01 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:47:01 INF] PairingBackgroundService starting
[18:47:01 INF] PairingBackgroundService starting
[18:47:01 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:47:01 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:47:01 INF] Connected to MQTT broker
[18:47:01 INF] Connected to MQTT broker
  Passed IoT.Backend.IntegrationTests.Tests.SettingsIntegrationTests.GetSettings_MultipleSites_ShouldReturnCorrectSettings [1 s]
  Standard Output Messages:
 Creating WebApplicationFactory...
 Backend is ready
 Test fixture initialized
 Disposing test fixture...


[18:47:02 INF] TelemetryHandler subscribing to MQTT topics
[18:47:02 INF] TelemetryHandler subscribing to MQTT topics
[18:47:02 INF] Subscribed to site/+/coord/+/telemetry
[18:47:02 INF] Subscribed to site/+/coord/+/telemetry
[18:47:02 INF] Subscribed to site/+/coord/+/status
[18:47:02 INF] Subscribed to site/+/coord/+/status
[18:47:02 INF] Subscribed to site/+/ota/progress
[18:47:02 INF] Subscribed to site/+/ota/progress
[18:47:02 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:47:02 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:47:02 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:47:02 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:47:02 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:47:02 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:47:02 INF] Subscribed to farm/+/coord/+/pairing/request
[18:47:02 INF] Subscribed to farm/+/coord/+/pairing/request
[18:47:02 INF] Subscribed to farm/+/coord/+/pairing/status
[18:47:02 INF] Subscribed to farm/+/coord/+/pairing/status
[18:47:02 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:47:02 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:47:02 INF] TelemetryHandler subscribed to all telemetry topics
[18:47:02 INF] TelemetryHandler subscribed to all telemetry topics
[18:47:02 INF] PairingBackgroundService stopped
[18:47:02 INF] PairingBackgroundService stopped
[18:47:02 INF] TwinSyncBackgroundService stopped
[18:47:02 INF] TwinSyncBackgroundService stopped
[18:47:02 INF] Starting IoT Backend on port 8000
[18:47:02 INF] Starting IoT Backend on port 8000
[18:47:02 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:47:02 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:47:02 INF] PairingBackgroundService starting
[18:47:02 INF] PairingBackgroundService starting
[18:47:02 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:47:02 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:47:02 INF] Connected to MQTT broker
[18:47:02 INF] Connected to MQTT broker
[18:47:03 INF] TelemetryHandler subscribing to MQTT topics
[18:47:03 INF] TelemetryHandler subscribing to MQTT topics
[18:47:03 INF] Subscribed to site/+/coord/+/telemetry
[18:47:03 INF] Subscribed to site/+/coord/+/telemetry
[18:47:03 INF] Subscribed to site/+/coord/+/status
[18:47:03 INF] Subscribed to site/+/coord/+/status
[18:47:03 INF] Subscribed to site/+/ota/progress
[18:47:03 INF] Subscribed to site/+/ota/progress
[18:47:03 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:47:03 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:47:03 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:47:03 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:47:03 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:47:03 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:47:03 INF] Subscribed to farm/+/coord/+/pairing/request
[18:47:03 INF] Subscribed to farm/+/coord/+/pairing/request
[18:47:03 INF] Subscribed to farm/+/coord/+/pairing/status
[18:47:03 INF] Subscribed to farm/+/coord/+/pairing/status
[18:47:03 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:47:03 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:47:03 INF] TelemetryHandler subscribed to all telemetry topics
[18:47:03 INF] TelemetryHandler subscribed to all telemetry topics
  Passed IoT.Backend.IntegrationTests.Tests.SettingsIntegrationTests.GetSettings_WhenExists_ShouldReturnSettings [1 s]
  Standard Output Messages:
 Creating WebApplicationFactory...
 Backend is ready
 Test fixture initialized
 Disposing test fixture...


[18:47:05 INF] PairingBackgroundService stopped
[18:47:05 INF] PairingBackgroundService stopped
[18:47:05 INF] TwinSyncBackgroundService stopped
[18:47:05 INF] TwinSyncBackgroundService stopped
  Passed IoT.Backend.IntegrationTests.Tests.TelemetryIntegrationTests.EmptyTelemetryPayload_ShouldBeHandledGracefully [3 s]
  Standard Output Messages:
 Creating WebApplicationFactory...
 Backend is ready
 Test fixture initialized
 MQTT Test Client connecting to host.docker.internal:54807 as test-device-27aa00661e19452da103ab5de9821d86...
 MQTT Test Client connected
 Published 0 bytes to: farm/test/coord/test/tower/test/telemetry
 MQTT Test Client disconnected
 Disposing test fixture...


[18:47:05 INF] Starting IoT Backend on port 8000
[18:47:05 INF] Starting IoT Backend on port 8000
[18:47:05 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:47:05 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:47:05 INF] PairingBackgroundService starting
[18:47:05 INF] PairingBackgroundService starting
[18:47:05 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:47:05 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:47:05 INF] Connected to MQTT broker
[18:47:05 INF] Connected to MQTT broker
[18:47:06 INF] TelemetryHandler subscribing to MQTT topics
[18:47:06 INF] TelemetryHandler subscribing to MQTT topics
[18:47:06 INF] Subscribed to site/+/coord/+/telemetry
[18:47:06 INF] Subscribed to site/+/coord/+/telemetry
[18:47:06 INF] Subscribed to site/+/coord/+/status
[18:47:06 INF] Subscribed to site/+/coord/+/status
[18:47:06 INF] Subscribed to site/+/ota/progress
[18:47:06 INF] Subscribed to site/+/ota/progress
[18:47:06 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:47:06 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:47:06 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:47:06 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:47:06 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:47:06 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:47:06 INF] Subscribed to farm/+/coord/+/pairing/request
[18:47:06 INF] Subscribed to farm/+/coord/+/pairing/request
[18:47:06 INF] Subscribed to farm/+/coord/+/pairing/status
[18:47:06 INF] Subscribed to farm/+/coord/+/pairing/status
[18:47:06 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:47:06 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:47:06 INF] TelemetryHandler subscribed to all telemetry topics
[18:47:06 INF] TelemetryHandler subscribed to all telemetry topics
[18:47:08 INF] PairingBackgroundService stopped
[18:47:08 INF] PairingBackgroundService stopped
[18:47:08 INF] TwinSyncBackgroundService stopped
[18:47:08 INF] TwinSyncBackgroundService stopped
  Passed IoT.Backend.IntegrationTests.Tests.TelemetryIntegrationTests.TowerTelemetry_ShouldUpdateDigitalTwin [3 s]
  Standard Output Messages:
 Creating WebApplicationFactory...
 Backend is ready
 Test fixture initialized
 MQTT Test Client connecting to host.docker.internal:54807 as test-device-d05c49533d97481badbc9d1979e84166...
 MQTT Test Client connected
 Published 212 bytes to: farm/test-farm-twin/coord/coord-twin/tower/tower-twin/telemetry
 Published JSON: {"air_temp_c":28,"humidity_pct":55,"light_lux":500,"pump_on":false,"light_on":true,"light_brightness":180,"vbat_mv":3300,"status_mode":"operational","fw_version":"1.0.0-test","uptime_s":3600,"signal_quality":-50}
 Digital twin not found (status: NotFound) - this is expected for new towers
 MQTT Test Client disconnected
 Disposing test fixture...


[18:47:08 INF] Starting IoT Backend on port 8000
[18:47:08 INF] Starting IoT Backend on port 8000
[18:47:08 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:47:08 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:47:08 INF] PairingBackgroundService starting
[18:47:08 INF] PairingBackgroundService starting
[18:47:08 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:47:08 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:47:08 INF] Connected to MQTT broker
[18:47:08 INF] Connected to MQTT broker
[18:47:09 INF] TelemetryHandler subscribing to MQTT topics
[18:47:09 INF] TelemetryHandler subscribing to MQTT topics
[18:47:09 INF] Subscribed to site/+/coord/+/telemetry
[18:47:09 INF] Subscribed to site/+/coord/+/telemetry
[18:47:09 INF] Subscribed to site/+/coord/+/status
[18:47:09 INF] Subscribed to site/+/coord/+/status
[18:47:09 INF] Subscribed to site/+/ota/progress
[18:47:09 INF] Subscribed to site/+/ota/progress
[18:47:09 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:47:09 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:47:09 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:47:09 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:47:09 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:47:09 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:47:09 INF] Subscribed to farm/+/coord/+/pairing/request
[18:47:09 INF] Subscribed to farm/+/coord/+/pairing/request
[18:47:09 INF] Subscribed to farm/+/coord/+/pairing/status
[18:47:09 INF] Subscribed to farm/+/coord/+/pairing/status
[18:47:09 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:47:09 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:47:09 INF] TelemetryHandler subscribed to all telemetry topics
[18:47:09 INF] TelemetryHandler subscribed to all telemetry topics
[18:47:09 WRN] Failed to update reported state for tower tower-twin - twin may not exist
[18:47:09 WRN] Failed to update reported state for tower tower-twin - twin may not exist
[18:47:11 WRN] Failed to update reported state for tower tower-001 - twin may not exist
[18:47:11 WRN] Failed to update reported state for tower tower-001 - twin may not exist
[18:47:12 INF] PairingBackgroundService stopped
[18:47:12 INF] PairingBackgroundService stopped
[18:47:12 INF] TwinSyncBackgroundService stopped
[18:47:12 INF] TwinSyncBackgroundService stopped
  Passed IoT.Backend.IntegrationTests.Tests.TelemetryIntegrationTests.TowerTelemetry_WhenPublishedViaMqtt_ShouldBePersisted [3 s]
  Standard Output Messages:
 Creating WebApplicationFactory...
 Backend is ready
 Test fixture initialized
 MQTT Test Client connecting to host.docker.internal:54807 as test-device-ebde8a611b304c17a3cdf64df00924ba...
 MQTT Test Client connected
 Published 213 bytes to: farm/test-farm/coord/coord-001/tower/tower-001/telemetry
 Published JSON: {"air_temp_c":26.5,"humidity_pct":72,"light_lux":450,"pump_on":true,"light_on":true,"light_brightness":200,"vbat_mv":3300,"status_mode":"operational","fw_version":"1.0.0-test","uptime_s":3600,"signal_quality":-50}
 MQTT Test Client disconnected
 Disposing test fixture...


[18:47:12 INF] Starting IoT Backend on port 8000
[18:47:12 INF] Starting IoT Backend on port 8000
[18:47:12 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:47:12 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:47:12 INF] PairingBackgroundService starting
[18:47:12 INF] PairingBackgroundService starting
[18:47:12 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:47:12 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:47:12 INF] HTTP GET /health/live responded 200 in 1.8485 ms
[18:47:12 INF] HTTP GET /health/live responded 200 in 1.8485 ms
[18:47:12 INF] Connected to MQTT broker
[18:47:12 INF] Connected to MQTT broker
[18:47:12 INF] MQTT service started
[18:47:12 INF] MQTT service started
[18:47:13 INF] TelemetryHandler subscribing to MQTT topics
[18:47:13 INF] TelemetryHandler subscribing to MQTT topics
[18:47:13 INF] Subscribed to site/+/coord/+/telemetry
[18:47:13 INF] Subscribed to site/+/coord/+/telemetry
[18:47:13 INF] Subscribed to site/+/coord/+/status
[18:47:13 INF] Subscribed to site/+/coord/+/status
[18:47:13 INF] Subscribed to site/+/ota/progress
[18:47:13 INF] Subscribed to site/+/ota/progress
[18:47:13 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:47:13 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:47:13 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:47:13 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:47:13 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:47:13 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:47:13 INF] Subscribed to farm/+/coord/+/pairing/request
[18:47:13 INF] Subscribed to farm/+/coord/+/pairing/request
[18:47:13 INF] Subscribed to farm/+/coord/+/pairing/status
[18:47:13 INF] Subscribed to farm/+/coord/+/pairing/status
[18:47:13 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:47:13 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:47:13 INF] TelemetryHandler subscribed to all telemetry topics
[18:47:13 INF] TelemetryHandler subscribed to all telemetry topics
[18:47:16 WRN] Failed to update reported state for coordinator coord-002 - twin may not exist
[18:47:16 WRN] Failed to update reported state for coordinator coord-002 - twin may not exist
[18:47:16 INF] MQTT service stopped
[18:47:16 INF] MQTT service stopped
[18:47:16 INF] PairingBackgroundService stopped
[18:47:16 INF] PairingBackgroundService stopped
[18:47:16 INF] TwinSyncBackgroundService stopped
[18:47:16 INF] TwinSyncBackgroundService stopped
  Passed IoT.Backend.IntegrationTests.Tests.TelemetryIntegrationTests.ReservoirTelemetry_WhenPublishedViaMqtt_ShouldBePersisted [3 s]
  Standard Output Messages:
 Creating WebApplicationFactory...
 Backend is ready
 Test fixture initialized
 MQTT Test Client connecting to host.docker.internal:54807 as test-device-16a7cabdcc04411db846b3cc210915dc...
 MQTT Test Client connected
 Published 318 bytes to: farm/test-farm-2/coord/coord-002/reservoir/telemetry
 Published JSON: {"ph":6.2,"ec_ms_cm":1.8,"tds_ppm":900,"water_temp_c":21.5,"water_level_pct":78,"water_level_cm":39,"low_water_alert":false,"main_pump_on":true,"dosing_pump_ph_on":false,"dosing_pump_nutrient_on":false,"towers_online":3,"wifi_rssi":-45,"status_mode":"operational","fw_version":"1.0.0-test","uptime_s":7200,"temp_c":28}
 MQTT Test Client disconnected
 Disposing test fixture...


[18:47:16 INF] Starting IoT Backend on port 8000
[18:47:16 INF] Starting IoT Backend on port 8000
[18:47:16 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:47:16 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:47:16 INF] PairingBackgroundService starting
[18:47:16 INF] PairingBackgroundService starting
[18:47:16 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:47:16 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:47:16 INF] Connected to MQTT broker
[18:47:16 INF] Connected to MQTT broker
[18:47:17 INF] TelemetryHandler subscribing to MQTT topics
[18:47:17 INF] TelemetryHandler subscribing to MQTT topics
[18:47:17 INF] Subscribed to site/+/coord/+/telemetry
[18:47:17 INF] Subscribed to site/+/coord/+/telemetry
[18:47:17 INF] Subscribed to site/+/coord/+/status
[18:47:17 INF] Subscribed to site/+/coord/+/status
[18:47:17 INF] Subscribed to site/+/ota/progress
[18:47:17 INF] Subscribed to site/+/ota/progress
[18:47:17 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:47:17 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:47:17 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:47:17 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:47:17 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:47:17 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:47:17 INF] Subscribed to farm/+/coord/+/pairing/request
[18:47:17 INF] Subscribed to farm/+/coord/+/pairing/request
[18:47:17 INF] Subscribed to farm/+/coord/+/pairing/status
[18:47:17 INF] Subscribed to farm/+/coord/+/pairing/status
[18:47:17 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:47:17 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:47:17 INF] TelemetryHandler subscribed to all telemetry topics
[18:47:17 INF] TelemetryHandler subscribed to all telemetry topics
[18:47:18 ERR] Error handling tower telemetry from farm/test/coord/test/tower/test/telemetry
System.Text.Json.JsonException: 'not valid json {' is an invalid JSON literal. Expected the literal 'null'. Path: $ | LineNumber: 0 | BytePositionInLine: 1.
 ---> System.Text.Json.JsonReaderException: 'not valid json {' is an invalid JSON literal. Expected the literal 'null'. LineNumber: 0 | BytePositionInLine: 1.
   at System.Text.Json.ThrowHelper.ThrowJsonReaderException(Utf8JsonReader& json, ExceptionResource resource, Byte nextByte, ReadOnlySpan`1 bytes)
   at System.Text.Json.Utf8JsonReader.ThrowInvalidLiteral(ReadOnlySpan`1 span)
   at System.Text.Json.Utf8JsonReader.CheckLiteral(ReadOnlySpan`1 span, ReadOnlySpan`1 literal)
   at System.Text.Json.Utf8JsonReader.ConsumeLiteral(ReadOnlySpan`1 literal, JsonTokenType tokenType)
   at System.Text.Json.Utf8JsonReader.ConsumeValue(Byte marker)
   at System.Text.Json.Utf8JsonReader.ReadFirstToken(Byte first)
   at System.Text.Json.Utf8JsonReader.ReadSingleSegment()
   at System.Text.Json.Serialization.JsonConverter`1.ReadCore(Utf8JsonReader& reader, JsonSerializerOptions options, ReadStack& state)
   --- End of inner exception stack trace ---
   at System.Text.Json.ThrowHelper.ReThrowWithPath(ReadStack& state, JsonReaderException ex)
   at System.Text.Json.Serialization.JsonConverter`1.ReadCore(Utf8JsonReader& reader, JsonSerializerOptions options, ReadStack& state)
   at System.Text.Json.JsonSerializer.ReadFromSpan[TValue](ReadOnlySpan`1 utf8Json, JsonTypeInfo`1 jsonTypeInfo, Nullable`1 actualByteCount)
   at System.Text.Json.JsonSerializer.Deserialize[TValue](ReadOnlySpan`1 utf8Json, JsonSerializerOptions options)
   at IoT.Backend.Services.TelemetryHandler.HandleTowerTelemetry(String topic, Byte[] payload) in /src/Backend/src/IoT.Backend/Services/TelemetryHandler.cs:line 334
[18:47:18 ERR] Error handling tower telemetry from farm/test/coord/test/tower/test/telemetry
System.Text.Json.JsonException: 'not valid json {' is an invalid JSON literal. Expected the literal 'null'. Path: $ | LineNumber: 0 | BytePositionInLine: 1.
 ---> System.Text.Json.JsonReaderException: 'not valid json {' is an invalid JSON literal. Expected the literal 'null'. LineNumber: 0 | BytePositionInLine: 1.
   at System.Text.Json.ThrowHelper.ThrowJsonReaderException(Utf8JsonReader& json, ExceptionResource resource, Byte nextByte, ReadOnlySpan`1 bytes)
   at System.Text.Json.Utf8JsonReader.ThrowInvalidLiteral(ReadOnlySpan`1 span)
   at System.Text.Json.Utf8JsonReader.CheckLiteral(ReadOnlySpan`1 span, ReadOnlySpan`1 literal)
   at System.Text.Json.Utf8JsonReader.ConsumeLiteral(ReadOnlySpan`1 literal, JsonTokenType tokenType)
   at System.Text.Json.Utf8JsonReader.ConsumeValue(Byte marker)
   at System.Text.Json.Utf8JsonReader.ReadFirstToken(Byte first)
   at System.Text.Json.Utf8JsonReader.ReadSingleSegment()
   at System.Text.Json.Serialization.JsonConverter`1.ReadCore(Utf8JsonReader& reader, JsonSerializerOptions options, ReadStack& state)
   --- End of inner exception stack trace ---
   at System.Text.Json.ThrowHelper.ReThrowWithPath(ReadStack& state, JsonReaderException ex)
   at System.Text.Json.Serialization.JsonConverter`1.ReadCore(Utf8JsonReader& reader, JsonSerializerOptions options, ReadStack& state)
   at System.Text.Json.JsonSerializer.ReadFromSpan[TValue](ReadOnlySpan`1 utf8Json, JsonTypeInfo`1 jsonTypeInfo, Nullable`1 actualByteCount)
   at System.Text.Json.JsonSerializer.Deserialize[TValue](ReadOnlySpan`1 utf8Json, JsonSerializerOptions options)
   at IoT.Backend.Services.TelemetryHandler.HandleTowerTelemetry(String topic, Byte[] payload) in /src/Backend/src/IoT.Backend/Services/TelemetryHandler.cs:line 334
[18:47:19 INF] PairingBackgroundService stopped
[18:47:19 INF] PairingBackgroundService stopped
[18:47:19 INF] TwinSyncBackgroundService stopped
[18:47:19 INF] TwinSyncBackgroundService stopped
  Passed IoT.Backend.IntegrationTests.Tests.TelemetryIntegrationTests.InvalidTelemetryPayload_ShouldNotCrashBackend [3 s]
  Standard Output Messages:
 Creating WebApplicationFactory...
 Backend is ready
 Test fixture initialized
 MQTT Test Client connecting to host.docker.internal:54807 as test-device-e1f1d78554844d86b5a305d2313ba494...
 MQTT Test Client connected
 Published 16 bytes to: farm/test/coord/test/tower/test/telemetry
 MQTT Test Client disconnected
 Disposing test fixture...


[18:47:19 INF] Starting IoT Backend on port 8000
[18:47:19 INF] Starting IoT Backend on port 8000
[18:47:19 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:47:19 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:47:19 INF] PairingBackgroundService starting
[18:47:19 INF] PairingBackgroundService starting
[18:47:19 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:47:19 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:47:19 INF] Connected to MQTT broker
[18:47:19 INF] Connected to MQTT broker
[18:47:20 INF] TelemetryHandler subscribing to MQTT topics
[18:47:20 INF] TelemetryHandler subscribing to MQTT topics
[18:47:20 INF] Subscribed to site/+/coord/+/telemetry
[18:47:20 INF] Subscribed to site/+/coord/+/telemetry
[18:47:20 INF] Subscribed to site/+/coord/+/status
[18:47:20 INF] Subscribed to site/+/coord/+/status
[18:47:20 INF] Subscribed to site/+/ota/progress
[18:47:20 INF] Subscribed to site/+/ota/progress
[18:47:20 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:47:20 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:47:20 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:47:20 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:47:20 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:47:20 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:47:20 INF] Subscribed to farm/+/coord/+/pairing/request
[18:47:20 INF] Subscribed to farm/+/coord/+/pairing/request
[18:47:20 INF] Subscribed to farm/+/coord/+/pairing/status
[18:47:20 INF] Subscribed to farm/+/coord/+/pairing/status
[18:47:21 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:47:21 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:47:21 INF] TelemetryHandler subscribed to all telemetry topics
[18:47:21 INF] TelemetryHandler subscribed to all telemetry topics
[18:47:22 WRN] Failed to update reported state for coordinator coord-alert - twin may not exist
[18:47:22 WRN] Failed to update reported state for coordinator coord-alert - twin may not exist
[18:47:23 INF] PairingBackgroundService stopped
[18:47:23 INF] PairingBackgroundService stopped
[18:47:23 INF] TwinSyncBackgroundService stopped
[18:47:23 INF] TwinSyncBackgroundService stopped
  Passed IoT.Backend.IntegrationTests.Tests.TelemetryIntegrationTests.ReservoirTelemetry_WithLowWaterLevel_ShouldSetAlert [3 s]
  Standard Output Messages:
 Creating WebApplicationFactory...
 Backend is ready
 Test fixture initialized
 MQTT Test Client connecting to host.docker.internal:54807 as test-device-95a0883636d546bb9f7094d32b72fcc0...
 MQTT Test Client connected
 Published 314 bytes to: farm/test-farm-alert/coord/coord-alert/reservoir/telemetry
 Published JSON: {"ph":6,"ec_ms_cm":1.5,"tds_ppm":750,"water_temp_c":22,"water_level_pct":15,"water_level_cm":7.5,"low_water_alert":true,"main_pump_on":true,"dosing_pump_ph_on":false,"dosing_pump_nutrient_on":false,"towers_online":2,"wifi_rssi":-45,"status_mode":"operational","fw_version":"1.0.0-test","uptime_s":7200,"temp_c":28}
 MQTT Test Client disconnected
 Disposing test fixture...


[18:47:23 INF] Starting IoT Backend on port 8000
[18:47:23 INF] Starting IoT Backend on port 8000
[18:47:23 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:47:23 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:47:23 INF] PairingBackgroundService starting
[18:47:23 INF] PairingBackgroundService starting
[18:47:23 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:47:23 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:47:23 INF] Connected to MQTT broker
[18:47:23 INF] Connected to MQTT broker
[18:47:24 INF] TelemetryHandler subscribing to MQTT topics
[18:47:24 INF] TelemetryHandler subscribing to MQTT topics
[18:47:24 INF] Subscribed to site/+/coord/+/telemetry
[18:47:24 INF] Subscribed to site/+/coord/+/telemetry
[18:47:24 INF] Subscribed to site/+/coord/+/status
[18:47:24 INF] Subscribed to site/+/coord/+/status
[18:47:24 INF] Subscribed to site/+/ota/progress
[18:47:24 INF] Subscribed to site/+/ota/progress
[18:47:24 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:47:24 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:47:24 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:47:24 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:47:24 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:47:24 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:47:24 INF] Subscribed to farm/+/coord/+/pairing/request
[18:47:24 INF] Subscribed to farm/+/coord/+/pairing/request
[18:47:24 INF] Subscribed to farm/+/coord/+/pairing/status
[18:47:24 INF] Subscribed to farm/+/coord/+/pairing/status
[18:47:24 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:47:24 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:47:24 INF] TelemetryHandler subscribed to all telemetry topics
[18:47:24 INF] TelemetryHandler subscribed to all telemetry topics
[18:47:25 WRN] Failed to update reported state for tower tower-ts - twin may not exist
[18:47:25 WRN] Failed to update reported state for tower tower-ts - twin may not exist
[18:47:25 WRN] Failed to update reported state for tower tower-ts - twin may not exist
[18:47:25 WRN] Failed to update reported state for tower tower-ts - twin may not exist
[18:47:25 WRN] Failed to update reported state for tower tower-ts - twin may not exist
[18:47:25 WRN] Failed to update reported state for tower tower-ts - twin may not exist
[18:47:25 WRN] Failed to update reported state for tower tower-ts - twin may not exist
[18:47:25 WRN] Failed to update reported state for tower tower-ts - twin may not exist
[18:47:25 WRN] Failed to update reported state for tower tower-ts - twin may not exist
[18:47:25 WRN] Failed to update reported state for tower tower-ts - twin may not exist
[18:47:27 INF] PairingBackgroundService stopped
[18:47:27 INF] PairingBackgroundService stopped
[18:47:27 INF] TwinSyncBackgroundService stopped
[18:47:27 INF] TwinSyncBackgroundService stopped
  Passed IoT.Backend.IntegrationTests.Tests.TelemetryIntegrationTests.MultipleTelemetryMessages_ShouldCreateTimeSeriesData [4 s]
  Standard Output Messages:
 Creating WebApplicationFactory...
 Backend is ready
 Test fixture initialized
 MQTT Test Client connecting to host.docker.internal:54807 as test-device-3530eaec398c459d8e34a8236aef176e...
 MQTT Test Client connected
 Published 212 bytes to: farm/test-farm-ts/coord/coord-ts/tower/tower-ts/telemetry
 Published JSON: {"air_temp_c":20,"humidity_pct":60,"light_lux":500,"pump_on":false,"light_on":true,"light_brightness":128,"vbat_mv":3300,"status_mode":"operational","fw_version":"1.0.0-test","uptime_s":3600,"signal_quality":-50}
 Published 212 bytes to: farm/test-farm-ts/coord/coord-ts/tower/tower-ts/telemetry
 Published JSON: {"air_temp_c":21,"humidity_pct":61,"light_lux":500,"pump_on":false,"light_on":true,"light_brightness":128,"vbat_mv":3300,"status_mode":"operational","fw_version":"1.0.0-test","uptime_s":3600,"signal_quality":-50}
 Published 212 bytes to: farm/test-farm-ts/coord/coord-ts/tower/tower-ts/telemetry
 Published JSON: {"air_temp_c":22,"humidity_pct":62,"light_lux":500,"pump_on":false,"light_on":true,"light_brightness":128,"vbat_mv":3300,"status_mode":"operational","fw_version":"1.0.0-test","uptime_s":3600,"signal_quality":-50}
 Published 212 bytes to: farm/test-farm-ts/coord/coord-ts/tower/tower-ts/telemetry
 Published JSON: {"air_temp_c":23,"humidity_pct":63,"light_lux":500,"pump_on":false,"light_on":true,"light_brightness":128,"vbat_mv":3300,"status_mode":"operational","fw_version":"1.0.0-test","uptime_s":3600,"signal_quality":-50}
 Published 212 bytes to: farm/test-farm-ts/coord/coord-ts/tower/tower-ts/telemetry
 Published JSON: {"air_temp_c":24,"humidity_pct":64,"light_lux":500,"pump_on":false,"light_on":true,"light_brightness":128,"vbat_mv":3300,"status_mode":"operational","fw_version":"1.0.0-test","uptime_s":3600,"signal_quality":-50}
 MQTT Test Client disconnected
 Disposing test fixture...


[18:47:27 INF] Starting IoT Backend on port 8000
[18:47:27 INF] Starting IoT Backend on port 8000
[18:47:27 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:47:27 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:47:27 INF] PairingBackgroundService starting
[18:47:27 INF] PairingBackgroundService starting
[18:47:27 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:47:27 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:47:27 INF] Connected to MQTT broker
[18:47:27 INF] Connected to MQTT broker
[18:47:27 INF] PairingBackgroundService stopped
[18:47:27 INF] PairingBackgroundService stopped
[18:47:27 INF] TwinSyncBackgroundService stopped
[18:47:27 INF] TwinSyncBackgroundService stopped
[18:47:27 INF] Starting IoT Backend on port 8000
[18:47:27 INF] Starting IoT Backend on port 8000
[18:47:27 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:47:27 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:47:27 INF] PairingBackgroundService starting
[18:47:27 INF] PairingBackgroundService starting
[18:47:27 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:47:27 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:47:27 INF] Connected to MQTT broker
[18:47:27 INF] Connected to MQTT broker
[18:47:27 INF] PairingBackgroundService stopped
[18:47:27 INF] PairingBackgroundService stopped
[18:47:27 INF] TwinSyncBackgroundService stopped
[18:47:27 INF] TwinSyncBackgroundService stopped
[18:47:27 INF] Starting IoT Backend on port 8000
[18:47:27 INF] Starting IoT Backend on port 8000
[18:47:27 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:47:27 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:47:27 INF] PairingBackgroundService starting
[18:47:27 INF] PairingBackgroundService starting
[18:47:27 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:47:27 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:47:27 INF] Connected to MQTT broker
[18:47:27 INF] Connected to MQTT broker
[18:47:28 INF] PairingBackgroundService stopped
[18:47:28 INF] PairingBackgroundService stopped
[18:47:28 INF] TwinSyncBackgroundService stopped
[18:47:28 INF] TwinSyncBackgroundService stopped
[18:47:28 INF] Starting IoT Backend on port 8000
[18:47:28 INF] Starting IoT Backend on port 8000
[18:47:28 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:47:28 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:47:28 INF] PairingBackgroundService starting
[18:47:28 INF] PairingBackgroundService starting
[18:47:28 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:47:28 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:47:28 INF] HTTP GET /health/live responded 200 in 1.3956 ms
[18:47:28 INF] HTTP GET /health/live responded 200 in 1.3956 ms
[18:47:28 INF] Connected to MQTT broker
[18:47:28 INF] Connected to MQTT broker
[18:47:28 INF] MQTT service started
[18:47:28 INF] MQTT service started
  Passed IoT.Backend.IntegrationTests.Tests.TowerIntegrationTests.DeleteTower_ShouldRemoveFromDatabase [137 ms]
  Standard Output Messages:
 Creating WebApplicationFactory...
 Backend is ready
 Test fixture initialized
 Disposing test fixture...


  Passed IoT.Backend.IntegrationTests.Tests.TowerIntegrationTests.UpdateTowerName_ShouldUpdateOnlyName [231 ms]
  Standard Output Messages:
 Creating WebApplicationFactory...
 Backend is ready
 Test fixture initialized
 Disposing test fixture...


  Passed IoT.Backend.IntegrationTests.Tests.TowerIntegrationTests.RecordHeightMeasurement_ShouldUpdateTowerLastHeight [673 ms]
  Standard Output Messages:
 Creating WebApplicationFactory...
 Backend is ready
 Test fixture initialized
 Disposing test fixture...


[18:47:29 INF] TelemetryHandler subscribing to MQTT topics
[18:47:29 INF] TelemetryHandler subscribing to MQTT topics
[18:47:29 INF] Subscribed to site/+/coord/+/telemetry
[18:47:29 INF] Subscribed to site/+/coord/+/telemetry
[18:47:29 INF] Subscribed to site/+/coord/+/status
[18:47:29 INF] Subscribed to site/+/coord/+/status
[18:47:29 INF] Subscribed to site/+/ota/progress
[18:47:29 INF] Subscribed to site/+/ota/progress
[18:47:29 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:47:29 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:47:29 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:47:29 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:47:29 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:47:29 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:47:29 INF] Subscribed to farm/+/coord/+/pairing/request
[18:47:29 INF] Subscribed to farm/+/coord/+/pairing/request
[18:47:29 INF] Subscribed to farm/+/coord/+/pairing/status
[18:47:29 INF] Subscribed to farm/+/coord/+/pairing/status
[18:47:29 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:47:29 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:47:29 INF] TelemetryHandler subscribed to all telemetry topics
[18:47:29 INF] TelemetryHandler subscribed to all telemetry topics
[18:47:29 INF] Set crop for tower tower-crop-default: Kale, planted 01/06/2026 18:47:29
[18:47:29 INF] Set crop for tower tower-crop-default: Kale, planted 01/06/2026 18:47:29
[18:47:29 INF] HTTP POST /api/towers/test-farm-crop-default/coord-crop-default/tower-crop-default/crop responded 200 in 13.0667 ms
[18:47:29 INF] HTTP POST /api/towers/test-farm-crop-default/coord-crop-default/tower-crop-default/crop responded 200 in 13.0667 ms
[18:47:29 INF] MQTT service stopped
[18:47:29 INF] PairingBackgroundService stopped
[18:47:29 INF] MQTT service stopped
[18:47:29 INF] PairingBackgroundService stopped
[18:47:29 INF] TwinSyncBackgroundService stopped
[18:47:29 INF] TwinSyncBackgroundService stopped
[18:47:29 INF] Starting IoT Backend on port 8000
[18:47:29 INF] Starting IoT Backend on port 8000
[18:47:29 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:47:29 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:47:29 INF] PairingBackgroundService starting
[18:47:29 INF] PairingBackgroundService starting
[18:47:29 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:47:29 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:47:29 INF] Connected to MQTT broker
[18:47:29 INF] Connected to MQTT broker
[18:47:29 INF] PairingBackgroundService stopped
[18:47:29 INF] PairingBackgroundService stopped
[18:47:29 INF] TwinSyncBackgroundService stopped
[18:47:29 INF] TwinSyncBackgroundService stopped
[18:47:29 INF] Starting IoT Backend on port 8000
[18:47:29 INF] Starting IoT Backend on port 8000
[18:47:29 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:47:29 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:47:29 INF] PairingBackgroundService starting
[18:47:29 INF] PairingBackgroundService starting
[18:47:29 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:47:29 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:47:29 INF] Connected to MQTT broker
[18:47:29 INF] Connected to MQTT broker
[18:47:29 INF] PairingBackgroundService stopped
[18:47:29 INF] PairingBackgroundService stopped
[18:47:29 INF] TwinSyncBackgroundService stopped
[18:47:29 INF] TwinSyncBackgroundService stopped
[18:47:29 INF] Starting IoT Backend on port 8000
[18:47:29 INF] Starting IoT Backend on port 8000
[18:47:29 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:47:29 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:47:29 INF] PairingBackgroundService starting
[18:47:29 INF] PairingBackgroundService starting
[18:47:29 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:47:29 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:47:29 INF] Connected to MQTT broker
[18:47:29 INF] Connected to MQTT broker
[18:47:30 INF] PairingBackgroundService stopped
[18:47:30 INF] PairingBackgroundService stopped
[18:47:30 INF] TwinSyncBackgroundService stopped
[18:47:30 INF] TwinSyncBackgroundService stopped
[18:47:30 INF] Starting IoT Backend on port 8000
[18:47:30 INF] Starting IoT Backend on port 8000
[18:47:30 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:47:30 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:47:30 INF] PairingBackgroundService starting
[18:47:30 INF] PairingBackgroundService starting
[18:47:30 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:47:30 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:47:30 INF] Connected to MQTT broker
[18:47:30 INF] Connected to MQTT broker
  Passed IoT.Backend.IntegrationTests.Tests.TowerIntegrationTests.SetCrop_WithoutPlantingDate_ShouldDefaultToNow [290 ms]
  Standard Output Messages:
 Creating WebApplicationFactory...
 Backend is ready
 Test fixture initialized
 Disposing test fixture...


  Passed IoT.Backend.IntegrationTests.Tests.TowerIntegrationTests.GetTelemetry_ShouldReturnHistoricalData [322 ms]
  Standard Output Messages:
 Creating WebApplicationFactory...
 Backend is ready
 Test fixture initialized
 Disposing test fixture...


  Passed IoT.Backend.IntegrationTests.Tests.TowerIntegrationTests.SetLight_WithoutBrightness_ShouldDefaultTo255 [119 ms]
  Standard Output Messages:
 Creating WebApplicationFactory...
 Backend is ready
 Test fixture initialized
 MQTT Test Client connecting to host.docker.internal:54807 as test-device-8463692ee46a499fa2ddc4f03ce8b6d8...
 MQTT Test Client connected
 Subscribed to: farm/test-farm-light-default/coord/coord-light-default/tower/tower-light-default/cmd
 Received message on: farm/test-farm-light-default/coord/coord-light-default/tower/tower-light-default/cmd
 MQTT Test Client disconnected
 Disposing test fixture...


  Passed IoT.Backend.IntegrationTests.Tests.TowerIntegrationTests.SendCommand_ShouldPublishToMqtt [130 ms]
  Standard Output Messages:
 Creating WebApplicationFactory...
 Backend is ready
 Test fixture initialized
 MQTT Test Client connecting to host.docker.internal:54807 as test-device-4e45443672764393aa8e7460ca8d9b0e...
 MQTT Test Client connected
 Subscribed to: farm/test-farm-cmd/coord/coord-cmd/tower/tower-cmd/cmd
 Received message on: farm/test-farm-cmd/coord/coord-cmd/tower/tower-cmd/cmd
 MQTT Test Client disconnected
 Disposing test fixture...


[18:47:31 INF] TelemetryHandler subscribing to MQTT topics
[18:47:31 INF] TelemetryHandler subscribing to MQTT topics
[18:47:31 INF] Subscribed to site/+/coord/+/telemetry
[18:47:31 INF] Subscribed to site/+/coord/+/telemetry
[18:47:31 INF] Subscribed to site/+/coord/+/status
[18:47:31 INF] Subscribed to site/+/coord/+/status
[18:47:31 INF] Subscribed to site/+/ota/progress
[18:47:31 INF] Subscribed to site/+/ota/progress
[18:47:31 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:47:31 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:47:31 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:47:31 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:47:31 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:47:31 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:47:31 INF] Subscribed to farm/+/coord/+/pairing/request
[18:47:31 INF] Subscribed to farm/+/coord/+/pairing/request
[18:47:31 INF] Subscribed to farm/+/coord/+/pairing/status
[18:47:31 INF] Subscribed to farm/+/coord/+/pairing/status
[18:47:31 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:47:31 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:47:31 INF] TelemetryHandler subscribed to all telemetry topics
[18:47:31 INF] TelemetryHandler subscribed to all telemetry topics
[18:47:32 INF] PairingBackgroundService stopped
[18:47:32 INF] PairingBackgroundService stopped
[18:47:32 INF] TwinSyncBackgroundService stopped
[18:47:32 INF] TwinSyncBackgroundService stopped
  Passed IoT.Backend.IntegrationTests.Tests.TowerIntegrationTests.UpsertTower_UpdateExisting_ShouldUpdateDatabase [480 ms]
  Standard Output Messages:
 Creating WebApplicationFactory...
 Backend is ready
 Test fixture initialized
 Disposing test fixture...


[18:47:32 INF] Starting IoT Backend on port 8000
[18:47:32 INF] Starting IoT Backend on port 8000
[18:47:32 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:47:32 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:47:32 INF] PairingBackgroundService starting
[18:47:32 INF] PairingBackgroundService starting
[18:47:32 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:47:32 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:47:32 INF] Connected to MQTT broker
[18:47:32 INF] Connected to MQTT broker
[18:47:32 INF] PairingBackgroundService stopped
[18:47:32 INF] PairingBackgroundService stopped
[18:47:32 INF] TwinSyncBackgroundService stopped
[18:47:32 INF] TwinSyncBackgroundService stopped
[18:47:32 INF] Starting IoT Backend on port 8000
[18:47:32 INF] Starting IoT Backend on port 8000
[18:47:32 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:47:32 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:47:32 INF] PairingBackgroundService starting
[18:47:32 INF] PairingBackgroundService starting
[18:47:32 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:47:32 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:47:32 INF] Connected to MQTT broker
[18:47:32 INF] Connected to MQTT broker
[18:47:32 INF] PairingBackgroundService stopped
[18:47:32 INF] PairingBackgroundService stopped
[18:47:32 INF] TwinSyncBackgroundService stopped
[18:47:32 INF] TwinSyncBackgroundService stopped
[18:47:32 INF] Starting IoT Backend on port 8000
[18:47:32 INF] Starting IoT Backend on port 8000
[18:47:32 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:47:32 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:47:32 INF] PairingBackgroundService starting
[18:47:32 INF] PairingBackgroundService starting
[18:47:32 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:47:32 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:47:32 INF] Connected to MQTT broker
[18:47:32 INF] Connected to MQTT broker
[18:47:33 INF] PairingBackgroundService stopped
[18:47:33 INF] PairingBackgroundService stopped
[18:47:33 INF] TwinSyncBackgroundService stopped
[18:47:33 INF] TwinSyncBackgroundService stopped
[18:47:33 INF] Starting IoT Backend on port 8000
[18:47:33 INF] Starting IoT Backend on port 8000
[18:47:33 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:47:33 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:47:33 INF] PairingBackgroundService starting
[18:47:33 INF] PairingBackgroundService starting
[18:47:33 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:47:33 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:47:33 INF] HTTP GET /health/live responded 200 in 2.3256 ms
[18:47:33 INF] HTTP GET /health/live responded 200 in 2.3256 ms
[18:47:33 INF] Connected to MQTT broker
[18:47:33 INF] Connected to MQTT broker
[18:47:33 INF] MQTT service started
[18:47:33 INF] MQTT service started
  Passed IoT.Backend.IntegrationTests.Tests.TowerIntegrationTests.GetLatestTelemetry_WhenNoData_ShouldReturnNotFound [10 ms]
  Standard Output Messages:
 Creating WebApplicationFactory...
 Backend is ready
 Test fixture initialized
 Disposing test fixture...


  Passed IoT.Backend.IntegrationTests.Tests.TowerIntegrationTests.SetPump_Off_ShouldPublishPumpOffCommand [122 ms]
  Standard Output Messages:
 Creating WebApplicationFactory...
 Backend is ready
 Test fixture initialized
 MQTT Test Client connecting to host.docker.internal:54807 as test-device-3ca41885a34142f59ef252c1924c6527...
 MQTT Test Client connected
 Subscribed to: farm/test-farm-pump-off/coord/coord-pump-off/tower/tower-pump-off/cmd
 Received message on: farm/test-farm-pump-off/coord/coord-pump-off/tower/tower-pump-off/cmd
 MQTT Test Client disconnected
 Disposing test fixture...


  Passed IoT.Backend.IntegrationTests.Tests.TowerIntegrationTests.GetHeightMeasurements_WithDateRange_ShouldFilterByTime [821 ms]
  Standard Output Messages:
 Creating WebApplicationFactory...
 Backend is ready
 Test fixture initialized
 Disposing test fixture...


[18:47:34 INF] TelemetryHandler subscribing to MQTT topics
[18:47:34 INF] TelemetryHandler subscribing to MQTT topics
[18:47:34 INF] Subscribed to site/+/coord/+/telemetry
[18:47:34 INF] Subscribed to site/+/coord/+/telemetry
[18:47:34 INF] Subscribed to site/+/coord/+/status
[18:47:34 INF] Subscribed to site/+/coord/+/status
[18:47:34 INF] Subscribed to site/+/ota/progress
[18:47:34 INF] Subscribed to site/+/ota/progress
[18:47:34 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:47:34 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:47:34 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:47:34 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:47:34 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:47:34 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:47:34 INF] Subscribed to farm/+/coord/+/pairing/request
[18:47:34 INF] Subscribed to farm/+/coord/+/pairing/request
[18:47:34 INF] Subscribed to farm/+/coord/+/pairing/status
[18:47:34 INF] Subscribed to farm/+/coord/+/pairing/status
[18:47:34 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:47:34 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:47:34 INF] TelemetryHandler subscribed to all telemetry topics
[18:47:34 INF] TelemetryHandler subscribed to all telemetry topics
[18:47:35 INF] HTTP GET /api/towers/nonexistent-farm/nonexistent-coord/nonexistent-tower responded 404 in 6.8727 ms
[18:47:35 INF] HTTP GET /api/towers/nonexistent-farm/nonexistent-coord/nonexistent-tower responded 404 in 6.8727 ms
[18:47:35 INF] MQTT service stopped
[18:47:35 INF] MQTT service stopped
[18:47:35 INF] PairingBackgroundService stopped
[18:47:35 INF] PairingBackgroundService stopped
[18:47:35 INF] TwinSyncBackgroundService stopped
[18:47:35 INF] TwinSyncBackgroundService stopped
  Passed IoT.Backend.IntegrationTests.Tests.TowerIntegrationTests.GetTower_WhenNotExists_ShouldReturnNotFound [10 ms]
  Standard Output Messages:
 Creating WebApplicationFactory...
 Backend is ready
 Test fixture initialized
 Disposing test fixture...


[18:47:35 INF] Starting IoT Backend on port 8000
[18:47:35 INF] Starting IoT Backend on port 8000
[18:47:35 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:47:35 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:47:35 INF] PairingBackgroundService starting
[18:47:35 INF] PairingBackgroundService starting
[18:47:35 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:47:35 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:47:35 INF] HTTP GET /health/live responded 200 in 2.3484 ms
[18:47:35 INF] HTTP GET /health/live responded 200 in 2.3484 ms
[18:47:35 INF] Connected to MQTT broker
[18:47:35 INF] Connected to MQTT broker
[18:47:35 INF] MQTT service started
[18:47:35 INF] MQTT service started
[18:47:35 INF] Set light for tower tower-light: on=True, brightness=80
[18:47:35 INF] Set light for tower tower-light: on=True, brightness=80
[18:47:35 INF] HTTP POST /api/towers/test-farm-light/coord-light/tower-light/light responded 202 in 5.3632 ms
[18:47:35 INF] HTTP POST /api/towers/test-farm-light/coord-light/tower-light/light responded 202 in 5.3632 ms
[18:47:35 INF] MQTT service stopped
[18:47:35 INF] MQTT service stopped
[18:47:35 INF] PairingBackgroundService stopped
[18:47:35 INF] PairingBackgroundService stopped
[18:47:35 INF] TwinSyncBackgroundService stopped
[18:47:35 INF] TwinSyncBackgroundService stopped
[18:47:35 INF] Starting IoT Backend on port 8000
[18:47:35 INF] Starting IoT Backend on port 8000
[18:47:35 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:47:35 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:47:35 INF] PairingBackgroundService starting
[18:47:35 INF] PairingBackgroundService starting
[18:47:35 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:47:35 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:47:35 INF] Connected to MQTT broker
[18:47:35 INF] Connected to MQTT broker
[18:47:34 INF] TelemetryHandler subscribing to MQTT topics
[18:47:34 INF] TelemetryHandler subscribing to MQTT topics
[18:47:34 INF] Subscribed to site/+/coord/+/telemetry
[18:47:34 INF] Subscribed to site/+/coord/+/telemetry
[18:47:34 INF] Subscribed to site/+/coord/+/status
[18:47:34 INF] Subscribed to site/+/coord/+/status
[18:47:34 INF] Subscribed to site/+/ota/progress
[18:47:34 INF] Subscribed to site/+/ota/progress
[18:47:34 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:47:34 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:47:34 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:47:34 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:47:34 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:47:34 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:47:34 INF] Subscribed to farm/+/coord/+/pairing/request
[18:47:34 INF] Subscribed to farm/+/coord/+/pairing/request
[18:47:34 INF] Subscribed to farm/+/coord/+/pairing/status
[18:47:34 INF] Subscribed to farm/+/coord/+/pairing/status
[18:47:34 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:47:34 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:47:34 INF] TelemetryHandler subscribed to all telemetry topics
[18:47:34 INF] TelemetryHandler subscribed to all telemetry topics
  Passed IoT.Backend.IntegrationTests.Tests.TowerIntegrationTests.SetLight_ShouldPublishLightCommand [122 ms]
  Standard Output Messages:
 Creating WebApplicationFactory...
 Backend is ready
 Test fixture initialized
 MQTT Test Client connecting to host.docker.internal:54807 as test-device-5527016dfc4f4ac1a2825f761d880938...
 MQTT Test Client connected
 Subscribed to: farm/test-farm-light/coord/coord-light/tower/tower-light/cmd
 Received message on: farm/test-farm-light/coord/coord-light/tower/tower-light/cmd
 MQTT Test Client disconnected
 Disposing test fixture...


[18:47:36 INF] PairingBackgroundService stopped
[18:47:36 INF] PairingBackgroundService stopped
[18:47:36 INF] TwinSyncBackgroundService stopped
[18:47:36 INF] TwinSyncBackgroundService stopped
  Passed IoT.Backend.IntegrationTests.Tests.TowerIntegrationTests.RecordHeightMeasurement_ShouldPersistToDatabase [3 s]
  Standard Output Messages:
 Creating WebApplicationFactory...
 Backend is ready
 Test fixture initialized
 Disposing test fixture...


[18:47:36 INF] Starting IoT Backend on port 8000
[18:47:36 INF] Starting IoT Backend on port 8000
[18:47:36 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:47:36 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:47:36 INF] PairingBackgroundService starting
[18:47:36 INF] PairingBackgroundService starting
[18:47:36 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:47:36 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:47:36 INF] Connected to MQTT broker
[18:47:36 INF] Connected to MQTT broker
[18:47:37 INF] TelemetryHandler subscribing to MQTT topics
[18:47:37 INF] TelemetryHandler subscribing to MQTT topics
[18:47:37 INF] Subscribed to site/+/coord/+/telemetry
[18:47:37 INF] Subscribed to site/+/coord/+/telemetry
[18:47:37 INF] Subscribed to site/+/coord/+/status
[18:47:37 INF] Subscribed to site/+/coord/+/status
[18:47:37 INF] Subscribed to site/+/ota/progress
[18:47:37 INF] Subscribed to site/+/ota/progress
[18:47:37 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:47:37 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:47:37 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:47:37 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:47:37 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:47:37 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:47:37 INF] Subscribed to farm/+/coord/+/pairing/request
[18:47:37 INF] Subscribed to farm/+/coord/+/pairing/request
[18:47:37 INF] Subscribed to farm/+/coord/+/pairing/status
[18:47:37 INF] Subscribed to farm/+/coord/+/pairing/status
[18:47:37 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:47:37 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:47:37 INF] TelemetryHandler subscribed to all telemetry topics
[18:47:37 INF] TelemetryHandler subscribed to all telemetry topics
[18:47:38 INF] PairingBackgroundService stopped
[18:47:38 INF] PairingBackgroundService stopped
[18:47:38 INF] TwinSyncBackgroundService stopped
[18:47:38 INF] TwinSyncBackgroundService stopped
  Passed IoT.Backend.IntegrationTests.Tests.TowerIntegrationTests.GetTowersByCoordinator_ShouldReturnAllForCoordinator [1 s]
  Standard Output Messages:
 Creating WebApplicationFactory...
 Backend is ready
 Test fixture initialized
 Disposing test fixture...


[18:47:38 INF] Starting IoT Backend on port 8000
[18:47:38 INF] Starting IoT Backend on port 8000
[18:47:38 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:47:38 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:47:38 INF] PairingBackgroundService starting
[18:47:38 INF] PairingBackgroundService starting
[18:47:38 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:47:38 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:47:38 INF] HTTP GET /health/live responded 200 in 2.0241 ms
[18:47:38 INF] HTTP GET /health/live responded 200 in 2.0241 ms
[18:47:38 INF] Connected to MQTT broker
[18:47:38 INF] Connected to MQTT broker
[18:47:38 INF] MQTT service started
[18:47:38 INF] MQTT service started
[18:47:39 INF] TelemetryHandler subscribing to MQTT topics
[18:47:39 INF] TelemetryHandler subscribing to MQTT topics
[18:47:39 INF] Subscribed to site/+/coord/+/telemetry
[18:47:39 INF] Subscribed to site/+/coord/+/telemetry
[18:47:39 INF] Subscribed to site/+/coord/+/status
[18:47:39 INF] Subscribed to site/+/coord/+/status
[18:47:39 INF] Subscribed to site/+/ota/progress
[18:47:39 INF] Subscribed to site/+/ota/progress
[18:47:39 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:47:39 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:47:39 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:47:39 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:47:39 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:47:39 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:47:39 INF] Subscribed to farm/+/coord/+/pairing/request
[18:47:39 INF] Subscribed to farm/+/coord/+/pairing/request
[18:47:39 INF] Subscribed to farm/+/coord/+/pairing/status
[18:47:39 INF] Subscribed to farm/+/coord/+/pairing/status
[18:47:39 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:47:39 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:47:39 INF] TelemetryHandler subscribed to all telemetry topics
[18:47:39 INF] TelemetryHandler subscribed to all telemetry topics
[18:47:39 INF] Set pump for tower tower-pump: on=True
[18:47:39 INF] Set pump for tower tower-pump: on=True
[18:47:39 INF] HTTP POST /api/towers/test-farm-pump/coord-pump/tower-pump/pump responded 202 in 7.1380 ms
[18:47:39 INF] HTTP POST /api/towers/test-farm-pump/coord-pump/tower-pump/pump responded 202 in 7.1380 ms
[18:47:39 INF] MQTT service stopped
[18:47:39 INF] MQTT service stopped
[18:47:39 INF] PairingBackgroundService stopped
[18:47:39 INF] PairingBackgroundService stopped
[18:47:39 INF] TwinSyncBackgroundService stopped
[18:47:39 INF] TwinSyncBackgroundService stopped
  Passed IoT.Backend.IntegrationTests.Tests.TowerIntegrationTests.SetPump_ShouldPublishPumpCommand [122 ms]
  Standard Output Messages:
 Creating WebApplicationFactory...
 Backend is ready
 Test fixture initialized
 MQTT Test Client connecting to host.docker.internal:54807 as test-device-26a1736f1ab54bcb8827f433c92e56bc...
 MQTT Test Client connected
 Subscribed to: farm/test-farm-pump/coord/coord-pump/tower/tower-pump/cmd
 Received message on: farm/test-farm-pump/coord/coord-pump/tower/tower-pump/cmd
 MQTT Test Client disconnected
 Disposing test fixture...


[18:47:39 INF] Starting IoT Backend on port 8000
[18:47:39 INF] Starting IoT Backend on port 8000
[18:47:39 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:47:39 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:47:39 INF] PairingBackgroundService starting
[18:47:39 INF] PairingBackgroundService starting
[18:47:39 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:47:39 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:47:39 INF] Connected to MQTT broker
[18:47:39 INF] Connected to MQTT broker
[18:47:40 INF] PairingBackgroundService stopped
[18:47:40 INF] PairingBackgroundService stopped
[18:47:40 INF] TwinSyncBackgroundService stopped
[18:47:40 INF] TwinSyncBackgroundService stopped
[18:47:40 INF] Starting IoT Backend on port 8000
[18:47:40 INF] Starting IoT Backend on port 8000
[18:47:40 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:47:40 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:47:40 INF] PairingBackgroundService starting
[18:47:40 INF] PairingBackgroundService starting
[18:47:40 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:47:40 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:47:40 INF] Connected to MQTT broker
[18:47:40 INF] Connected to MQTT broker
  Passed IoT.Backend.IntegrationTests.Tests.TowerIntegrationTests.GetLatestTelemetry_ShouldReturnMostRecent [917 ms]
  Standard Output Messages:
 Creating WebApplicationFactory...
 Backend is ready
 Test fixture initialized
 Disposing test fixture...


[18:47:41 INF] TelemetryHandler subscribing to MQTT topics
[18:47:41 INF] TelemetryHandler subscribing to MQTT topics
[18:47:41 INF] Subscribed to site/+/coord/+/telemetry
[18:47:41 INF] Subscribed to site/+/coord/+/telemetry
[18:47:41 INF] Subscribed to site/+/coord/+/status
[18:47:41 INF] Subscribed to site/+/coord/+/status
[18:47:41 INF] Subscribed to site/+/ota/progress
[18:47:41 INF] Subscribed to site/+/ota/progress
[18:47:41 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:47:41 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:47:41 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:47:41 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:47:41 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:47:41 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:47:41 INF] Subscribed to farm/+/coord/+/pairing/request
[18:47:41 INF] Subscribed to farm/+/coord/+/pairing/request
[18:47:41 INF] Subscribed to farm/+/coord/+/pairing/status
[18:47:41 INF] Subscribed to farm/+/coord/+/pairing/status
[18:47:41 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:47:41 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:47:41 INF] TelemetryHandler subscribed to all telemetry topics
[18:47:41 INF] TelemetryHandler subscribed to all telemetry topics
[18:47:43 INF] PairingBackgroundService stopped
[18:47:43 INF] PairingBackgroundService stopped
[18:47:43 INF] TwinSyncBackgroundService stopped
[18:47:43 INF] TwinSyncBackgroundService stopped
  Passed IoT.Backend.IntegrationTests.Tests.TowerIntegrationTests.UpsertTower_CreateNew_ShouldPersistToDatabase [1 s]
  Standard Output Messages:
 Creating WebApplicationFactory...
 Backend is ready
 Test fixture initialized
 Disposing test fixture...


[18:47:43 INF] Starting IoT Backend on port 8000
[18:47:43 INF] Starting IoT Backend on port 8000
[18:47:43 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:47:43 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:47:43 INF] PairingBackgroundService starting
[18:47:43 INF] PairingBackgroundService starting
[18:47:43 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:47:43 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:47:43 INF] Connected to MQTT broker
[18:47:43 INF] Connected to MQTT broker
[18:47:44 INF] TelemetryHandler subscribing to MQTT topics
[18:47:44 INF] TelemetryHandler subscribing to MQTT topics
[18:47:44 INF] Subscribed to site/+/coord/+/telemetry
[18:47:44 INF] Subscribed to site/+/coord/+/telemetry
[18:47:44 INF] Subscribed to site/+/coord/+/status
[18:47:44 INF] Subscribed to site/+/coord/+/status
[18:47:44 INF] Subscribed to site/+/ota/progress
[18:47:44 INF] Subscribed to site/+/ota/progress
[18:47:44 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:47:44 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:47:44 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:47:44 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:47:44 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:47:44 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:47:44 INF] Subscribed to farm/+/coord/+/pairing/request
[18:47:44 INF] Subscribed to farm/+/coord/+/pairing/request
[18:47:44 INF] Subscribed to farm/+/coord/+/pairing/status
[18:47:44 INF] Subscribed to farm/+/coord/+/pairing/status
[18:47:44 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:47:44 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:47:44 INF] TelemetryHandler subscribed to all telemetry topics
[18:47:44 INF] TelemetryHandler subscribed to all telemetry topics
[18:47:45 INF] PairingBackgroundService stopped
[18:47:45 INF] PairingBackgroundService stopped
[18:47:45 INF] TwinSyncBackgroundService stopped
[18:47:45 INF] TwinSyncBackgroundService stopped
  Passed IoT.Backend.IntegrationTests.Tests.TowerIntegrationTests.GetHeightMeasurements_WithSlotFilter_ShouldFilterBySlot [1 s]
  Standard Output Messages:
 Creating WebApplicationFactory...
 Backend is ready
 Test fixture initialized
 Disposing test fixture...


[18:47:45 INF] Starting IoT Backend on port 8000
[18:47:45 INF] Starting IoT Backend on port 8000
[18:47:45 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:47:45 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:47:45 INF] PairingBackgroundService starting
[18:47:45 INF] PairingBackgroundService starting
[18:47:45 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:47:45 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:47:45 INF] Connected to MQTT broker
[18:47:45 INF] Connected to MQTT broker
[18:47:46 INF] TelemetryHandler subscribing to MQTT topics
[18:47:46 INF] TelemetryHandler subscribing to MQTT topics
[18:47:46 INF] Subscribed to site/+/coord/+/telemetry
[18:47:46 INF] Subscribed to site/+/coord/+/telemetry
[18:47:46 INF] Subscribed to site/+/coord/+/status
[18:47:46 INF] Subscribed to site/+/coord/+/status
[18:47:46 INF] Subscribed to site/+/ota/progress
[18:47:46 INF] Subscribed to site/+/ota/progress
[18:47:46 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:47:46 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:47:46 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:47:46 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:47:46 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:47:46 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:47:46 INF] Subscribed to farm/+/coord/+/pairing/request
[18:47:46 INF] Subscribed to farm/+/coord/+/pairing/request
[18:47:46 INF] Subscribed to farm/+/coord/+/pairing/status
[18:47:46 INF] Subscribed to farm/+/coord/+/pairing/status
[18:47:46 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:47:46 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:47:46 INF] TelemetryHandler subscribed to all telemetry topics
[18:47:46 INF] TelemetryHandler subscribed to all telemetry topics
[18:47:46 INF] PairingBackgroundService stopped
[18:47:46 INF] PairingBackgroundService stopped
[18:47:46 INF] TwinSyncBackgroundService stopped
[18:47:46 INF] TwinSyncBackgroundService stopped
[18:47:46 INF] Starting IoT Backend on port 8000
[18:47:46 INF] Starting IoT Backend on port 8000
[18:47:46 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:47:46 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:47:46 INF] PairingBackgroundService starting
[18:47:46 INF] PairingBackgroundService starting
[18:47:46 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:47:46 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:47:46 INF] Connected to MQTT broker
[18:47:46 INF] Connected to MQTT broker
  Passed IoT.Backend.IntegrationTests.Tests.TowerIntegrationTests.SetCrop_ShouldResetHeightTracking [1 s]
  Standard Output Messages:
 Creating WebApplicationFactory...
 Backend is ready
 Test fixture initialized
 Disposing test fixture...


[18:47:47 INF] TelemetryHandler subscribing to MQTT topics
[18:47:47 INF] TelemetryHandler subscribing to MQTT topics
[18:47:47 INF] Subscribed to site/+/coord/+/telemetry
[18:47:47 INF] Subscribed to site/+/coord/+/telemetry
[18:47:47 INF] Subscribed to site/+/coord/+/status
[18:47:47 INF] Subscribed to site/+/coord/+/status
[18:47:47 INF] Subscribed to site/+/ota/progress
[18:47:47 INF] Subscribed to site/+/ota/progress
[18:47:47 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:47:47 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:47:47 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:47:47 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:47:47 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:47:47 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:47:47 INF] Subscribed to farm/+/coord/+/pairing/request
[18:47:47 INF] Subscribed to farm/+/coord/+/pairing/request
[18:47:47 INF] Subscribed to farm/+/coord/+/pairing/status
[18:47:47 INF] Subscribed to farm/+/coord/+/pairing/status
[18:47:47 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:47:47 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:47:47 INF] TelemetryHandler subscribed to all telemetry topics
[18:47:47 INF] TelemetryHandler subscribed to all telemetry topics
[18:47:48 INF] PairingBackgroundService stopped
[18:47:48 INF] PairingBackgroundService stopped
[18:47:48 INF] TwinSyncBackgroundService stopped
[18:47:48 INF] TwinSyncBackgroundService stopped
  Passed IoT.Backend.IntegrationTests.Tests.TowerIntegrationTests.GetTower_WhenExists_ShouldReturnTower [1 s]
  Standard Output Messages:
 Creating WebApplicationFactory...
 Backend is ready
 Test fixture initialized
 Disposing test fixture...


[18:47:48 INF] Starting IoT Backend on port 8000
[18:47:48 INF] Starting IoT Backend on port 8000
[18:47:48 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:47:48 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:47:48 INF] PairingBackgroundService starting
[18:47:48 INF] PairingBackgroundService starting
[18:47:48 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:47:48 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:47:48 INF] Connected to MQTT broker
[18:47:48 INF] Connected to MQTT broker
[18:47:49 INF] TelemetryHandler subscribing to MQTT topics
[18:47:49 INF] TelemetryHandler subscribing to MQTT topics
[18:47:49 INF] Subscribed to site/+/coord/+/telemetry
[18:47:49 INF] Subscribed to site/+/coord/+/telemetry
[18:47:49 INF] Subscribed to site/+/coord/+/status
[18:47:49 INF] Subscribed to site/+/coord/+/status
[18:47:49 INF] Subscribed to site/+/ota/progress
[18:47:49 INF] Subscribed to site/+/ota/progress
[18:47:49 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:47:49 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:47:49 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:47:49 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:47:49 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:47:49 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:47:49 INF] Subscribed to farm/+/coord/+/pairing/request
[18:47:49 INF] Subscribed to farm/+/coord/+/pairing/request
[18:47:49 INF] Subscribed to farm/+/coord/+/pairing/status
[18:47:49 INF] Subscribed to farm/+/coord/+/pairing/status
[18:47:49 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:47:49 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:47:49 INF] TelemetryHandler subscribed to all telemetry topics
[18:47:49 INF] TelemetryHandler subscribed to all telemetry topics
[18:47:50 INF] PairingBackgroundService stopped
[18:47:50 INF] PairingBackgroundService stopped
[18:47:50 INF] TwinSyncBackgroundService stopped
[18:47:50 INF] TwinSyncBackgroundService stopped
[18:47:50 INF] Starting IoT Backend on port 8000
[18:47:50 INF] Starting IoT Backend on port 8000
[18:47:50 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:47:50 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:47:50 INF] PairingBackgroundService starting
[18:47:50 INF] PairingBackgroundService starting
[18:47:50 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:47:50 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:47:50 INF] HTTP GET /health/live responded 200 in 2.1368 ms
[18:47:50 INF] HTTP GET /health/live responded 200 in 2.1368 ms
[18:47:50 INF] Connected to MQTT broker
[18:47:50 INF] Connected to MQTT broker
[18:47:50 INF] MQTT service started
[18:47:50 INF] MQTT service started
  Passed IoT.Backend.IntegrationTests.Tests.TowerIntegrationTests.SetCrop_ShouldUpdateTowerCropInfo [1 s]
  Standard Output Messages:
 Creating WebApplicationFactory...
 Backend is ready
 Test fixture initialized
 Disposing test fixture...


[18:47:51 INF] TelemetryHandler subscribing to MQTT topics
[18:47:51 INF] TelemetryHandler subscribing to MQTT topics
[18:47:51 INF] Subscribed to site/+/coord/+/telemetry
[18:47:51 INF] Subscribed to site/+/coord/+/telemetry
[18:47:51 INF] Subscribed to site/+/coord/+/status
[18:47:51 INF] Subscribed to site/+/coord/+/status
[18:47:51 INF] Subscribed to site/+/ota/progress
[18:47:51 INF] Subscribed to site/+/ota/progress
[18:47:51 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:47:51 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:47:51 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:47:51 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:47:51 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:47:51 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:47:51 INF] Subscribed to farm/+/coord/+/pairing/request
[18:47:51 INF] Subscribed to farm/+/coord/+/pairing/request
[18:47:51 INF] Subscribed to farm/+/coord/+/pairing/status
[18:47:51 INF] Subscribed to farm/+/coord/+/pairing/status
[18:47:51 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:47:51 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:47:51 INF] TelemetryHandler subscribed to all telemetry topics
[18:47:51 INF] TelemetryHandler subscribed to all telemetry topics
[18:47:51 INF] HTTP GET /api/towers/farm/test-farm-towers responded 200 in 14.1795 ms
[18:47:51 INF] HTTP GET /api/towers/farm/test-farm-towers responded 200 in 14.1795 ms
[18:47:51 INF] PairingBackgroundService stopped
[18:47:51 INF] PairingBackgroundService stopped
[18:47:51 INF] MQTT service stopped
[18:47:51 INF] MQTT service stopped
[18:47:51 INF] TwinSyncBackgroundService stopped
[18:47:51 INF] TwinSyncBackgroundService stopped
[18:47:51 INF] Starting IoT Backend on port 8000
[18:47:51 INF] Starting IoT Backend on port 8000
[18:47:51 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:47:51 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:47:51 INF] PairingBackgroundService starting
[18:47:51 INF] PairingBackgroundService starting
[18:47:51 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:47:51 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:47:51 INF] HTTP GET /health/live responded 200 in 1.9087 ms
[18:47:51 INF] HTTP GET /health/live responded 200 in 1.9087 ms
[18:47:51 INF] Connected to MQTT broker
[18:47:51 INF] Connected to MQTT broker
[18:47:51 INF] MQTT service started
[18:47:51 INF] MQTT service started
  Passed IoT.Backend.IntegrationTests.Tests.TowerIntegrationTests.GetTowersByFarm_ShouldReturnAllInFarm [1 s]
  Standard Output Messages:
 Creating WebApplicationFactory...
 Backend is ready
 Test fixture initialized
 Disposing test fixture...


[18:47:52 INF] TelemetryHandler subscribing to MQTT topics
[18:47:52 INF] TelemetryHandler subscribing to MQTT topics
[18:47:52 INF] Subscribed to site/+/coord/+/telemetry
[18:47:52 INF] Subscribed to site/+/coord/+/telemetry
[18:47:52 INF] Subscribed to site/+/coord/+/status
[18:47:52 INF] Subscribed to site/+/coord/+/status
[18:47:52 INF] Subscribed to site/+/ota/progress
[18:47:52 INF] Subscribed to site/+/ota/progress
[18:47:52 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:47:52 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:47:52 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:47:52 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:47:52 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:47:52 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:47:52 INF] Subscribed to farm/+/coord/+/pairing/request
[18:47:52 INF] Subscribed to farm/+/coord/+/pairing/request
[18:47:52 INF] Subscribed to farm/+/coord/+/pairing/status
[18:47:52 INF] Subscribed to farm/+/coord/+/pairing/status
[18:47:52 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:47:52 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:47:52 INF] TelemetryHandler subscribed to all telemetry topics
[18:47:52 INF] TelemetryHandler subscribed to all telemetry topics
[18:47:53 INF] HTTP POST /api/towers/nonexistent/nonexistent/nonexistent/crop responded 404 in 7.1537 ms
[18:47:53 INF] HTTP POST /api/towers/nonexistent/nonexistent/nonexistent/crop responded 404 in 7.1537 ms
[18:47:53 INF] MQTT service stopped
[18:47:53 INF] MQTT service stopped
[18:47:53 INF] PairingBackgroundService stopped
[18:47:53 INF] PairingBackgroundService stopped
[18:47:53 INF] TwinSyncBackgroundService stopped
[18:47:53 INF] TwinSyncBackgroundService stopped
[18:47:53 INF] Starting IoT Backend on port 8000
[18:47:53 INF] Starting IoT Backend on port 8000
[18:47:53 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:47:53 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:47:53 INF] PairingBackgroundService starting
[18:47:53 INF] PairingBackgroundService starting
[18:47:53 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:47:53 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:47:53 INF] Connected to MQTT broker
[18:47:53 INF] Connected to MQTT broker
  Passed IoT.Backend.IntegrationTests.Tests.TowerIntegrationTests.SetCrop_WhenTowerNotExists_ShouldReturnNotFound [10 ms]
  Standard Output Messages:
 Creating WebApplicationFactory...
 Backend is ready
 Test fixture initialized
 Disposing test fixture...


[18:47:54 INF] TelemetryHandler subscribing to MQTT topics
[18:47:54 INF] TelemetryHandler subscribing to MQTT topics
[18:47:54 INF] Subscribed to site/+/coord/+/telemetry
[18:47:54 INF] Subscribed to site/+/coord/+/telemetry
[18:47:54 INF] Subscribed to site/+/coord/+/status
[18:47:54 INF] Subscribed to site/+/coord/+/status
[18:47:54 INF] Subscribed to site/+/ota/progress
[18:47:54 INF] Subscribed to site/+/ota/progress
[18:47:54 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:47:54 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:47:54 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:47:54 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:47:54 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:47:54 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:47:54 INF] Subscribed to farm/+/coord/+/pairing/request
[18:47:54 INF] Subscribed to farm/+/coord/+/pairing/request
[18:47:54 INF] Subscribed to farm/+/coord/+/pairing/status
[18:47:54 INF] Subscribed to farm/+/coord/+/pairing/status
[18:47:54 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:47:54 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:47:54 INF] TelemetryHandler subscribed to all telemetry topics
[18:47:54 INF] TelemetryHandler subscribed to all telemetry topics
[18:47:54 INF] PairingBackgroundService stopped
[18:47:54 INF] PairingBackgroundService stopped
[18:47:54 INF] TwinSyncBackgroundService stopped
[18:47:54 INF] TwinSyncBackgroundService stopped
[18:47:54 INF] Starting IoT Backend on port 8000
[18:47:54 INF] Starting IoT Backend on port 8000
[18:47:54 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:47:54 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:47:54 INF] PairingBackgroundService starting
[18:47:54 INF] PairingBackgroundService starting
[18:47:54 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:47:54 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:47:54 INF] HTTP GET /health/live responded 200 in 2.3397 ms
[18:47:54 INF] HTTP GET /health/live responded 200 in 2.3397 ms
[18:47:54 INF] Connected to MQTT broker
[18:47:54 INF] Connected to MQTT broker
[18:47:54 INF] MQTT service started
[18:47:54 INF] MQTT service started
[18:47:54 INF] HTTP GET /api/twins/coordinators/nonexistent/delta responded 404 in 7.4545 ms
[18:47:54 INF] HTTP GET /api/twins/coordinators/nonexistent/delta responded 404 in 7.4545 ms
[18:47:54 INF] MQTT service stopped
[18:47:54 INF] PairingBackgroundService stopped
[18:47:54 INF] MQTT service stopped
[18:47:54 INF] PairingBackgroundService stopped
[18:47:54 INF] TwinSyncBackgroundService stopped
[18:47:54 INF] TwinSyncBackgroundService stopped
[18:47:54 INF] Starting IoT Backend on port 8000
[18:47:54 INF] Starting IoT Backend on port 8000
[18:47:54 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:47:54 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:47:54 INF] PairingBackgroundService starting
[18:47:54 INF] PairingBackgroundService starting
[18:47:54 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:47:54 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:47:54 INF] Connected to MQTT broker
[18:47:54 INF] Connected to MQTT broker
[18:47:54 INF] PairingBackgroundService stopped
[18:47:54 INF] PairingBackgroundService stopped
[18:47:54 INF] TwinSyncBackgroundService stopped
[18:47:54 INF] TwinSyncBackgroundService stopped
[18:47:54 INF] Starting IoT Backend on port 8000
[18:47:54 INF] Starting IoT Backend on port 8000
[18:47:54 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:47:54 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:47:54 INF] PairingBackgroundService starting
[18:47:54 INF] PairingBackgroundService starting
[18:47:54 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:47:54 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:47:54 INF] Connected to MQTT broker
[18:47:54 INF] Connected to MQTT broker
  Passed IoT.Backend.IntegrationTests.Tests.TowerIntegrationTests.GetHeightMeasurements_ShouldReturnAllForTower [1 s]
  Standard Output Messages:
 Creating WebApplicationFactory...
 Backend is ready
 Test fixture initialized
 Disposing test fixture...


  Passed IoT.Backend.IntegrationTests.Tests.TwinIntegrationTests.GetCoordinatorStateDelta_WhenNotExists_ShouldReturnNotFound [10 ms]
  Standard Output Messages:
 Creating WebApplicationFactory...
 Backend is ready
 Test fixture initialized
 Disposing test fixture...


  Passed IoT.Backend.IntegrationTests.Tests.TwinIntegrationTests.GetTowerStateDelta_WhenNotExists_ShouldReturnNotFound [10 ms]
  Standard Output Messages:
 Creating WebApplicationFactory...
 Backend is ready
 Test fixture initialized
 Disposing test fixture...


[18:47:55 INF] TelemetryHandler subscribing to MQTT topics
[18:47:55 INF] TelemetryHandler subscribing to MQTT topics
[18:47:55 INF] Subscribed to site/+/coord/+/telemetry
[18:47:55 INF] Subscribed to site/+/coord/+/telemetry
[18:47:55 INF] Subscribed to site/+/coord/+/status
[18:47:55 INF] Subscribed to site/+/coord/+/status
[18:47:55 INF] Subscribed to site/+/ota/progress
[18:47:55 INF] Subscribed to site/+/ota/progress
[18:47:55 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:47:55 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:47:55 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:47:55 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:47:55 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:47:55 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:47:55 INF] Subscribed to farm/+/coord/+/pairing/request
[18:47:55 INF] Subscribed to farm/+/coord/+/pairing/request
[18:47:55 INF] Subscribed to farm/+/coord/+/pairing/status
[18:47:55 INF] Subscribed to farm/+/coord/+/pairing/status
[18:47:55 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:47:55 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:47:55 INF] TelemetryHandler subscribed to all telemetry topics
[18:47:55 INF] TelemetryHandler subscribed to all telemetry topics
[18:47:57 INF] PairingBackgroundService stopped
[18:47:57 INF] PairingBackgroundService stopped
[18:47:57 INF] TwinSyncBackgroundService stopped
[18:47:57 INF] TwinSyncBackgroundService stopped
  Passed IoT.Backend.IntegrationTests.Tests.TwinIntegrationTests.GetCoordinatorStateDelta_WhenInSync_ShouldReturnIsInSyncTrue [3 s]
  Standard Output Messages:
 Creating WebApplicationFactory...
 Backend is ready
 Test fixture initialized
 Disposing test fixture...


[18:47:57 INF] Starting IoT Backend on port 8000
[18:47:57 INF] Starting IoT Backend on port 8000
[18:47:57 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:47:57 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:47:57 INF] PairingBackgroundService starting
[18:47:57 INF] PairingBackgroundService starting
[18:47:57 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:47:57 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:47:57 INF] Connected to MQTT broker
[18:47:57 INF] Connected to MQTT broker
[18:47:58 INF] TelemetryHandler subscribing to MQTT topics
[18:47:58 INF] TelemetryHandler subscribing to MQTT topics
[18:47:58 INF] Subscribed to site/+/coord/+/telemetry
[18:47:58 INF] Subscribed to site/+/coord/+/telemetry
[18:47:58 INF] Subscribed to site/+/coord/+/status
[18:47:58 INF] Subscribed to site/+/coord/+/status
[18:47:58 INF] Subscribed to site/+/ota/progress
[18:47:58 INF] Subscribed to site/+/ota/progress
[18:47:58 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:47:58 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:47:58 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:47:58 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:47:58 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:47:58 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:47:58 INF] Subscribed to farm/+/coord/+/pairing/request
[18:47:58 INF] Subscribed to farm/+/coord/+/pairing/request
[18:47:58 INF] Subscribed to farm/+/coord/+/pairing/status
[18:47:58 INF] Subscribed to farm/+/coord/+/pairing/status
[18:47:58 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:47:58 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:47:58 INF] TelemetryHandler subscribed to all telemetry topics
[18:47:58 INF] TelemetryHandler subscribed to all telemetry topics
[18:48:03 WRN] Failed to create indexes for twin collections (may already exist)
MongoDB.Driver.MongoCommandException: Command createIndexes failed: Index build failed: 9e621674-588b-4a43-9bc0-41ef84348251: Collection iot_test.coordinator_twins ( e38886b7-245d-4b69-814c-027903b07830 ) :: caused by :: Collection iot_test.coordinator_twins(e38886b7-245d-4b69-814c-027903b07830) is being dropped.
   at MongoDB.Driver.Core.WireProtocol.CommandUsingCommandMessageWireProtocol`1.ProcessResponse(ConnectionId connectionId, CommandMessage responseMessage)
   at MongoDB.Driver.Core.WireProtocol.CommandUsingCommandMessageWireProtocol`1.SendMessageAndProcessResponseAsync(CommandRequestMessage message, Int32 responseTo, IConnection connection, CancellationToken cancellationToken)
   at MongoDB.Driver.Core.WireProtocol.CommandUsingCommandMessageWireProtocol`1.ExecuteAsync(IConnection connection, CancellationToken cancellationToken)
   at MongoDB.Driver.Core.Servers.Server.ServerChannel.ExecuteProtocolAsync[TResult](IWireProtocol`1 protocol, ICoreSession session, CancellationToken cancellationToken)
   at MongoDB.Driver.Core.Operations.CommandOperationBase`1.ExecuteProtocolAsync(IChannelSource channelSource, ICoreSessionHandle session, ReadPreference readPreference, CancellationToken cancellationToken)
   at MongoDB.Driver.Core.Operations.WriteCommandOperation`1.ExecuteAsync(IWriteBinding binding, CancellationToken cancellationToken)
   at MongoDB.Driver.Core.Operations.CreateIndexesOperation.ExecuteAsync(IWriteBinding binding, CancellationToken cancellationToken)
   at MongoDB.Driver.OperationExecutor.ExecuteWriteOperationAsync[TResult](IWriteBinding binding, IWriteOperation`1 operation, CancellationToken cancellationToken)
   at MongoDB.Driver.MongoCollectionImpl`1.ExecuteWriteOperationAsync[TResult](IClientSessionHandle session, IWriteOperation`1 operation, CancellationToken cancellationToken)
   at MongoDB.Driver.MongoCollectionImpl`1.MongoIndexManager.CreateManyAsync(IClientSessionHandle session, IEnumerable`1 models, CreateManyIndexesOptions options, CancellationToken cancellationToken)
   at MongoDB.Driver.MongoCollectionImpl`1.UsingImplicitSessionAsync[TResult](Func`2 funcAsync, CancellationToken cancellationToken)
   at IoT.Backend.Repositories.TwinRepository.EnsureIndexesAsync() in /src/Backend/src/IoT.Backend/Repositories/TwinRepository.cs:line 65
[18:48:03 WRN] Failed to create indexes for twin collections (may already exist)
MongoDB.Driver.MongoCommandException: Command createIndexes failed: Index build failed: 9e621674-588b-4a43-9bc0-41ef84348251: Collection iot_test.coordinator_twins ( e38886b7-245d-4b69-814c-027903b07830 ) :: caused by :: Collection iot_test.coordinator_twins(e38886b7-245d-4b69-814c-027903b07830) is being dropped.
   at MongoDB.Driver.Core.WireProtocol.CommandUsingCommandMessageWireProtocol`1.ProcessResponse(ConnectionId connectionId, CommandMessage responseMessage)
   at MongoDB.Driver.Core.WireProtocol.CommandUsingCommandMessageWireProtocol`1.SendMessageAndProcessResponseAsync(CommandRequestMessage message, Int32 responseTo, IConnection connection, CancellationToken cancellationToken)
   at MongoDB.Driver.Core.WireProtocol.CommandUsingCommandMessageWireProtocol`1.ExecuteAsync(IConnection connection, CancellationToken cancellationToken)
   at MongoDB.Driver.Core.Servers.Server.ServerChannel.ExecuteProtocolAsync[TResult](IWireProtocol`1 protocol, ICoreSession session, CancellationToken cancellationToken)
   at MongoDB.Driver.Core.Operations.CommandOperationBase`1.ExecuteProtocolAsync(IChannelSource channelSource, ICoreSessionHandle session, ReadPreference readPreference, CancellationToken cancellationToken)
   at MongoDB.Driver.Core.Operations.WriteCommandOperation`1.ExecuteAsync(IWriteBinding binding, CancellationToken cancellationToken)
   at MongoDB.Driver.Core.Operations.CreateIndexesOperation.ExecuteAsync(IWriteBinding binding, CancellationToken cancellationToken)
   at MongoDB.Driver.OperationExecutor.ExecuteWriteOperationAsync[TResult](IWriteBinding binding, IWriteOperation`1 operation, CancellationToken cancellationToken)
   at MongoDB.Driver.MongoCollectionImpl`1.ExecuteWriteOperationAsync[TResult](IClientSessionHandle session, IWriteOperation`1 operation, CancellationToken cancellationToken)
   at MongoDB.Driver.MongoCollectionImpl`1.MongoIndexManager.CreateManyAsync(IClientSessionHandle session, IEnumerable`1 models, CreateManyIndexesOptions options, CancellationToken cancellationToken)
   at MongoDB.Driver.MongoCollectionImpl`1.UsingImplicitSessionAsync[TResult](Func`2 funcAsync, CancellationToken cancellationToken)
   at IoT.Backend.Repositories.TwinRepository.EnsureIndexesAsync() in /src/Backend/src/IoT.Backend/Repositories/TwinRepository.cs:line 65
[18:48:03 INF] PairingBackgroundService stopped
[18:48:03 INF] PairingBackgroundService stopped
[18:48:03 INF] TwinSyncBackgroundService stopped
[18:48:03 INF] TwinSyncBackgroundService stopped
  Passed IoT.Backend.IntegrationTests.Tests.TwinIntegrationTests.GetFarmTwins_WhenEmpty_ShouldReturnEmptyLists [20 ms]
  Standard Output Messages:
 Creating WebApplicationFactory...
 Backend is ready
 Test fixture initialized
 Disposing test fixture...


[18:48:03 INF] Starting IoT Backend on port 8000
[18:48:03 INF] Starting IoT Backend on port 8000
[18:48:03 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:48:03 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:48:03 INF] PairingBackgroundService starting
[18:48:03 INF] PairingBackgroundService starting
[18:48:03 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:48:03 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:48:03 INF] Connected to MQTT broker
[18:48:03 INF] Connected to MQTT broker
[18:48:01 INF] TelemetryHandler subscribing to MQTT topics
[18:48:01 INF] TelemetryHandler subscribing to MQTT topics
[18:48:01 INF] Subscribed to site/+/coord/+/telemetry
[18:48:01 INF] Subscribed to site/+/coord/+/telemetry
[18:48:01 INF] Subscribed to site/+/coord/+/status
[18:48:01 INF] Subscribed to site/+/coord/+/status
[18:48:01 INF] Subscribed to site/+/ota/progress
[18:48:01 INF] Subscribed to site/+/ota/progress
[18:48:01 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:48:01 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:48:01 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:48:01 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:48:01 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:48:01 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:48:01 INF] Subscribed to farm/+/coord/+/pairing/request
[18:48:01 INF] Subscribed to farm/+/coord/+/pairing/request
[18:48:01 INF] Subscribed to farm/+/coord/+/pairing/status
[18:48:01 INF] Subscribed to farm/+/coord/+/pairing/status
[18:48:01 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:48:01 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:48:01 INF] TelemetryHandler subscribed to all telemetry topics
[18:48:01 INF] TelemetryHandler subscribed to all telemetry topics
[18:48:02 INF] PairingBackgroundService stopped
[18:48:02 INF] PairingBackgroundService stopped
[18:48:02 INF] TwinSyncBackgroundService stopped
[18:48:02 INF] TwinSyncBackgroundService stopped
[18:48:02 INF] Starting IoT Backend on port 8000
[18:48:02 INF] Starting IoT Backend on port 8000
[18:48:02 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:48:02 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:48:02 INF] PairingBackgroundService starting
[18:48:02 INF] PairingBackgroundService starting
[18:48:02 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:48:02 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:48:02 INF] Connected to MQTT broker
[18:48:02 INF] Connected to MQTT broker
  Passed IoT.Backend.IntegrationTests.Tests.TwinIntegrationTests.GetCoordinatorTwins_ShouldReturnAllForFarm [294 ms]
  Standard Output Messages:
 Creating WebApplicationFactory...
 Backend is ready
 Test fixture initialized
 Disposing test fixture...


[18:48:03 INF] TelemetryHandler subscribing to MQTT topics
[18:48:03 INF] TelemetryHandler subscribing to MQTT topics
[18:48:03 INF] Subscribed to site/+/coord/+/telemetry
[18:48:03 INF] Subscribed to site/+/coord/+/telemetry
[18:48:03 INF] Subscribed to site/+/coord/+/status
[18:48:03 INF] Subscribed to site/+/coord/+/status
[18:48:03 INF] Subscribed to site/+/ota/progress
[18:48:03 INF] Subscribed to site/+/ota/progress
[18:48:03 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:48:03 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:48:03 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:48:03 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:48:03 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:48:03 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:48:03 INF] Subscribed to farm/+/coord/+/pairing/request
[18:48:03 INF] Subscribed to farm/+/coord/+/pairing/request
[18:48:03 INF] Subscribed to farm/+/coord/+/pairing/status
[18:48:03 INF] Subscribed to farm/+/coord/+/pairing/status
[18:48:03 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:48:03 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:48:03 INF] TelemetryHandler subscribed to all telemetry topics
[18:48:03 INF] TelemetryHandler subscribed to all telemetry topics
[18:48:08 INF] PairingBackgroundService stopped
[18:48:08 INF] PairingBackgroundService stopped
[18:48:08 INF] TwinSyncBackgroundService stopped
[18:48:08 INF] TwinSyncBackgroundService stopped
  Passed IoT.Backend.IntegrationTests.Tests.TwinIntegrationTests.GetTowerStateDelta_WhenInSync_ShouldReturnIsInSyncTrue [116 ms]
  Standard Output Messages:
 Creating WebApplicationFactory...
 Backend is ready
 Test fixture initialized
 Disposing test fixture...


[18:48:08 INF] Starting IoT Backend on port 8000
[18:48:08 INF] Starting IoT Backend on port 8000
[18:48:08 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:48:08 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:48:08 INF] PairingBackgroundService starting
[18:48:08 INF] PairingBackgroundService starting
[18:48:08 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:48:08 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:48:08 INF] Connected to MQTT broker
[18:48:08 INF] Connected to MQTT broker
[18:48:09 INF] TelemetryHandler subscribing to MQTT topics
[18:48:09 INF] TelemetryHandler subscribing to MQTT topics
[18:48:09 INF] Subscribed to site/+/coord/+/telemetry
[18:48:09 INF] Subscribed to site/+/coord/+/telemetry
[18:48:09 INF] Subscribed to site/+/coord/+/status
[18:48:09 INF] Subscribed to site/+/coord/+/status
[18:48:09 INF] Subscribed to site/+/ota/progress
[18:48:09 INF] Subscribed to site/+/ota/progress
[18:48:09 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:48:09 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:48:09 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:48:09 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:48:09 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:48:09 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:48:09 INF] Subscribed to farm/+/coord/+/pairing/request
[18:48:09 INF] Subscribed to farm/+/coord/+/pairing/request
[18:48:09 INF] Subscribed to farm/+/coord/+/pairing/status
[18:48:09 INF] Subscribed to farm/+/coord/+/pairing/status
[18:48:09 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:48:09 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:48:09 INF] TelemetryHandler subscribed to all telemetry topics
[18:48:09 INF] TelemetryHandler subscribed to all telemetry topics
[18:48:09 INF] PairingBackgroundService stopped
[18:48:09 INF] PairingBackgroundService stopped
[18:48:09 INF] TwinSyncBackgroundService stopped
[18:48:09 INF] TwinSyncBackgroundService stopped
[18:48:09 INF] Starting IoT Backend on port 8000
[18:48:09 INF] Starting IoT Backend on port 8000
[18:48:09 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:48:09 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:48:09 INF] PairingBackgroundService starting
[18:48:09 INF] PairingBackgroundService starting
[18:48:09 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:48:09 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:48:09 INF] HTTP GET /health/live responded 200 in 2.2575 ms
[18:48:09 INF] HTTP GET /health/live responded 200 in 2.2575 ms
[18:48:09 INF] Connected to MQTT broker
[18:48:09 INF] Connected to MQTT broker
[18:48:09 INF] MQTT service started
[18:48:09 INF] MQTT service started
[18:48:09 INF] HTTP GET /api/twins/coordinators/nonexistent-coord responded 404 in 6.1179 ms
[18:48:09 INF] HTTP GET /api/twins/coordinators/nonexistent-coord responded 404 in 6.1179 ms
[18:48:09 INF] MQTT service stopped
[18:48:09 INF] MQTT service stopped
[18:48:09 INF] PairingBackgroundService stopped
[18:48:09 INF] PairingBackgroundService stopped
[18:48:09 INF] TwinSyncBackgroundService stopped
[18:48:09 INF] TwinSyncBackgroundService stopped
[18:48:10 INF] Starting IoT Backend on port 8000
[18:48:10 INF] Starting IoT Backend on port 8000
[18:48:10 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:48:10 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:48:10 INF] PairingBackgroundService starting
[18:48:10 INF] PairingBackgroundService starting
[18:48:10 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:48:10 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:48:10 INF] Connected to MQTT broker
[18:48:10 INF] Connected to MQTT broker
  Passed IoT.Backend.IntegrationTests.Tests.TwinIntegrationTests.GetCoordinatorTwins_WithoutFarmId_ShouldReturnBadRequest [11 ms]
  Standard Output Messages:
 Creating WebApplicationFactory...
 Backend is ready
 Test fixture initialized
 Disposing test fixture...


  Passed IoT.Backend.IntegrationTests.Tests.TwinIntegrationTests.GetCoordinatorTwin_WhenNotExists_ShouldReturnNotFound [9 ms]
  Standard Output Messages:
 Creating WebApplicationFactory...
 Backend is ready
 Test fixture initialized
 Disposing test fixture...


[18:48:11 INF] TelemetryHandler subscribing to MQTT topics
[18:48:11 INF] TelemetryHandler subscribing to MQTT topics
[18:48:11 INF] Subscribed to site/+/coord/+/telemetry
[18:48:11 INF] Subscribed to site/+/coord/+/telemetry
[18:48:11 INF] Subscribed to site/+/coord/+/status
[18:48:11 INF] Subscribed to site/+/coord/+/status
[18:48:11 INF] Subscribed to site/+/ota/progress
[18:48:11 INF] Subscribed to site/+/ota/progress
[18:48:11 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:48:11 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:48:11 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:48:11 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:48:11 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:48:11 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:48:11 INF] Subscribed to farm/+/coord/+/pairing/request
[18:48:11 INF] Subscribed to farm/+/coord/+/pairing/request
[18:48:11 INF] Subscribed to farm/+/coord/+/pairing/status
[18:48:11 INF] Subscribed to farm/+/coord/+/pairing/status
[18:48:11 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:48:11 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:48:11 INF] TelemetryHandler subscribed to all telemetry topics
[18:48:11 INF] TelemetryHandler subscribed to all telemetry topics
[18:48:13 INF] Setting desired state for tower tower-desired
[18:48:13 INF] Setting desired state for tower tower-desired
[18:48:13 INF] Published command to tower tower-desired on topic hydro/farm-desired/coord-desired/tower/tower-desired/cmd
[18:48:13 INF] Published command to tower tower-desired on topic hydro/farm-desired/coord-desired/tower/tower-desired/cmd
[18:48:13 INF] PairingBackgroundService stopped
[18:48:13 INF] PairingBackgroundService stopped
[18:48:13 INF] TwinSyncBackgroundService stopped
[18:48:13 INF] TwinSyncBackgroundService stopped
  Passed IoT.Backend.IntegrationTests.Tests.TwinIntegrationTests.SetTowerDesiredState_ShouldPersistAndReturnAccepted [3 s]
  Standard Output Messages:
 Creating WebApplicationFactory...
 Backend is ready
 Test fixture initialized
 Disposing test fixture...


[18:48:13 INF] Starting IoT Backend on port 8000
[18:48:13 INF] Starting IoT Backend on port 8000
[18:48:13 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:48:13 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:48:13 INF] PairingBackgroundService starting
[18:48:13 INF] PairingBackgroundService starting
[18:48:13 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:48:13 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:48:13 WRN] Cannot publish to hydro/farm-desired/coord-desired/tower/tower-desired/cmd: not connected
[18:48:13 WRN] Cannot publish to hydro/farm-desired/coord-desired/tower/tower-desired/cmd: not connected
[18:48:13 INF] Published command to tower tower-desired on topic hydro/farm-desired/coord-desired/tower/tower-desired/cmd
[18:48:13 INF] Published command to tower tower-desired on topic hydro/farm-desired/coord-desired/tower/tower-desired/cmd
[18:48:13 INF] Connected to MQTT broker
[18:48:13 INF] Connected to MQTT broker
[18:48:14 INF] TelemetryHandler subscribing to MQTT topics
[18:48:14 INF] TelemetryHandler subscribing to MQTT topics
[18:48:14 INF] Subscribed to site/+/coord/+/telemetry
[18:48:14 INF] Subscribed to site/+/coord/+/telemetry
[18:48:14 INF] Subscribed to site/+/coord/+/status
[18:48:14 INF] Subscribed to site/+/coord/+/status
[18:48:14 INF] Subscribed to site/+/ota/progress
[18:48:14 INF] Subscribed to site/+/ota/progress
[18:48:14 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:48:14 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:48:14 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:48:14 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:48:14 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:48:14 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:48:14 INF] Subscribed to farm/+/coord/+/pairing/request
[18:48:14 INF] Subscribed to farm/+/coord/+/pairing/request
[18:48:14 INF] Subscribed to farm/+/coord/+/pairing/status
[18:48:14 INF] Subscribed to farm/+/coord/+/pairing/status
[18:48:14 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:48:14 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:48:14 INF] TelemetryHandler subscribed to all telemetry topics
[18:48:14 INF] TelemetryHandler subscribed to all telemetry topics
[18:48:17 INF] PairingBackgroundService stopped
[18:48:17 INF] PairingBackgroundService stopped
[18:48:17 INF] TwinSyncBackgroundService stopped
[18:48:17 INF] TwinSyncBackgroundService stopped
  Passed IoT.Backend.IntegrationTests.Tests.TwinIntegrationTests.GetTowerTwin_WhenExists_ShouldReturnTwin [1 s]
  Standard Output Messages:
 Creating WebApplicationFactory...
 Backend is ready
 Test fixture initialized
 Disposing test fixture...


[18:48:17 INF] Starting IoT Backend on port 8000
[18:48:17 INF] Starting IoT Backend on port 8000
[18:48:17 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:48:17 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:48:17 INF] PairingBackgroundService starting
[18:48:17 INF] PairingBackgroundService starting
[18:48:17 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:48:17 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:48:17 INF] HTTP GET /health/live responded 200 in 2.2623 ms
[18:48:17 INF] HTTP GET /health/live responded 200 in 2.2623 ms
[18:48:17 INF] Connected to MQTT broker
[18:48:17 INF] Connected to MQTT broker
[18:48:17 INF] MQTT service started
[18:48:17 INF] MQTT service started
[18:48:18 INF] TelemetryHandler subscribing to MQTT topics
[18:48:18 INF] TelemetryHandler subscribing to MQTT topics
[18:48:18 INF] Subscribed to site/+/coord/+/telemetry
[18:48:18 INF] Subscribed to site/+/coord/+/telemetry
[18:48:18 INF] Subscribed to site/+/coord/+/status
[18:48:18 INF] Subscribed to site/+/coord/+/status
[18:48:18 INF] Subscribed to site/+/ota/progress
[18:48:18 INF] Subscribed to site/+/ota/progress
[18:48:18 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:48:18 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:48:18 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:48:18 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:48:18 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:48:18 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:48:18 INF] Subscribed to farm/+/coord/+/pairing/request
[18:48:18 INF] Subscribed to farm/+/coord/+/pairing/request
[18:48:18 INF] Subscribed to farm/+/coord/+/pairing/status
[18:48:18 INF] Subscribed to farm/+/coord/+/pairing/status
[18:48:18 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:48:18 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:48:18 INF] TelemetryHandler subscribed to all telemetry topics
[18:48:18 INF] TelemetryHandler subscribed to all telemetry topics
[18:48:21 WRN] Failed to create indexes for twin collections (may already exist)
MongoDB.Driver.MongoCommandException: Command createIndexes failed: Index build failed: 2ee6686e-55f4-424d-9b74-8754c7bc7a86: Collection iot_test.tower_twins ( e7eb71fe-1b87-4dbb-8260-5b3f5b5f4b18 ) :: caused by :: Collection iot_test.tower_twins(e7eb71fe-1b87-4dbb-8260-5b3f5b5f4b18) is being dropped.
   at MongoDB.Driver.Core.WireProtocol.CommandUsingCommandMessageWireProtocol`1.ProcessResponse(ConnectionId connectionId, CommandMessage responseMessage)
   at MongoDB.Driver.Core.WireProtocol.CommandUsingCommandMessageWireProtocol`1.SendMessageAndProcessResponseAsync(CommandRequestMessage message, Int32 responseTo, IConnection connection, CancellationToken cancellationToken)
   at MongoDB.Driver.Core.WireProtocol.CommandUsingCommandMessageWireProtocol`1.ExecuteAsync(IConnection connection, CancellationToken cancellationToken)
   at MongoDB.Driver.Core.Servers.Server.ServerChannel.ExecuteProtocolAsync[TResult](IWireProtocol`1 protocol, ICoreSession session, CancellationToken cancellationToken)
   at MongoDB.Driver.Core.Operations.CommandOperationBase`1.ExecuteProtocolAsync(IChannelSource channelSource, ICoreSessionHandle session, ReadPreference readPreference, CancellationToken cancellationToken)
   at MongoDB.Driver.Core.Operations.WriteCommandOperation`1.ExecuteAsync(IWriteBinding binding, CancellationToken cancellationToken)
   at MongoDB.Driver.Core.Operations.CreateIndexesOperation.ExecuteAsync(IWriteBinding binding, CancellationToken cancellationToken)
   at MongoDB.Driver.OperationExecutor.ExecuteWriteOperationAsync[TResult](IWriteBinding binding, IWriteOperation`1 operation, CancellationToken cancellationToken)
   at MongoDB.Driver.MongoCollectionImpl`1.ExecuteWriteOperationAsync[TResult](IClientSessionHandle session, IWriteOperation`1 operation, CancellationToken cancellationToken)
   at MongoDB.Driver.MongoCollectionImpl`1.MongoIndexManager.CreateManyAsync(IClientSessionHandle session, IEnumerable`1 models, CreateManyIndexesOptions options, CancellationToken cancellationToken)
   at MongoDB.Driver.MongoCollectionImpl`1.UsingImplicitSessionAsync[TResult](Func`2 funcAsync, CancellationToken cancellationToken)
   at IoT.Backend.Repositories.TwinRepository.EnsureIndexesAsync() in /src/Backend/src/IoT.Backend/Repositories/TwinRepository.cs:line 49
[18:48:21 WRN] Failed to create indexes for twin collections (may already exist)
MongoDB.Driver.MongoCommandException: Command createIndexes failed: Index build failed: 2ee6686e-55f4-424d-9b74-8754c7bc7a86: Collection iot_test.tower_twins ( e7eb71fe-1b87-4dbb-8260-5b3f5b5f4b18 ) :: caused by :: Collection iot_test.tower_twins(e7eb71fe-1b87-4dbb-8260-5b3f5b5f4b18) is being dropped.
   at MongoDB.Driver.Core.WireProtocol.CommandUsingCommandMessageWireProtocol`1.ProcessResponse(ConnectionId connectionId, CommandMessage responseMessage)
   at MongoDB.Driver.Core.WireProtocol.CommandUsingCommandMessageWireProtocol`1.SendMessageAndProcessResponseAsync(CommandRequestMessage message, Int32 responseTo, IConnection connection, CancellationToken cancellationToken)
   at MongoDB.Driver.Core.WireProtocol.CommandUsingCommandMessageWireProtocol`1.ExecuteAsync(IConnection connection, CancellationToken cancellationToken)
   at MongoDB.Driver.Core.Servers.Server.ServerChannel.ExecuteProtocolAsync[TResult](IWireProtocol`1 protocol, ICoreSession session, CancellationToken cancellationToken)
   at MongoDB.Driver.Core.Operations.CommandOperationBase`1.ExecuteProtocolAsync(IChannelSource channelSource, ICoreSessionHandle session, ReadPreference readPreference, CancellationToken cancellationToken)
   at MongoDB.Driver.Core.Operations.WriteCommandOperation`1.ExecuteAsync(IWriteBinding binding, CancellationToken cancellationToken)
   at MongoDB.Driver.Core.Operations.CreateIndexesOperation.ExecuteAsync(IWriteBinding binding, CancellationToken cancellationToken)
   at MongoDB.Driver.OperationExecutor.ExecuteWriteOperationAsync[TResult](IWriteBinding binding, IWriteOperation`1 operation, CancellationToken cancellationToken)
   at MongoDB.Driver.MongoCollectionImpl`1.ExecuteWriteOperationAsync[TResult](IClientSessionHandle session, IWriteOperation`1 operation, CancellationToken cancellationToken)
   at MongoDB.Driver.MongoCollectionImpl`1.MongoIndexManager.CreateManyAsync(IClientSessionHandle session, IEnumerable`1 models, CreateManyIndexesOptions options, CancellationToken cancellationToken)
   at MongoDB.Driver.MongoCollectionImpl`1.UsingImplicitSessionAsync[TResult](Func`2 funcAsync, CancellationToken cancellationToken)
   at IoT.Backend.Repositories.TwinRepository.EnsureIndexesAsync() in /src/Backend/src/IoT.Backend/Repositories/TwinRepository.cs:line 49
[18:48:22 WRN] Failed to create indexes for twin collections (may already exist)
MongoDB.Driver.MongoCommandException: Command createIndexes failed: Index build failed: 0da62621-fb94-411c-9df6-04dd452d0617: Collection iot_test.tower_twins ( e7eb71fe-1b87-4dbb-8260-5b3f5b5f4b18 ) :: caused by :: Collection iot_test.tower_twins(e7eb71fe-1b87-4dbb-8260-5b3f5b5f4b18) is being dropped.
   at MongoDB.Driver.Core.WireProtocol.CommandUsingCommandMessageWireProtocol`1.ProcessResponse(ConnectionId connectionId, CommandMessage responseMessage)
   at MongoDB.Driver.Core.WireProtocol.CommandUsingCommandMessageWireProtocol`1.SendMessageAndProcessResponseAsync(CommandRequestMessage message, Int32 responseTo, IConnection connection, CancellationToken cancellationToken)
   at MongoDB.Driver.Core.WireProtocol.CommandUsingCommandMessageWireProtocol`1.ExecuteAsync(IConnection connection, CancellationToken cancellationToken)
   at MongoDB.Driver.Core.Servers.Server.ServerChannel.ExecuteProtocolAsync[TResult](IWireProtocol`1 protocol, ICoreSession session, CancellationToken cancellationToken)
   at MongoDB.Driver.Core.Operations.CommandOperationBase`1.ExecuteProtocolAsync(IChannelSource channelSource, ICoreSessionHandle session, ReadPreference readPreference, CancellationToken cancellationToken)
   at MongoDB.Driver.Core.Operations.WriteCommandOperation`1.ExecuteAsync(IWriteBinding binding, CancellationToken cancellationToken)
   at MongoDB.Driver.Core.Operations.CreateIndexesOperation.ExecuteAsync(IWriteBinding binding, CancellationToken cancellationToken)
   at MongoDB.Driver.OperationExecutor.ExecuteWriteOperationAsync[TResult](IWriteBinding binding, IWriteOperation`1 operation, CancellationToken cancellationToken)
   at MongoDB.Driver.MongoCollectionImpl`1.ExecuteWriteOperationAsync[TResult](IClientSessionHandle session, IWriteOperation`1 operation, CancellationToken cancellationToken)
   at MongoDB.Driver.MongoCollectionImpl`1.MongoIndexManager.CreateManyAsync(IClientSessionHandle session, IEnumerable`1 models, CreateManyIndexesOptions options, CancellationToken cancellationToken)
   at MongoDB.Driver.MongoCollectionImpl`1.UsingImplicitSessionAsync[TResult](Func`2 funcAsync, CancellationToken cancellationToken)
   at IoT.Backend.Repositories.TwinRepository.EnsureIndexesAsync() in /src/Backend/src/IoT.Backend/Repositories/TwinRepository.cs:line 49
[18:48:22 WRN] Failed to create indexes for twin collections (may already exist)
MongoDB.Driver.MongoCommandException: Command createIndexes failed: Index build failed: 0da62621-fb94-411c-9df6-04dd452d0617: Collection iot_test.tower_twins ( e7eb71fe-1b87-4dbb-8260-5b3f5b5f4b18 ) :: caused by :: Collection iot_test.tower_twins(e7eb71fe-1b87-4dbb-8260-5b3f5b5f4b18) is being dropped.
   at MongoDB.Driver.Core.WireProtocol.CommandUsingCommandMessageWireProtocol`1.ProcessResponse(ConnectionId connectionId, CommandMessage responseMessage)
   at MongoDB.Driver.Core.WireProtocol.CommandUsingCommandMessageWireProtocol`1.SendMessageAndProcessResponseAsync(CommandRequestMessage message, Int32 responseTo, IConnection connection, CancellationToken cancellationToken)
   at MongoDB.Driver.Core.WireProtocol.CommandUsingCommandMessageWireProtocol`1.ExecuteAsync(IConnection connection, CancellationToken cancellationToken)
   at MongoDB.Driver.Core.Servers.Server.ServerChannel.ExecuteProtocolAsync[TResult](IWireProtocol`1 protocol, ICoreSession session, CancellationToken cancellationToken)
   at MongoDB.Driver.Core.Operations.CommandOperationBase`1.ExecuteProtocolAsync(IChannelSource channelSource, ICoreSessionHandle session, ReadPreference readPreference, CancellationToken cancellationToken)
   at MongoDB.Driver.Core.Operations.WriteCommandOperation`1.ExecuteAsync(IWriteBinding binding, CancellationToken cancellationToken)
   at MongoDB.Driver.Core.Operations.CreateIndexesOperation.ExecuteAsync(IWriteBinding binding, CancellationToken cancellationToken)
   at MongoDB.Driver.OperationExecutor.ExecuteWriteOperationAsync[TResult](IWriteBinding binding, IWriteOperation`1 operation, CancellationToken cancellationToken)
   at MongoDB.Driver.MongoCollectionImpl`1.ExecuteWriteOperationAsync[TResult](IClientSessionHandle session, IWriteOperation`1 operation, CancellationToken cancellationToken)
   at MongoDB.Driver.MongoCollectionImpl`1.MongoIndexManager.CreateManyAsync(IClientSessionHandle session, IEnumerable`1 models, CreateManyIndexesOptions options, CancellationToken cancellationToken)
   at MongoDB.Driver.MongoCollectionImpl`1.UsingImplicitSessionAsync[TResult](Func`2 funcAsync, CancellationToken cancellationToken)
   at IoT.Backend.Repositories.TwinRepository.EnsureIndexesAsync() in /src/Backend/src/IoT.Backend/Repositories/TwinRepository.cs:line 49
[18:48:23 WRN] Failed to create indexes for twin collections (may already exist)
MongoDB.Driver.MongoCommandException: Command createIndexes failed: Index build failed: c58ad8cf-bcb1-4818-833f-b7543d688ed2: Collection iot_test.tower_twins ( e7eb71fe-1b87-4dbb-8260-5b3f5b5f4b18 ) :: caused by :: Collection iot_test.tower_twins(e7eb71fe-1b87-4dbb-8260-5b3f5b5f4b18) is being dropped.
   at MongoDB.Driver.Core.WireProtocol.CommandUsingCommandMessageWireProtocol`1.ProcessResponse(ConnectionId connectionId, CommandMessage responseMessage)
   at MongoDB.Driver.Core.WireProtocol.CommandUsingCommandMessageWireProtocol`1.SendMessageAndProcessResponseAsync(CommandRequestMessage message, Int32 responseTo, IConnection connection, CancellationToken cancellationToken)
   at MongoDB.Driver.Core.WireProtocol.CommandUsingCommandMessageWireProtocol`1.ExecuteAsync(IConnection connection, CancellationToken cancellationToken)
   at MongoDB.Driver.Core.Servers.Server.ServerChannel.ExecuteProtocolAsync[TResult](IWireProtocol`1 protocol, ICoreSession session, CancellationToken cancellationToken)
   at MongoDB.Driver.Core.Operations.CommandOperationBase`1.ExecuteProtocolAsync(IChannelSource channelSource, ICoreSessionHandle session, ReadPreference readPreference, CancellationToken cancellationToken)
   at MongoDB.Driver.Core.Operations.WriteCommandOperation`1.ExecuteAsync(IWriteBinding binding, CancellationToken cancellationToken)
   at MongoDB.Driver.Core.Operations.CreateIndexesOperation.ExecuteAsync(IWriteBinding binding, CancellationToken cancellationToken)
   at MongoDB.Driver.OperationExecutor.ExecuteWriteOperationAsync[TResult](IWriteBinding binding, IWriteOperation`1 operation, CancellationToken cancellationToken)
   at MongoDB.Driver.MongoCollectionImpl`1.ExecuteWriteOperationAsync[TResult](IClientSessionHandle session, IWriteOperation`1 operation, CancellationToken cancellationToken)
   at MongoDB.Driver.MongoCollectionImpl`1.MongoIndexManager.CreateManyAsync(IClientSessionHandle session, IEnumerable`1 models, CreateManyIndexesOptions options, CancellationToken cancellationToken)
   at MongoDB.Driver.MongoCollectionImpl`1.UsingImplicitSessionAsync[TResult](Func`2 funcAsync, CancellationToken cancellationToken)
   at IoT.Backend.Repositories.TwinRepository.EnsureIndexesAsync() in /src/Backend/src/IoT.Backend/Repositories/TwinRepository.cs:line 49
[18:48:23 WRN] Failed to create indexes for twin collections (may already exist)
MongoDB.Driver.MongoCommandException: Command createIndexes failed: Index build failed: c58ad8cf-bcb1-4818-833f-b7543d688ed2: Collection iot_test.tower_twins ( e7eb71fe-1b87-4dbb-8260-5b3f5b5f4b18 ) :: caused by :: Collection iot_test.tower_twins(e7eb71fe-1b87-4dbb-8260-5b3f5b5f4b18) is being dropped.
   at MongoDB.Driver.Core.WireProtocol.CommandUsingCommandMessageWireProtocol`1.ProcessResponse(ConnectionId connectionId, CommandMessage responseMessage)
   at MongoDB.Driver.Core.WireProtocol.CommandUsingCommandMessageWireProtocol`1.SendMessageAndProcessResponseAsync(CommandRequestMessage message, Int32 responseTo, IConnection connection, CancellationToken cancellationToken)
   at MongoDB.Driver.Core.WireProtocol.CommandUsingCommandMessageWireProtocol`1.ExecuteAsync(IConnection connection, CancellationToken cancellationToken)
   at MongoDB.Driver.Core.Servers.Server.ServerChannel.ExecuteProtocolAsync[TResult](IWireProtocol`1 protocol, ICoreSession session, CancellationToken cancellationToken)
   at MongoDB.Driver.Core.Operations.CommandOperationBase`1.ExecuteProtocolAsync(IChannelSource channelSource, ICoreSessionHandle session, ReadPreference readPreference, CancellationToken cancellationToken)
   at MongoDB.Driver.Core.Operations.WriteCommandOperation`1.ExecuteAsync(IWriteBinding binding, CancellationToken cancellationToken)
   at MongoDB.Driver.Core.Operations.CreateIndexesOperation.ExecuteAsync(IWriteBinding binding, CancellationToken cancellationToken)
   at MongoDB.Driver.OperationExecutor.ExecuteWriteOperationAsync[TResult](IWriteBinding binding, IWriteOperation`1 operation, CancellationToken cancellationToken)
   at MongoDB.Driver.MongoCollectionImpl`1.ExecuteWriteOperationAsync[TResult](IClientSessionHandle session, IWriteOperation`1 operation, CancellationToken cancellationToken)
   at MongoDB.Driver.MongoCollectionImpl`1.MongoIndexManager.CreateManyAsync(IClientSessionHandle session, IEnumerable`1 models, CreateManyIndexesOptions options, CancellationToken cancellationToken)
   at MongoDB.Driver.MongoCollectionImpl`1.UsingImplicitSessionAsync[TResult](Func`2 funcAsync, CancellationToken cancellationToken)
   at IoT.Backend.Repositories.TwinRepository.EnsureIndexesAsync() in /src/Backend/src/IoT.Backend/Repositories/TwinRepository.cs:line 49
[18:48:23 INF] HTTP GET /api/twins/towers/tower-pending/delta responded 200 in 8.5315 ms
[18:48:23 INF] HTTP GET /api/twins/towers/tower-pending/delta responded 200 in 8.5315 ms
[18:48:23 INF] MQTT service stopped
[18:48:23 INF] MQTT service stopped
[18:48:23 INF] PairingBackgroundService stopped
[18:48:23 INF] PairingBackgroundService stopped
[18:48:23 INF] TwinSyncBackgroundService stopped
[18:48:23 INF] TwinSyncBackgroundService stopped
  Passed IoT.Backend.IntegrationTests.Tests.TwinIntegrationTests.TowerTwin_WithPendingStatus_ShouldReflectInDelta [472 ms]
  Standard Output Messages:
 Creating WebApplicationFactory...
 Backend is ready
 Test fixture initialized
 Disposing test fixture...


[18:48:23 INF] Starting IoT Backend on port 8000
[18:48:23 INF] Starting IoT Backend on port 8000
[18:48:23 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:48:23 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:48:23 INF] PairingBackgroundService starting
[18:48:23 INF] PairingBackgroundService starting
[18:48:23 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:48:23 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:48:23 INF] Connected to MQTT broker
[18:48:23 INF] Connected to MQTT broker
[18:48:24 INF] TelemetryHandler subscribing to MQTT topics
[18:48:24 INF] TelemetryHandler subscribing to MQTT topics
[18:48:24 INF] Subscribed to site/+/coord/+/telemetry
[18:48:24 INF] Subscribed to site/+/coord/+/telemetry
[18:48:24 INF] Subscribed to site/+/coord/+/status
[18:48:24 INF] Subscribed to site/+/coord/+/status
[18:48:24 INF] Subscribed to site/+/ota/progress
[18:48:24 INF] Subscribed to site/+/ota/progress
[18:48:24 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:48:24 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:48:24 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:48:24 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:48:24 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:48:24 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:48:24 INF] Subscribed to farm/+/coord/+/pairing/request
[18:48:24 INF] Subscribed to farm/+/coord/+/pairing/request
[18:48:24 INF] Subscribed to farm/+/coord/+/pairing/status
[18:48:24 INF] Subscribed to farm/+/coord/+/pairing/status
[18:48:24 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:48:24 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:48:24 INF] TelemetryHandler subscribed to all telemetry topics
[18:48:24 INF] TelemetryHandler subscribed to all telemetry topics
[18:48:25 WRN] Failed to create indexes for twin collections (may already exist)
MongoDB.Driver.MongoCommandException: Command createIndexes failed: Index build failed: 8e0d80db-885f-4a9f-9f21-7ce526a5f97a: Collection iot_test.tower_twins ( 00159106-1b97-4b88-a0a5-b573fbae283e ) :: caused by :: Collection iot_test.tower_twins(00159106-1b97-4b88-a0a5-b573fbae283e) is being dropped.
   at MongoDB.Driver.Core.WireProtocol.CommandUsingCommandMessageWireProtocol`1.ProcessResponse(ConnectionId connectionId, CommandMessage responseMessage)
   at MongoDB.Driver.Core.WireProtocol.CommandUsingCommandMessageWireProtocol`1.SendMessageAndProcessResponseAsync(CommandRequestMessage message, Int32 responseTo, IConnection connection, CancellationToken cancellationToken)
   at MongoDB.Driver.Core.WireProtocol.CommandUsingCommandMessageWireProtocol`1.ExecuteAsync(IConnection connection, CancellationToken cancellationToken)
   at MongoDB.Driver.Core.Servers.Server.ServerChannel.ExecuteProtocolAsync[TResult](IWireProtocol`1 protocol, ICoreSession session, CancellationToken cancellationToken)
   at MongoDB.Driver.Core.Operations.CommandOperationBase`1.ExecuteProtocolAsync(IChannelSource channelSource, ICoreSessionHandle session, ReadPreference readPreference, CancellationToken cancellationToken)
   at MongoDB.Driver.Core.Operations.WriteCommandOperation`1.ExecuteAsync(IWriteBinding binding, CancellationToken cancellationToken)
   at MongoDB.Driver.Core.Operations.CreateIndexesOperation.ExecuteAsync(IWriteBinding binding, CancellationToken cancellationToken)
   at MongoDB.Driver.OperationExecutor.ExecuteWriteOperationAsync[TResult](IWriteBinding binding, IWriteOperation`1 operation, CancellationToken cancellationToken)
   at MongoDB.Driver.MongoCollectionImpl`1.ExecuteWriteOperationAsync[TResult](IClientSessionHandle session, IWriteOperation`1 operation, CancellationToken cancellationToken)
   at MongoDB.Driver.MongoCollectionImpl`1.MongoIndexManager.CreateManyAsync(IClientSessionHandle session, IEnumerable`1 models, CreateManyIndexesOptions options, CancellationToken cancellationToken)
   at MongoDB.Driver.MongoCollectionImpl`1.UsingImplicitSessionAsync[TResult](Func`2 funcAsync, CancellationToken cancellationToken)
   at IoT.Backend.Repositories.TwinRepository.EnsureIndexesAsync() in /src/Backend/src/IoT.Backend/Repositories/TwinRepository.cs:line 49
[18:48:25 WRN] Failed to create indexes for twin collections (may already exist)
MongoDB.Driver.MongoCommandException: Command createIndexes failed: Index build failed: 8e0d80db-885f-4a9f-9f21-7ce526a5f97a: Collection iot_test.tower_twins ( 00159106-1b97-4b88-a0a5-b573fbae283e ) :: caused by :: Collection iot_test.tower_twins(00159106-1b97-4b88-a0a5-b573fbae283e) is being dropped.
   at MongoDB.Driver.Core.WireProtocol.CommandUsingCommandMessageWireProtocol`1.ProcessResponse(ConnectionId connectionId, CommandMessage responseMessage)
   at MongoDB.Driver.Core.WireProtocol.CommandUsingCommandMessageWireProtocol`1.SendMessageAndProcessResponseAsync(CommandRequestMessage message, Int32 responseTo, IConnection connection, CancellationToken cancellationToken)
   at MongoDB.Driver.Core.WireProtocol.CommandUsingCommandMessageWireProtocol`1.ExecuteAsync(IConnection connection, CancellationToken cancellationToken)
   at MongoDB.Driver.Core.Servers.Server.ServerChannel.ExecuteProtocolAsync[TResult](IWireProtocol`1 protocol, ICoreSession session, CancellationToken cancellationToken)
   at MongoDB.Driver.Core.Operations.CommandOperationBase`1.ExecuteProtocolAsync(IChannelSource channelSource, ICoreSessionHandle session, ReadPreference readPreference, CancellationToken cancellationToken)
   at MongoDB.Driver.Core.Operations.WriteCommandOperation`1.ExecuteAsync(IWriteBinding binding, CancellationToken cancellationToken)
   at MongoDB.Driver.Core.Operations.CreateIndexesOperation.ExecuteAsync(IWriteBinding binding, CancellationToken cancellationToken)
   at MongoDB.Driver.OperationExecutor.ExecuteWriteOperationAsync[TResult](IWriteBinding binding, IWriteOperation`1 operation, CancellationToken cancellationToken)
   at MongoDB.Driver.MongoCollectionImpl`1.ExecuteWriteOperationAsync[TResult](IClientSessionHandle session, IWriteOperation`1 operation, CancellationToken cancellationToken)
   at MongoDB.Driver.MongoCollectionImpl`1.MongoIndexManager.CreateManyAsync(IClientSessionHandle session, IEnumerable`1 models, CreateManyIndexesOptions options, CancellationToken cancellationToken)
   at MongoDB.Driver.MongoCollectionImpl`1.UsingImplicitSessionAsync[TResult](Func`2 funcAsync, CancellationToken cancellationToken)
   at IoT.Backend.Repositories.TwinRepository.EnsureIndexesAsync() in /src/Backend/src/IoT.Backend/Repositories/TwinRepository.cs:line 49
[18:48:25 WRN] Failed to create indexes for twin collections (may already exist)
MongoDB.Driver.MongoCommandException: Command createIndexes failed: Index build failed: 0db1c312-ffee-4f91-b48b-45360fdae1a8: Collection iot_test.tower_twins ( 00159106-1b97-4b88-a0a5-b573fbae283e ) :: caused by :: Collection iot_test.tower_twins(00159106-1b97-4b88-a0a5-b573fbae283e) is being dropped.
   at MongoDB.Driver.Core.WireProtocol.CommandUsingCommandMessageWireProtocol`1.ProcessResponse(ConnectionId connectionId, CommandMessage responseMessage)
   at MongoDB.Driver.Core.WireProtocol.CommandUsingCommandMessageWireProtocol`1.SendMessageAndProcessResponseAsync(CommandRequestMessage message, Int32 responseTo, IConnection connection, CancellationToken cancellationToken)
   at MongoDB.Driver.Core.WireProtocol.CommandUsingCommandMessageWireProtocol`1.ExecuteAsync(IConnection connection, CancellationToken cancellationToken)
   at MongoDB.Driver.Core.Servers.Server.ServerChannel.ExecuteProtocolAsync[TResult](IWireProtocol`1 protocol, ICoreSession session, CancellationToken cancellationToken)
   at MongoDB.Driver.Core.Operations.CommandOperationBase`1.ExecuteProtocolAsync(IChannelSource channelSource, ICoreSessionHandle session, ReadPreference readPreference, CancellationToken cancellationToken)
   at MongoDB.Driver.Core.Operations.WriteCommandOperation`1.ExecuteAsync(IWriteBinding binding, CancellationToken cancellationToken)
   at MongoDB.Driver.Core.Operations.CreateIndexesOperation.ExecuteAsync(IWriteBinding binding, CancellationToken cancellationToken)
   at MongoDB.Driver.OperationExecutor.ExecuteWriteOperationAsync[TResult](IWriteBinding binding, IWriteOperation`1 operation, CancellationToken cancellationToken)
   at MongoDB.Driver.MongoCollectionImpl`1.ExecuteWriteOperationAsync[TResult](IClientSessionHandle session, IWriteOperation`1 operation, CancellationToken cancellationToken)
   at MongoDB.Driver.MongoCollectionImpl`1.MongoIndexManager.CreateManyAsync(IClientSessionHandle session, IEnumerable`1 models, CreateManyIndexesOptions options, CancellationToken cancellationToken)
   at MongoDB.Driver.MongoCollectionImpl`1.UsingImplicitSessionAsync[TResult](Func`2 funcAsync, CancellationToken cancellationToken)
   at IoT.Backend.Repositories.TwinRepository.EnsureIndexesAsync() in /src/Backend/src/IoT.Backend/Repositories/TwinRepository.cs:line 49
[18:48:25 WRN] Failed to create indexes for twin collections (may already exist)
MongoDB.Driver.MongoCommandException: Command createIndexes failed: Index build failed: 0db1c312-ffee-4f91-b48b-45360fdae1a8: Collection iot_test.tower_twins ( 00159106-1b97-4b88-a0a5-b573fbae283e ) :: caused by :: Collection iot_test.tower_twins(00159106-1b97-4b88-a0a5-b573fbae283e) is being dropped.
   at MongoDB.Driver.Core.WireProtocol.CommandUsingCommandMessageWireProtocol`1.ProcessResponse(ConnectionId connectionId, CommandMessage responseMessage)
   at MongoDB.Driver.Core.WireProtocol.CommandUsingCommandMessageWireProtocol`1.SendMessageAndProcessResponseAsync(CommandRequestMessage message, Int32 responseTo, IConnection connection, CancellationToken cancellationToken)
   at MongoDB.Driver.Core.WireProtocol.CommandUsingCommandMessageWireProtocol`1.ExecuteAsync(IConnection connection, CancellationToken cancellationToken)
   at MongoDB.Driver.Core.Servers.Server.ServerChannel.ExecuteProtocolAsync[TResult](IWireProtocol`1 protocol, ICoreSession session, CancellationToken cancellationToken)
   at MongoDB.Driver.Core.Operations.CommandOperationBase`1.ExecuteProtocolAsync(IChannelSource channelSource, ICoreSessionHandle session, ReadPreference readPreference, CancellationToken cancellationToken)
   at MongoDB.Driver.Core.Operations.WriteCommandOperation`1.ExecuteAsync(IWriteBinding binding, CancellationToken cancellationToken)
   at MongoDB.Driver.Core.Operations.CreateIndexesOperation.ExecuteAsync(IWriteBinding binding, CancellationToken cancellationToken)
   at MongoDB.Driver.OperationExecutor.ExecuteWriteOperationAsync[TResult](IWriteBinding binding, IWriteOperation`1 operation, CancellationToken cancellationToken)
   at MongoDB.Driver.MongoCollectionImpl`1.ExecuteWriteOperationAsync[TResult](IClientSessionHandle session, IWriteOperation`1 operation, CancellationToken cancellationToken)
   at MongoDB.Driver.MongoCollectionImpl`1.MongoIndexManager.CreateManyAsync(IClientSessionHandle session, IEnumerable`1 models, CreateManyIndexesOptions options, CancellationToken cancellationToken)
   at MongoDB.Driver.MongoCollectionImpl`1.UsingImplicitSessionAsync[TResult](Func`2 funcAsync, CancellationToken cancellationToken)
   at IoT.Backend.Repositories.TwinRepository.EnsureIndexesAsync() in /src/Backend/src/IoT.Backend/Repositories/TwinRepository.cs:line 49
[18:48:25 INF] PairingBackgroundService stopped
[18:48:25 INF] PairingBackgroundService stopped
[18:48:25 INF] TwinSyncBackgroundService stopped
[18:48:25 INF] TwinSyncBackgroundService stopped
  Passed IoT.Backend.IntegrationTests.Tests.TwinIntegrationTests.GetCoordinatorTwin_WhenExists_ShouldReturnTwin [277 ms]
  Standard Output Messages:
 Creating WebApplicationFactory...
 Backend is ready
 Test fixture initialized
 Disposing test fixture...


[18:48:25 INF] Starting IoT Backend on port 8000
[18:48:25 INF] Starting IoT Backend on port 8000
[18:48:25 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:48:25 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:48:25 INF] PairingBackgroundService starting
[18:48:25 INF] PairingBackgroundService starting
[18:48:25 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:48:25 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:48:25 INF] Connected to MQTT broker
[18:48:25 INF] Connected to MQTT broker
[18:48:26 INF] PairingBackgroundService stopped
[18:48:26 INF] PairingBackgroundService stopped
[18:48:26 INF] TwinSyncBackgroundService stopped
[18:48:26 INF] TwinSyncBackgroundService stopped
[18:48:26 INF] Starting IoT Backend on port 8000
[18:48:26 INF] Starting IoT Backend on port 8000
[18:48:26 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:48:26 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:48:26 INF] PairingBackgroundService starting
[18:48:26 INF] PairingBackgroundService starting
[18:48:26 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:48:26 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:48:26 INF] HTTP GET /health/live responded 200 in 1.7046 ms
[18:48:26 INF] HTTP GET /health/live responded 200 in 1.7046 ms
[18:48:26 INF] Connected to MQTT broker
[18:48:26 INF] Connected to MQTT broker
[18:48:26 INF] MQTT service started
[18:48:26 INF] MQTT service started
[18:48:26 INF] Coordinator coord-sync-success sync marked as successful
[18:48:26 INF] Coordinator coord-sync-success sync marked as successful
[18:48:26 INF] HTTP POST /api/twins/coordinators/coord-sync-success/sync/success responded 200 in 8.0159 ms
[18:48:26 INF] HTTP POST /api/twins/coordinators/coord-sync-success/sync/success responded 200 in 8.0159 ms
[18:48:26 INF] MQTT service stopped
[18:48:26 INF] MQTT service stopped
[18:48:26 INF] PairingBackgroundService stopped
[18:48:26 INF] PairingBackgroundService stopped
[18:48:26 INF] TwinSyncBackgroundService stopped
[18:48:26 INF] TwinSyncBackgroundService stopped
[18:48:26 INF] Starting IoT Backend on port 8000
[18:48:26 INF] Starting IoT Backend on port 8000
[18:48:26 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:48:26 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:48:26 INF] PairingBackgroundService starting
[18:48:26 INF] PairingBackgroundService starting
[18:48:26 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:48:26 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:48:26 INF] Connected to MQTT broker
[18:48:26 INF] Connected to MQTT broker
[18:48:27 INF] PairingBackgroundService stopped
[18:48:27 INF] PairingBackgroundService stopped
[18:48:27 INF] TwinSyncBackgroundService stopped
[18:48:27 INF] TwinSyncBackgroundService stopped
[18:48:27 INF] Starting IoT Backend on port 8000
[18:48:27 INF] Starting IoT Backend on port 8000
[18:48:27 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:48:27 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:48:27 INF] PairingBackgroundService starting
[18:48:27 INF] PairingBackgroundService starting
[18:48:27 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:48:27 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:48:27 INF] HTTP GET /health/live responded 200 in 1.7851 ms
[18:48:27 INF] HTTP GET /health/live responded 200 in 1.7851 ms
[18:48:27 INF] Connected to MQTT broker
[18:48:27 INF] Connected to MQTT broker
[18:48:27 INF] MQTT service started
[18:48:27 INF] MQTT service started
  Passed IoT.Backend.IntegrationTests.Tests.TwinIntegrationTests.SetTowerDesiredState_WithNullBody_ShouldReturnBadRequest [9 ms]
  Standard Output Messages:
 Creating WebApplicationFactory...
 Backend is ready
 Test fixture initialized
 Disposing test fixture...


  Passed IoT.Backend.IntegrationTests.Tests.TwinIntegrationTests.MarkCoordinatorSyncSuccess_ShouldUpdateSyncStatus [427 ms]
  Standard Output Messages:
 Creating WebApplicationFactory...
 Backend is ready
 Test fixture initialized
 Disposing test fixture...


  Passed IoT.Backend.IntegrationTests.Tests.TwinIntegrationTests.CoordinatorTwin_WithConflictStatus_ShouldReflectInDelta [643 ms]
  Standard Output Messages:
 Creating WebApplicationFactory...
 Backend is ready
 Test fixture initialized
 Disposing test fixture...


[18:48:28 INF] TelemetryHandler subscribing to MQTT topics
[18:48:28 INF] TelemetryHandler subscribing to MQTT topics
[18:48:28 INF] Subscribed to site/+/coord/+/telemetry
[18:48:28 INF] Subscribed to site/+/coord/+/telemetry
[18:48:28 INF] Subscribed to site/+/coord/+/status
[18:48:28 INF] Subscribed to site/+/coord/+/status
[18:48:28 INF] Subscribed to site/+/ota/progress
[18:48:28 INF] Subscribed to site/+/ota/progress
[18:48:28 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:48:28 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:48:28 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:48:28 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:48:28 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:48:28 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:48:28 INF] Subscribed to farm/+/coord/+/pairing/request
[18:48:28 INF] Subscribed to farm/+/coord/+/pairing/request
[18:48:28 INF] Subscribed to farm/+/coord/+/pairing/status
[18:48:28 INF] Subscribed to farm/+/coord/+/pairing/status
[18:48:28 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:48:28 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:48:28 INF] TelemetryHandler subscribed to all telemetry topics
[18:48:28 INF] TelemetryHandler subscribed to all telemetry topics
[18:48:29 INF] HTTP GET /api/twins/farms/farm-overview responded 200 in 15.0824 ms
[18:48:29 INF] HTTP GET /api/twins/farms/farm-overview responded 200 in 15.0824 ms
[18:48:29 INF] MQTT service stopped
[18:48:29 INF] MQTT service stopped
[18:48:29 INF] PairingBackgroundService stopped
[18:48:29 INF] PairingBackgroundService stopped
[18:48:29 INF] TwinSyncBackgroundService stopped
[18:48:29 INF] TwinSyncBackgroundService stopped
  Passed IoT.Backend.IntegrationTests.Tests.TwinIntegrationTests.GetFarmTwins_ShouldReturnAllCoordinatorsAndTowers [308 ms]
  Standard Output Messages:
 Creating WebApplicationFactory...
 Backend is ready
 Test fixture initialized
 Disposing test fixture...


[18:48:29 INF] Starting IoT Backend on port 8000
[18:48:29 INF] Starting IoT Backend on port 8000
[18:48:29 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:48:29 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:48:29 INF] PairingBackgroundService starting
[18:48:29 INF] PairingBackgroundService starting
[18:48:29 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:48:29 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:48:29 INF] Connected to MQTT broker
[18:48:29 INF] Connected to MQTT broker
[18:48:30 WRN] Failed to create indexes for twin collections (may already exist)
MongoDB.Driver.MongoCommandException: Command createIndexes failed: Index build failed: 0c89d20d-dffb-4652-9c59-da5e924ca923: Collection iot_test.tower_twins ( d27ac5bc-aba4-41ef-b175-82b1568756a9 ) :: caused by :: Collection iot_test.tower_twins(d27ac5bc-aba4-41ef-b175-82b1568756a9) is being dropped.
   at MongoDB.Driver.Core.WireProtocol.CommandUsingCommandMessageWireProtocol`1.ProcessResponse(ConnectionId connectionId, CommandMessage responseMessage)
   at MongoDB.Driver.Core.WireProtocol.CommandUsingCommandMessageWireProtocol`1.SendMessageAndProcessResponseAsync(CommandRequestMessage message, Int32 responseTo, IConnection connection, CancellationToken cancellationToken)
   at MongoDB.Driver.Core.WireProtocol.CommandUsingCommandMessageWireProtocol`1.ExecuteAsync(IConnection connection, CancellationToken cancellationToken)
   at MongoDB.Driver.Core.Servers.Server.ServerChannel.ExecuteProtocolAsync[TResult](IWireProtocol`1 protocol, ICoreSession session, CancellationToken cancellationToken)
   at MongoDB.Driver.Core.Operations.CommandOperationBase`1.ExecuteProtocolAsync(IChannelSource channelSource, ICoreSessionHandle session, ReadPreference readPreference, CancellationToken cancellationToken)
   at MongoDB.Driver.Core.Operations.WriteCommandOperation`1.ExecuteAsync(IWriteBinding binding, CancellationToken cancellationToken)
   at MongoDB.Driver.Core.Operations.CreateIndexesOperation.ExecuteAsync(IWriteBinding binding, CancellationToken cancellationToken)
   at MongoDB.Driver.OperationExecutor.ExecuteWriteOperationAsync[TResult](IWriteBinding binding, IWriteOperation`1 operation, CancellationToken cancellationToken)
   at MongoDB.Driver.MongoCollectionImpl`1.ExecuteWriteOperationAsync[TResult](IClientSessionHandle session, IWriteOperation`1 operation, CancellationToken cancellationToken)
   at MongoDB.Driver.MongoCollectionImpl`1.MongoIndexManager.CreateManyAsync(IClientSessionHandle session, IEnumerable`1 models, CreateManyIndexesOptions options, CancellationToken cancellationToken)
   at MongoDB.Driver.MongoCollectionImpl`1.UsingImplicitSessionAsync[TResult](Func`2 funcAsync, CancellationToken cancellationToken)
   at IoT.Backend.Repositories.TwinRepository.EnsureIndexesAsync() in /src/Backend/src/IoT.Backend/Repositories/TwinRepository.cs:line 49
[18:48:30 WRN] Failed to create indexes for twin collections (may already exist)
MongoDB.Driver.MongoCommandException: Command createIndexes failed: Index build failed: 0c89d20d-dffb-4652-9c59-da5e924ca923: Collection iot_test.tower_twins ( d27ac5bc-aba4-41ef-b175-82b1568756a9 ) :: caused by :: Collection iot_test.tower_twins(d27ac5bc-aba4-41ef-b175-82b1568756a9) is being dropped.
   at MongoDB.Driver.Core.WireProtocol.CommandUsingCommandMessageWireProtocol`1.ProcessResponse(ConnectionId connectionId, CommandMessage responseMessage)
   at MongoDB.Driver.Core.WireProtocol.CommandUsingCommandMessageWireProtocol`1.SendMessageAndProcessResponseAsync(CommandRequestMessage message, Int32 responseTo, IConnection connection, CancellationToken cancellationToken)
   at MongoDB.Driver.Core.WireProtocol.CommandUsingCommandMessageWireProtocol`1.ExecuteAsync(IConnection connection, CancellationToken cancellationToken)
   at MongoDB.Driver.Core.Servers.Server.ServerChannel.ExecuteProtocolAsync[TResult](IWireProtocol`1 protocol, ICoreSession session, CancellationToken cancellationToken)
   at MongoDB.Driver.Core.Operations.CommandOperationBase`1.ExecuteProtocolAsync(IChannelSource channelSource, ICoreSessionHandle session, ReadPreference readPreference, CancellationToken cancellationToken)
   at MongoDB.Driver.Core.Operations.WriteCommandOperation`1.ExecuteAsync(IWriteBinding binding, CancellationToken cancellationToken)
   at MongoDB.Driver.Core.Operations.CreateIndexesOperation.ExecuteAsync(IWriteBinding binding, CancellationToken cancellationToken)
   at MongoDB.Driver.OperationExecutor.ExecuteWriteOperationAsync[TResult](IWriteBinding binding, IWriteOperation`1 operation, CancellationToken cancellationToken)
   at MongoDB.Driver.MongoCollectionImpl`1.ExecuteWriteOperationAsync[TResult](IClientSessionHandle session, IWriteOperation`1 operation, CancellationToken cancellationToken)
   at MongoDB.Driver.MongoCollectionImpl`1.MongoIndexManager.CreateManyAsync(IClientSessionHandle session, IEnumerable`1 models, CreateManyIndexesOptions options, CancellationToken cancellationToken)
   at MongoDB.Driver.MongoCollectionImpl`1.UsingImplicitSessionAsync[TResult](Func`2 funcAsync, CancellationToken cancellationToken)
   at IoT.Backend.Repositories.TwinRepository.EnsureIndexesAsync() in /src/Backend/src/IoT.Backend/Repositories/TwinRepository.cs:line 49
[18:48:30 INF] Tower tower-sync-success sync marked as successful
[18:48:30 INF] Tower tower-sync-success sync marked as successful
[18:48:30 INF] PairingBackgroundService stopped
[18:48:30 INF] PairingBackgroundService stopped
[18:48:30 INF] TwinSyncBackgroundService stopped
[18:48:30 INF] TwinSyncBackgroundService stopped
[18:48:30 INF] Starting IoT Backend on port 8000
[18:48:30 INF] Starting IoT Backend on port 8000
[18:48:30 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:48:30 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:48:30 INF] PairingBackgroundService starting
[18:48:30 INF] PairingBackgroundService starting
[18:48:30 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:48:30 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:48:30 INF] Connected to MQTT broker
[18:48:30 INF] Connected to MQTT broker
  Passed IoT.Backend.IntegrationTests.Tests.TwinIntegrationTests.MarkTowerSyncSuccess_ShouldUpdateSyncStatus [161 ms]
  Standard Output Messages:
 Creating WebApplicationFactory...
 Backend is ready
 Test fixture initialized
 Disposing test fixture...


[18:48:29 WRN] Failed to create indexes for twin collections (may already exist)
MongoDB.Driver.MongoCommandException: Command createIndexes failed: Index build failed: e38771d0-42a8-46a8-9dcd-b6d27ff26ac3: Collection iot_test.tower_twins ( 39d7ad0f-4e63-41ed-9f40-34ccf8dbd256 ) :: caused by :: Collection iot_test.tower_twins(39d7ad0f-4e63-41ed-9f40-34ccf8dbd256) is being dropped.
   at MongoDB.Driver.Core.WireProtocol.CommandUsingCommandMessageWireProtocol`1.ProcessResponse(ConnectionId connectionId, CommandMessage responseMessage)
   at MongoDB.Driver.Core.WireProtocol.CommandUsingCommandMessageWireProtocol`1.SendMessageAndProcessResponseAsync(CommandRequestMessage message, Int32 responseTo, IConnection connection, CancellationToken cancellationToken)
   at MongoDB.Driver.Core.WireProtocol.CommandUsingCommandMessageWireProtocol`1.ExecuteAsync(IConnection connection, CancellationToken cancellationToken)
   at MongoDB.Driver.Core.Servers.Server.ServerChannel.ExecuteProtocolAsync[TResult](IWireProtocol`1 protocol, ICoreSession session, CancellationToken cancellationToken)
   at MongoDB.Driver.Core.Operations.CommandOperationBase`1.ExecuteProtocolAsync(IChannelSource channelSource, ICoreSessionHandle session, ReadPreference readPreference, CancellationToken cancellationToken)
   at MongoDB.Driver.Core.Operations.WriteCommandOperation`1.ExecuteAsync(IWriteBinding binding, CancellationToken cancellationToken)
   at MongoDB.Driver.Core.Operations.CreateIndexesOperation.ExecuteAsync(IWriteBinding binding, CancellationToken cancellationToken)
   at MongoDB.Driver.OperationExecutor.ExecuteWriteOperationAsync[TResult](IWriteBinding binding, IWriteOperation`1 operation, CancellationToken cancellationToken)
   at MongoDB.Driver.MongoCollectionImpl`1.ExecuteWriteOperationAsync[TResult](IClientSessionHandle session, IWriteOperation`1 operation, CancellationToken cancellationToken)
   at MongoDB.Driver.MongoCollectionImpl`1.MongoIndexManager.CreateManyAsync(IClientSessionHandle session, IEnumerable`1 models, CreateManyIndexesOptions options, CancellationToken cancellationToken)
   at MongoDB.Driver.MongoCollectionImpl`1.UsingImplicitSessionAsync[TResult](Func`2 funcAsync, CancellationToken cancellationToken)
   at IoT.Backend.Repositories.TwinRepository.EnsureIndexesAsync() in /src/Backend/src/IoT.Backend/Repositories/TwinRepository.cs:line 49
[18:48:29 WRN] Failed to create indexes for twin collections (may already exist)
MongoDB.Driver.MongoCommandException: Command createIndexes failed: Index build failed: e38771d0-42a8-46a8-9dcd-b6d27ff26ac3: Collection iot_test.tower_twins ( 39d7ad0f-4e63-41ed-9f40-34ccf8dbd256 ) :: caused by :: Collection iot_test.tower_twins(39d7ad0f-4e63-41ed-9f40-34ccf8dbd256) is being dropped.
   at MongoDB.Driver.Core.WireProtocol.CommandUsingCommandMessageWireProtocol`1.ProcessResponse(ConnectionId connectionId, CommandMessage responseMessage)
   at MongoDB.Driver.Core.WireProtocol.CommandUsingCommandMessageWireProtocol`1.SendMessageAndProcessResponseAsync(CommandRequestMessage message, Int32 responseTo, IConnection connection, CancellationToken cancellationToken)
   at MongoDB.Driver.Core.WireProtocol.CommandUsingCommandMessageWireProtocol`1.ExecuteAsync(IConnection connection, CancellationToken cancellationToken)
   at MongoDB.Driver.Core.Servers.Server.ServerChannel.ExecuteProtocolAsync[TResult](IWireProtocol`1 protocol, ICoreSession session, CancellationToken cancellationToken)
   at MongoDB.Driver.Core.Operations.CommandOperationBase`1.ExecuteProtocolAsync(IChannelSource channelSource, ICoreSessionHandle session, ReadPreference readPreference, CancellationToken cancellationToken)
   at MongoDB.Driver.Core.Operations.WriteCommandOperation`1.ExecuteAsync(IWriteBinding binding, CancellationToken cancellationToken)
   at MongoDB.Driver.Core.Operations.CreateIndexesOperation.ExecuteAsync(IWriteBinding binding, CancellationToken cancellationToken)
   at MongoDB.Driver.OperationExecutor.ExecuteWriteOperationAsync[TResult](IWriteBinding binding, IWriteOperation`1 operation, CancellationToken cancellationToken)
   at MongoDB.Driver.MongoCollectionImpl`1.ExecuteWriteOperationAsync[TResult](IClientSessionHandle session, IWriteOperation`1 operation, CancellationToken cancellationToken)
   at MongoDB.Driver.MongoCollectionImpl`1.MongoIndexManager.CreateManyAsync(IClientSessionHandle session, IEnumerable`1 models, CreateManyIndexesOptions options, CancellationToken cancellationToken)
   at MongoDB.Driver.MongoCollectionImpl`1.UsingImplicitSessionAsync[TResult](Func`2 funcAsync, CancellationToken cancellationToken)
   at IoT.Backend.Repositories.TwinRepository.EnsureIndexesAsync() in /src/Backend/src/IoT.Backend/Repositories/TwinRepository.cs:line 49
[18:48:29 INF] TelemetryHandler subscribing to MQTT topics
[18:48:29 INF] TelemetryHandler subscribing to MQTT topics
[18:48:29 INF] Subscribed to site/+/coord/+/telemetry
[18:48:29 INF] Subscribed to site/+/coord/+/telemetry
[18:48:29 INF] Subscribed to site/+/coord/+/status
[18:48:29 INF] Subscribed to site/+/coord/+/status
[18:48:29 INF] Subscribed to site/+/ota/progress
[18:48:29 INF] Subscribed to site/+/ota/progress
[18:48:29 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:48:29 INF] Subscribed to farm/+/coord/+/reservoir/telemetry
[18:48:29 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:48:29 INF] Subscribed to farm/+/coord/+/tower/+/telemetry
[18:48:29 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:48:29 INF] Subscribed to farm/+/coord/+/tower/+/status
[18:48:29 INF] Subscribed to farm/+/coord/+/pairing/request
[18:48:29 INF] Subscribed to farm/+/coord/+/pairing/request
[18:48:29 INF] Subscribed to farm/+/coord/+/pairing/status
[18:48:29 INF] Subscribed to farm/+/coord/+/pairing/status
[18:48:29 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:48:29 INF] Subscribed to farm/+/coord/+/pairing/complete
[18:48:29 INF] TelemetryHandler subscribed to all telemetry topics
[18:48:29 INF] TelemetryHandler subscribed to all telemetry topics
[18:48:29 INF] PairingBackgroundService stopped
[18:48:29 INF] PairingBackgroundService stopped
[18:48:29 INF] TwinSyncBackgroundService stopped
[18:48:29 INF] TwinSyncBackgroundService stopped
[18:48:29 INF] Starting IoT Backend on port 8000
[18:48:29 INF] Starting IoT Backend on port 8000
[18:48:29 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:48:29 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:48:29 INF] PairingBackgroundService starting
[18:48:29 INF] PairingBackgroundService starting
[18:48:29 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:48:29 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:48:29 INF] HTTP GET /health/live responded 200 in 1.6539 ms
[18:48:29 INF] HTTP GET /health/live responded 200 in 1.6539 ms
[18:48:29 INF] Connected to MQTT broker
[18:48:29 INF] Connected to MQTT broker
[18:48:29 INF] MQTT service started
[18:48:29 INF] MQTT service started
[18:48:29 WRN] Failed to create indexes for twin collections (may already exist)
MongoDB.Driver.MongoCommandException: Command createIndexes failed: Index build failed: 6721aea9-46a6-423d-922d-4b59ea5d3bec: Collection iot_test.tower_twins ( 272c7b9c-d684-4c00-941f-56cb0a6cd1a8 ) :: caused by :: Collection iot_test.tower_twins(272c7b9c-d684-4c00-941f-56cb0a6cd1a8) is being dropped.
   at MongoDB.Driver.Core.WireProtocol.CommandUsingCommandMessageWireProtocol`1.ProcessResponse(ConnectionId connectionId, CommandMessage responseMessage)
   at MongoDB.Driver.Core.WireProtocol.CommandUsingCommandMessageWireProtocol`1.SendMessageAndProcessResponseAsync(CommandRequestMessage message, Int32 responseTo, IConnection connection, CancellationToken cancellationToken)
   at MongoDB.Driver.Core.WireProtocol.CommandUsingCommandMessageWireProtocol`1.ExecuteAsync(IConnection connection, CancellationToken cancellationToken)
   at MongoDB.Driver.Core.Servers.Server.ServerChannel.ExecuteProtocolAsync[TResult](IWireProtocol`1 protocol, ICoreSession session, CancellationToken cancellationToken)
   at MongoDB.Driver.Core.Operations.CommandOperationBase`1.ExecuteProtocolAsync(IChannelSource channelSource, ICoreSessionHandle session, ReadPreference readPreference, CancellationToken cancellationToken)
   at MongoDB.Driver.Core.Operations.WriteCommandOperation`1.ExecuteAsync(IWriteBinding binding, CancellationToken cancellationToken)
   at MongoDB.Driver.Core.Operations.CreateIndexesOperation.ExecuteAsync(IWriteBinding binding, CancellationToken cancellationToken)
   at MongoDB.Driver.OperationExecutor.ExecuteWriteOperationAsync[TResult](IWriteBinding binding, IWriteOperation`1 operation, CancellationToken cancellationToken)
   at MongoDB.Driver.MongoCollectionImpl`1.ExecuteWriteOperationAsync[TResult](IClientSessionHandle session, IWriteOperation`1 operation, CancellationToken cancellationToken)
   at MongoDB.Driver.MongoCollectionImpl`1.MongoIndexManager.CreateManyAsync(IClientSessionHandle session, IEnumerable`1 models, CreateManyIndexesOptions options, CancellationToken cancellationToken)
   at MongoDB.Driver.MongoCollectionImpl`1.UsingImplicitSessionAsync[TResult](Func`2 funcAsync, CancellationToken cancellationToken)
   at IoT.Backend.Repositories.TwinRepository.EnsureIndexesAsync() in /src/Backend/src/IoT.Backend/Repositories/TwinRepository.cs:line 49
[18:48:29 WRN] Failed to create indexes for twin collections (may already exist)
MongoDB.Driver.MongoCommandException: Command createIndexes failed: Index build failed: 6721aea9-46a6-423d-922d-4b59ea5d3bec: Collection iot_test.tower_twins ( 272c7b9c-d684-4c00-941f-56cb0a6cd1a8 ) :: caused by :: Collection iot_test.tower_twins(272c7b9c-d684-4c00-941f-56cb0a6cd1a8) is being dropped.
   at MongoDB.Driver.Core.WireProtocol.CommandUsingCommandMessageWireProtocol`1.ProcessResponse(ConnectionId connectionId, CommandMessage responseMessage)
   at MongoDB.Driver.Core.WireProtocol.CommandUsingCommandMessageWireProtocol`1.SendMessageAndProcessResponseAsync(CommandRequestMessage message, Int32 responseTo, IConnection connection, CancellationToken cancellationToken)
   at MongoDB.Driver.Core.WireProtocol.CommandUsingCommandMessageWireProtocol`1.ExecuteAsync(IConnection connection, CancellationToken cancellationToken)
   at MongoDB.Driver.Core.Servers.Server.ServerChannel.ExecuteProtocolAsync[TResult](IWireProtocol`1 protocol, ICoreSession session, CancellationToken cancellationToken)
   at MongoDB.Driver.Core.Operations.CommandOperationBase`1.ExecuteProtocolAsync(IChannelSource channelSource, ICoreSessionHandle session, ReadPreference readPreference, CancellationToken cancellationToken)
   at MongoDB.Driver.Core.Operations.WriteCommandOperation`1.ExecuteAsync(IWriteBinding binding, CancellationToken cancellationToken)
   at MongoDB.Driver.Core.Operations.CreateIndexesOperation.ExecuteAsync(IWriteBinding binding, CancellationToken cancellationToken)
   at MongoDB.Driver.OperationExecutor.ExecuteWriteOperationAsync[TResult](IWriteBinding binding, IWriteOperation`1 operation, CancellationToken cancellationToken)
   at MongoDB.Driver.MongoCollectionImpl`1.ExecuteWriteOperationAsync[TResult](IClientSessionHandle session, IWriteOperation`1 operation, CancellationToken cancellationToken)
   at MongoDB.Driver.MongoCollectionImpl`1.MongoIndexManager.CreateManyAsync(IClientSessionHandle session, IEnumerable`1 models, CreateManyIndexesOptions options, CancellationToken cancellationToken)
   at MongoDB.Driver.MongoCollectionImpl`1.UsingImplicitSessionAsync[TResult](Func`2 funcAsync, CancellationToken cancellationToken)
   at IoT.Backend.Repositories.TwinRepository.EnsureIndexesAsync() in /src/Backend/src/IoT.Backend/Repositories/TwinRepository.cs:line 49
[18:48:29 INF] HTTP GET /api/twins/towers responded 400 in 4.5406 ms
[18:48:29 INF] HTTP GET /api/twins/towers responded 400 in 4.5406 ms
[18:48:29 INF] PairingBackgroundService stopped
[18:48:29 INF] PairingBackgroundService stopped
[18:48:29 INF] MQTT service stopped
[18:48:29 INF] MQTT service stopped
[18:48:29 INF] TwinSyncBackgroundService stopped
[18:48:29 INF] TwinSyncBackgroundService stopped
[18:48:29 INF] Starting IoT Backend on port 8000
[18:48:29 INF] Starting IoT Backend on port 8000
[18:48:29 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:48:29 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:48:29 INF] PairingBackgroundService starting
[18:48:29 INF] PairingBackgroundService starting
[18:48:29 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:48:29 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:48:29 INF] Connected to MQTT broker
[18:48:29 INF] Connected to MQTT broker
  Passed IoT.Backend.IntegrationTests.Tests.TwinIntegrationTests.GetTowerTwins_ShouldReturnAllForCoordinator [153 ms]
  Standard Output Messages:
 Creating WebApplicationFactory...
 Backend is ready
 Test fixture initialized
 Disposing test fixture...


  Passed IoT.Backend.IntegrationTests.Tests.TwinIntegrationTests.GetTowerTwins_WithoutRequiredParams_ShouldReturnBadRequest [7 ms]
  Standard Output Messages:
 Creating WebApplicationFactory...
 Backend is ready
 Test fixture initialized
 Disposing test fixture...


[18:48:30 INF] Setting desired state for coordinator coord-desired-set
[18:48:30 INF] Setting desired state for coordinator coord-desired-set
[18:48:30 INF] Published command to coordinator coord-desired-set on topic hydro/farm-desired/coord-desired-set/cmd
[18:48:30 INF] Published command to coordinator coord-desired-set on topic hydro/farm-desired/coord-desired-set/cmd
[18:48:30 INF] PairingBackgroundService stopped
[18:48:30 INF] PairingBackgroundService stopped
[18:48:30 INF] TwinSyncBackgroundService stopped
[18:48:30 INF] TwinSyncBackgroundService stopped
[18:48:30 INF] Starting IoT Backend on port 8000
[18:48:30 INF] Starting IoT Backend on port 8000
[18:48:30 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:48:30 INF] TwinSyncBackgroundService starting. SyncInterval=5s, StaleCheckInterval=30s, StaleThreshold=120s
[18:48:30 INF] PairingBackgroundService starting
[18:48:30 INF] PairingBackgroundService starting
[18:48:30 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:48:30 INF] Connecting to MQTT broker at host.docker.internal:54807
[18:48:30 WRN] Cannot publish to hydro/farm-desired/coord-desired-set/cmd: not connected
[18:48:30 WRN] Cannot publish to hydro/farm-desired/coord-desired-set/cmd: not connected
[18:48:30 INF] Published command to coordinator coord-desired-set on topic hydro/farm-desired/coord-desired-set/cmd
[18:48:30 INF] Published command to coordinator coord-desired-set on topic hydro/farm-desired/coord-desired-set/cmd
[18:48:30 INF] Connected to MQTT broker
[18:48:30 INF] Connected to MQTT broker
[18:48:30 INF] PairingBackgroundService stopped
[18:48:30 INF] PairingBackgroundService stopped
[18:48:30 INF] TwinSyncBackgroundService stopped
[18:48:30 INF] TwinSyncBackgroundService stopped
[testcontainers.org 00:03:49.92] Stop Docker container a0f8c256be9a
[18:48:31 WRN] Failed to create indexes for twin collections (may already exist)
MongoDB.Driver.MongoNodeIsRecoveringException: Server returned node is recovering error (code = 11600, codeName = "InterruptedAtShutdown").
   at MongoDB.Driver.Core.WireProtocol.CommandUsingCommandMessageWireProtocol`1.ProcessResponse(ConnectionId connectionId, CommandMessage responseMessage)
   at MongoDB.Driver.Core.WireProtocol.CommandUsingCommandMessageWireProtocol`1.SendMessageAndProcessResponseAsync(CommandRequestMessage message, Int32 responseTo, IConnection connection, CancellationToken cancellationToken)
   at MongoDB.Driver.Core.WireProtocol.CommandUsingCommandMessageWireProtocol`1.ExecuteAsync(IConnection connection, CancellationToken cancellationToken)
   at MongoDB.Driver.Core.Servers.Server.ServerChannel.ExecuteProtocolAsync[TResult](IWireProtocol`1 protocol, ICoreSession session, CancellationToken cancellationToken)
   at MongoDB.Driver.Core.Operations.CommandOperationBase`1.ExecuteProtocolAsync(IChannelSource channelSource, ICoreSessionHandle session, ReadPreference readPreference, CancellationToken cancellationToken)
   at MongoDB.Driver.Core.Operations.WriteCommandOperation`1.ExecuteAsync(IWriteBinding binding, CancellationToken cancellationToken)
   at MongoDB.Driver.Core.Operations.CreateIndexesOperation.ExecuteAsync(IWriteBinding binding, CancellationToken cancellationToken)
   at MongoDB.Driver.OperationExecutor.ExecuteWriteOperationAsync[TResult](IWriteBinding binding, IWriteOperation`1 operation, CancellationToken cancellationToken)
   at MongoDB.Driver.MongoCollectionImpl`1.ExecuteWriteOperationAsync[TResult](IClientSessionHandle session, IWriteOperation`1 operation, CancellationToken cancellationToken)
   at MongoDB.Driver.MongoCollectionImpl`1.MongoIndexManager.CreateManyAsync(IClientSessionHandle session, IEnumerable`1 models, CreateManyIndexesOptions options, CancellationToken cancellationToken)
   at MongoDB.Driver.MongoCollectionImpl`1.UsingImplicitSessionAsync[TResult](Func`2 funcAsync, CancellationToken cancellationToken)
   at IoT.Backend.Repositories.TwinRepository.EnsureIndexesAsync() in /src/Backend/src/IoT.Backend/Repositories/TwinRepository.cs:line 49
[18:48:31 WRN] Failed to create indexes for twin collections (may already exist)
MongoDB.Driver.MongoNodeIsRecoveringException: Server returned node is recovering error (code = 11600, codeName = "InterruptedAtShutdown").
   at MongoDB.Driver.Core.WireProtocol.CommandUsingCommandMessageWireProtocol`1.ProcessResponse(ConnectionId connectionId, CommandMessage responseMessage)
   at MongoDB.Driver.Core.WireProtocol.CommandUsingCommandMessageWireProtocol`1.SendMessageAndProcessResponseAsync(CommandRequestMessage message, Int32 responseTo, IConnection connection, CancellationToken cancellationToken)
   at MongoDB.Driver.Core.WireProtocol.CommandUsingCommandMessageWireProtocol`1.ExecuteAsync(IConnection connection, CancellationToken cancellationToken)
   at MongoDB.Driver.Core.Servers.Server.ServerChannel.ExecuteProtocolAsync[TResult](IWireProtocol`1 protocol, ICoreSession session, CancellationToken cancellationToken)
   at MongoDB.Driver.Core.Operations.CommandOperationBase`1.ExecuteProtocolAsync(IChannelSource channelSource, ICoreSessionHandle session, ReadPreference readPreference, CancellationToken cancellationToken)
   at MongoDB.Driver.Core.Operations.WriteCommandOperation`1.ExecuteAsync(IWriteBinding binding, CancellationToken cancellationToken)
   at MongoDB.Driver.Core.Operations.CreateIndexesOperation.ExecuteAsync(IWriteBinding binding, CancellationToken cancellationToken)
   at MongoDB.Driver.OperationExecutor.ExecuteWriteOperationAsync[TResult](IWriteBinding binding, IWriteOperation`1 operation, CancellationToken cancellationToken)
   at MongoDB.Driver.MongoCollectionImpl`1.ExecuteWriteOperationAsync[TResult](IClientSessionHandle session, IWriteOperation`1 operation, CancellationToken cancellationToken)
   at MongoDB.Driver.MongoCollectionImpl`1.MongoIndexManager.CreateManyAsync(IClientSessionHandle session, IEnumerable`1 models, CreateManyIndexesOptions options, CancellationToken cancellationToken)
   at MongoDB.Driver.MongoCollectionImpl`1.UsingImplicitSessionAsync[TResult](Func`2 funcAsync, CancellationToken cancellationToken)
   at IoT.Backend.Repositories.TwinRepository.EnsureIndexesAsync() in /src/Backend/src/IoT.Backend/Repositories/TwinRepository.cs:line 49
  Passed IoT.Backend.IntegrationTests.Tests.TwinIntegrationTests.SetCoordinatorDesiredState_ShouldPersistAndReturnAccepted [258 ms]
  Standard Output Messages:
 Creating WebApplicationFactory...
 Backend is ready
 Test fixture initialized
 Disposing test fixture...


  Passed IoT.Backend.IntegrationTests.Tests.TwinIntegrationTests.GetTowerTwin_WhenNotExists_ShouldReturnNotFound [8 ms]
  Standard Output Messages:
 Creating WebApplicationFactory...
 Backend is ready
 Test fixture initialized
 Disposing test fixture...


[testcontainers.org 00:03:52.84] Delete Docker container a0f8c256be9a
[xUnit.net 00:03:53.30]   Finished:    IoT.Backend.IntegrationTests

Test Run Successful.
Total tests: 130
     Passed: 130
 Total time: 3.8974 Minutes
